Requirements Description,初始化,控制计算,控制输出,故障诊断和处理,数据有效性判断,数据采集,遥控,遥测
"功能描述：与数字太阳通信，发送取数指令，获得部件数据。
处理：
在OBC每个控制周期中可能会通过串口向数太发送控制指令或者接收下传数据，见任务书时序图。
功能编号|功能|引用文档|备注
FREQ41|太敏初始化|太敏协议|B
FREQ42|太敏数据采集|任务书、太敏协议|A
FREQ43|数据解包与转换|数太协议|A
FREQ44|太敏数据有效性判断|任务书|A
FREQ45|太敏故障重构|任务书|A
",0,0,0,0,0,1,0,0
"功能描述：检测红外HL及HR故障，并选取正确的红外信号。

处理：
FM3——5.3（1）更改：若ZT35(3)=0，则：当HL通讯自检信号中表明见太阳，则HL = 0。若ZT35(3)=0，则：当HR通讯自检信号中表示见太阳，则HR = 0。
5.3（3）更改：若HL  HR = 1且HL的LTU中的特征位为“数据正常”，则：FHL  FHL + 1。若HL  HR = 1且HR的LTU中的特征位为“数据正常”，则：FHR  FHR + 1。
5.3（4）①更改： ZT5  4，{FHR < 6，HL =0}或{ FHL < 6，HR =0}
5.3（4）③更改： ZT5  4，HL = 1，HR = 0，FHL  6
5.3（4）④更改：ZT5  4，HR = 1，HL = 0， FHR  6
将红外数据有效性互检中的判断逻辑，扣除标称侧摆角度。",0,1,0,0,0,0,0,0
功能描述：根据加在CMG框架上的指令角速度而产生的期望角度与CMG框架产生的实际角度之差，自主诊断CMG框架的工作状态。,0,0,0,0,1,0,0,0
"功能描述：选择通讯的星敏LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输入：ZT6、inAPSLTUSeltFlag、星敏LTU返回的数据。
输出：星敏输出的四元数、相对时间和数据有效性标志。
处理：
（1）星敏共有两个LTU，AOCC每个控制周期向注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中的星敏LTU发送取数指令。
（2）向选择的星敏LTU发送完取数指令后，获得星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,1,0,0
"功能描述：复位取不到重要数据的陀螺引入状态初始化
处理：
复位未取回|采集电源模拟量|大于2.5V的认为引入|若引入陀螺不小于3|补发加电指令
复位未取回|采集电源模拟量|大于2.5V的认为引入|否则(小于3)|按序号补齐3个，发加电指令，10分钟后引入
",1,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的光纤红外控制命令参数,0,0,0,0,0,0,1,0
功能描述：对星敏感器输出数据进行有效性判断。,0,1,0,0,0,0,0,0
"应用软件共分15个工作模式，分别是主动段、入轨段控制模式、CMG启动模式、正常对地运行模式、姿态机动模式、机动姿态保持模式、轨控姿态机动模式、轨控模式、太阳全姿态捕获模式、地地全姿态捕获模式、偏航捕获模式、姿态无控模式、自旋模式、太阳帆板未展开模式、控制计算机应急模式。模式字和各模式的对应关系如下：
表26 工作模式
模式字|意义
0|主动段
1|入轨段控制模式
2|CMG启动模式
3|正常对地运行模式
4|姿态机动模式
5|机动姿态保持模式
6|轨控姿态机动模式
7|轨控模式
8|太阳全姿态捕获模式
9|地地全姿态捕获模式
A|偏航捕获模式
B|姿态无控模式
C|自旋模式
D|太阳帆板未展开模式
E|控制计算机应急模式
",0,1,0,0,0,0,0,0
"软件需求名称：上电和复位初始化 
需求类别：其他 
软件需求描述：系统软件上电复位后，调用应用软件AppInit函数，并根据初始化内容，启动任务
处理：
OBC上电/复位后，由系统软件引导应用软件运行。首先进行初始化，包括系统软件初始化和系统软件调用应用软件提供的初始化函数（AppInit）。启动任务并开始进行任务调度管理。 ",1,0,0,0,0,0,0,0
"功能描述：
循环太阳搜索时对部件的切换（功能编号：FReq-16）。
处理：
(1)第一次滚动搜索不成功时，若另一份SPE健康，切换另一份SPE；
(2)第二次滚动搜索不成功时，若另一份MPSDP健康，切换另一份MPSDP；否则切换另一份SPE，此条件下第三次搜索不成功直接进入（4）;  
(3)第三次滚动搜索不成功时，切换另一份SPE;
(4)第四次滚动搜索不成功时，转停控;
部件切换的间隔周期，在保证不冲突的情况下，软件可自主确定。",0,1,0,0,0,0,0,0
"功能描述：使星体-Z轴捕获太阳，并保持偏置10度的对日定向。
输入：， 陀螺数据处理的输出，；控制周期 (量纲：秒)；
		模拟太阳敏感器状态，LSS输出数据
		模拟太阳敏感器输出： (量纲：弧度)
		计时器",0,1,0,0,0,0,0,0
功能描述：接收数据指令注入块的CMG串口指令,0,0,0,0,0,0,1,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ3.1|5.2.1|把陀螺数据、、、变换到星体系中的、、
|陀螺预估惯性姿态|FREQ3.2|5.2.2|根据陀螺输入，预估卫星惯性姿态
|陀螺预估对地姿态|FREQ3.3|5.2.3|根据陀螺测量输出，一步预估卫星姿态
|陀螺预估惯性四元数|FREQ3.4|5.2.4|根据陀螺测量输出，一步预估卫星惯性姿态
|动力学预估惯性四元数|FREQ3.5|5.2.5|根据动力学模型，预估卫星惯性姿态
|基于红外滤波的卫星姿态确定|FREQ3.6|5.2.6|根据陀螺预估结果和红外(和数字太阳)输出，确定卫星姿态
|星敏感器与陀螺姿态修正|FREQ3.7|5.2.7|利用星敏感器和陀螺的输出或仅利用陀螺预估输出计算卫星欧拉角和四元数
|单星敏感器的姿态修正|FREQ3.7.1|5.2.7.1|利用单个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|双星敏感器的姿态修正|FREQ3.7.2|5.2.7.2|利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|对地姿态修正|FREQ3.7.3|5.2.7.3|利用估计的四元数转换姿态角
|星敏感器与动力学姿态修正|FREQ3.8|5.2.8|利用星敏感器的输出计算卫星欧拉角和四元数
|仅单星敏感器的姿态修正|FREQ3.8.1|5.2.8.1|仅利用单个星敏感器的测量，修正姿态四元数与姿态角速度
|仅双星敏感器的姿态修正|FREQ3.8.2|5.2.8.2|仅利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|无陀螺对地姿态修正|FREQ3.8.3|5.2.8.3|利用估计的四元数转换姿态角，送给星敏感器的四元数
|红外与太阳双矢量定姿|FREQ3.9|5.2.9|利用红外、数字太阳敏感器确定姿态
|星敏感器相对基准标定|FREQ3.10|5.2.10|对星敏的相对基准进行标定，修正星敏安装矩阵
|星敏感器双矢量姿态确定|FREQ3.11.1|5.2.11.1|利用星敏的测量，确定单点的卫星姿态四元数。
|星敏姿态四元数重置|FREQ3.11.2|5.2.11.2|进行卫星姿态四元数的重置
|三轴欧拉姿态角预估算法产品规范|FREQ3.1.1|/|规范化算法：
|姿态四元数预估算法产品规范|FREQ3.1.2|/|规范化算法：
|重力梯度力矩计算算法产品规范|FREQ3.1.3|/|规范化算法：
|基于红外测量的红外滤波修正算法产品规范|FREQ3.1.4|/|规范化算法：
|基于单星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.5|/|规范化算法：
|基于双星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.6|/|规范化算法：
|基于红外与太阳矢量的双矢量定姿算法产品规范|FREQ3.1.7|/|规范化算法：
|星敏感器相对基准的在轨标定算法产品规范|FREQ3.1.8|/|规范化算法：
|目标姿态计算流程|FREQ3.12|5.3.1|""计算模式的目标姿态
""
|点对点机动目标姿态计算|FREQ3.12.1|5.3.1.1|点对点机动目标姿态计算
|轨控目标姿态计算|FREQ3.12.2|5.3.1.2|轨控目标姿态计算
|姿态机动初始化|FREQ3.12.3|5.3.2|三轴姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉轴/角，以及轨迹的加速，匀速和减速等特征时间点。
|""理论偏流角计算
""|FREQ3.12.4.1|5.3.3.1|""适用于地球椭球模型，基于星体姿态描述为1-2-3 转序计算基于星体+Z 轴或基于指定基准轴（该轴应在XOZ 平面内）情况下的偏流角。
""
|偏流角平滑及偏流角速度计算|FREQ3.12.4.2|5.3.3.2|对偏流角修正启动与停止过程中的偏流角进行平滑处理，并计算偏流角速度。
|太阳高度角计算|FREQ3.12.4.3|5.3.3.3|根据偏流角修正基准计算太阳高度角
|姿态控制量计算|FREQ3.19|5.2.12|根据姿态确定结果和目标姿态计算结果计算误差姿态角和误差姿态角速度
|引入系统闭环姿态确定|FREQ3.20|5.2.13|根据定姿标志确定引入系统的闭环姿态
|陀螺标定过程目标姿态计算|FREQ3.25.0|5.11.1|陀螺标定全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角
|目标姿态计算初始化|FREQ3.25.1|5.11.1.1|对陀螺标定过程中涉及到的两次机动过程进行机动姿态计算的初始化
|惯性姿态点对点机动轨迹规划|FREQ3.25.2|5.11.1.2|对陀螺标定过程所涉及到的两次点对点机动进行轨迹规划
|角速度起速保持与减速过程轨迹规划|FREQ3.25.3|5.11.1.3|对陀螺标定过程中的速度运行进行轨迹规划
|惯性定向时转阶段处理|FREQ3.25.5|5.11.1.5|陀螺标定在第1段中完成惯性定向，并在此期间标定陀螺真实常漂。在惯性定向转速度运行结束时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等。
|速度运行时转阶段处理|FREQ3.25.6|5.11.1.6|SubMode= 2~9，陀螺按照规定的角速度完成起速、恒速运行、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等
|速度曲线规划|FREQ3.25.7|5.11.1.7|根据所选择的机动轨迹，规划出角速度变化曲线
|陀螺标定算法|FREQ3.26.0|5.11.2|在标定过程中，对各个阶段的陀螺等效常漂进行估计
|陀螺常漂修正标志确定|FREQ3.26.1|5.11.2.1|对陀螺标定过程中，陀螺常漂的修正标志进行确定。当星体达到了规定的惯性角速度时，开始进行陀螺常漂估计
|基于星敏陀螺滤波的等效常漂估计|FREQ3.26.2|5.11.2.2|采用星敏陀螺滤波的方法对陀螺等效常漂进行估计
|星敏陀螺滤波的陀螺等效常漂记录|FREQ3.26.3|5.11.2.3|对陀螺等效常漂，选取稳态时的一段数据进行平均，得到各个角速度下的等效常漂和星体真实角速度的估计值
|小角速度时的陀螺安装误差和刻度因子误差估计|FREQ3.26.4|5.11.2.4|经过N次速度机动后，对陀螺的测量模型进行标定，给出标定结果
|陀螺在轨标定时的控制量计算|FREQ3.27|5.11.3|对标定过程中的控制量进行计算
|陀螺安装误差标校结果引入|FREQ3.28|5.11.4|对陀螺完成标定后，待地面确认标定结果无误后，将陀螺的标定结果进行赋值。当地面注入FP__MountingCmp时执行本程序一次
|惯性姿态预处理初始化|FREQ3.29.1.1|5.12.1.1|计算惯性定向及扫描的机动参数
|相机扫描速度建立参数计算|FREQ3.29.1.2|5.12.1.2|计算由建立扫描速度初始姿态到建立恒定速度的时间，以及扫描结束后星体静止后的惯性姿态。
|星体阻尼结束至惯性定向姿态建立参数计算|FREQ3.29.1.3|5.12.1.3|计算星体阻尼结束后的姿态调整到凝视标定的惯性定向姿态，或天区扫描速度建立前所需初始惯性姿态
|惯性目标姿态计算|FREQ3.29.2.0|5.12.2|全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角。
|惯性定向轨迹规划|FREQ3.29.2.1|5.12.2.1|对惯性再定向过程进行轨迹规划
|惯性定向转阶段处理|FREQ3.29.2.2|5.12.2.2|惯性再定向转换处理
|惯性空间扫描轨迹规划|FREQ3.29.2.3|5.12.2.3|对惯性空间扫描过程进行轨迹规划
|惯性扫描转阶段处理|FREQ3.29.2.4|5.12.2.4|SubMode = 2，按照规定的角速度完成角速度的建立、恒速扫描、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化
|目标姿态计算初始化|FREQ3.29.2.5|5.12.2.5|对SubMode=1/10子模式进行机动姿态计算的初始化
|惯性定向姿态控制量计算|FREQ3.29.3|5.12.3|对惯性定向过程中的控制量进行计算
|星敏感器的粗姿态计算|FREQ3.30|5.2.14|计算提供给星敏感器的粗姿态
",0,1,0,0,0,0,0,0
功能描述：利用陀螺、红外、数字太阳、星敏感器诊断陀螺,0,1,0,0,0,0,0,0
"功能描述：进行系统故障的检测。
",0,1,0,0,0,0,0,0
"功能描述：利用动量轮控制电压与动量轮转速的控制关系诊断动量轮
",0,1,0,0,0,0,0,0
"序|需求名称|编号|功能和处理描述
|滚动俯仰通道喷气中断服务程序|FREQ81|将滚动俯仰通道相应的推力器关掉
|偏航通道喷气中断服务程序|FREQ82|根据状态字关相应的推力器
|轨控发动机喷气中断服务程序|FREQ83|将轨控发动机关掉，如果有1N轨控则根据轨控状态字关相应的推力器
",0,0,0,0,1,0,0,0
"功能描述：在Z轴已捕获太阳的条件下，完成对日定向及绕Z轴转动。
对日定向下，若在阳照区若连续3000秒无法对日成功，则根据地面指令，进行模拟太阳和数字太阳的自主切换，重新进行太搜，并将地面允许标志置为不允许。
进入条件：
偏航捕获及转对地定向，或{，FEA = 0}；
星敏感器全姿态捕获，星敏感器数据无效，或{FEA = 0，ZT3 = C}条件不成立
全姿态捕获，FSA0, { ZT1 = 3或BZ1 = 3 }
退出条件：
偏航捕获及转对地定向， FEA 0；
星敏感器全姿态捕获，星敏感器数据有效且{FEA = 0，ZT3 = C}条件成立
全姿态捕获，FSA＝0,或ZT1 3且BZ1  3 
处理过程：同用户需求的。
STEP1:FlagFSA=5
STEP2:调用姿态预估器(3)
STEP3:若ZT13≠4，使用模拟太阳定向
STEP4:若ZT13=4，使用数字太阳定向
STEP5:若BZ1 = 3，则调用运行段喷气姿态控制
STEP6:若BZ1 = 4，则调用轨控段喷气姿态控制
STEP7:若ZT2 = 2，FWi  C对工作的飞轮成立，则调用飞轮控制
STEP8:若ZT2  2或FWi<C对某一工作的飞轮成立，则输出控制电压清0。",0,1,0,0,0,0,0,0
功能：利用星敏感器A的测量，修正姿态四元数与估计角速度。,0,1,0,0,0,0,0,0
"功能描述：为机动过程姿态确定提供初始姿态。
",0,1,0,0,0,0,0,0
"功能描述：发送姿态数据包1
",0,0,0,0,0,0,0,1
"功能描述：接收同步控制
处理：根据同步字的编码内容进行相应的处理：",0,0,0,0,0,0,1,0
"功能描述：接收同步控制。
处理：根据应急线路同步字的编码内容进行相应的处理：
编码|相应的处理
28H|发送内存的数据区指针复位
",0,0,0,0,0,0,1,0
"功能描述：分支号与喷管对应选择

处理：
序号|分支状态|姿控分支标志|姿控发动机|轨控分支标志|轨控发动机
1|A、B、C分支都好|A|A1|BC|B1
1|A、B、C分支都好|A|A2|BC|B2+B3+C2+C3
1|A、B、C分支都好|A|A3|BC|B5
1|A、B、C分支都好|A|A4|BC|B4
1|A、B、C分支都好|A|A6|BC|B6+B7+C6+C7
1|A、B、C分支都好|A|A5|BC|B8+B9+C8+C9
2|A、B分支好|A|同A分支|B|同BC
2|A、B分支好|A|同A分支|B|B2+B3
2|A、B分支好|A|同A分支|B|同BC分支
2|A、B分支好|A|同A分支|B|同BC分支
2|A、B分支好|A|同A分支|B|B6+B7
2|A、B分支好|A|同A分支|B|B8+B9
3|A、C好|A|同上|C|C1+C10
3|A、C好|A|同上|C|C2+C3
3|A、C好|A|同上|C|C5
3|A、C好|A|同上|C|C4
3|A、C好|A|同上|C|C6+C7
3|A、C好|A|同上|C|C8+C9
4|B、C好|C|C6+C9|B|同B分支
4|B、C好|C|C7+C8|B|同B分支
4|B、C好|C|C1|B|同B分支
4|B、C好|C|C10|B|同B分支
4|B、C好|C|C2|B|同B分支
4|B、C好|C|C3|B|同B分支
5|A好|A|同A分支|0|无效
6|B好|0|无效|B|同B分支
7|C好|C|同C分支|0|无效",0,1,0,0,0,0,0,0
"功能描述：根据红外、太阳、星敏感器的输出数据判断陀螺故障。
输入：
      陀螺：		故障标志F_GyroDiagnV
本周期陀螺数据的输出 (量纲：弧度)
		   			陀螺等效漂移估值
      红外：  	故障标志IRES_FLAG，数据有效性F_IresValid
          			本周期红外数据处理输出， (单位：弧度)
      数字太阳：	故障标志DSS_FLAG
数据有效性F_Ds1Valid, F_Ds2Valid
          			本周期太阳输出,  (单位：弧度)
	  星敏感器： 	故障标志数组SS_FLAG[2]
数据可用标志F_SAValid, F_SBValid
本周期星敏感器A角速度输出, 
本周期星敏感器B角速度输出, (单位：弧度/秒)
星敏感器A安装矩阵
星敏感器B安装矩阵
本周期采样到的星敏感器A的有效输出(
本周期采样到的星敏感器B的有效输出(
轨道角速度
太阳星历计算输出
标志F_GyroDiagnIresDssORSS",0,1,0,0,0,0,0,0
"功能描述：由平衡方程方法、星敏感器数据进行陀螺的故障检测。
",0,1,0,0,0,0,0,0
"功能描述：与地检通信，获得地检数据。
处理：
功能编号|功能|引用文档
FREQ82|初始化|任务书
FREQ83|地检使用要求|任务书
FREQ84|通信(串口)|任务书
FREQ85|通信故障处理|任务书
FREQ86|数据解包与转换|任务书
FREQ87|地检数据有效性判断、处理|任务书
FREQ88|地检模拟量采集、处理|预留
FREQ89|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
"功能描述：发送实时遥测数据。
处理：应急线路实时帧数字量共一个数据包，共60字节，具体定义见遥测文件。",0,0,0,0,0,0,0,1
功能描述：实现正常模式及侧摆模式下的偏流角计算。,0,0,0,1,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ12|4.2.1|将陀螺有效输出数据，换算成卫星三轴角度增量
|欧拉角姿态预估|FREQ13|4.2.2|根据陀螺输出，预估卫星姿态和姿态角速度
|红外输出的数据处理|FREQ14|4.2.3.1|根据红外输入，计算姿态偏差、弦宽误差估计与量测新息
|太阳输出的数据处理|FREQ15|4.2.3.2|根据姿态估值与数字太阳输出，计算量测的一步预测与新息
|红外的姿态修正|FREQ16|4.2.4.1|根据红外输出，估计卫星姿态与陀螺漂移
|红外与数字太阳双矢量滤波姿态修正|FREQ17|4.2.4.2|利用双矢量姿态输出修正姿态估值、估计陀螺漂移及红外常值误差
|正常模式姿态四元数预估|FREQ18|4.2.5.1|姿态角速度与姿态四元数的预估，包括使用陀螺数据和不使用陀螺数据的姿态四元数预估
|星敏感器数据预处理与姿态修正|FREQ19|4.2.5.2|利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序
|星敏感器A、B姿态修正|FREQ20|4.2.5.3|利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移
|星敏感器A姿态修正|FREQ21|4.2.5.4|利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移
|星敏感器B姿态修正|FREQ22|4.2.5.5|利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移
|正常飞行模式的姿态角估计|FREQ23|4.2.5.9|利用估计的四元数转换姿态角
|由正常模式机动起始时刻的姿态四元数|FREQ24|4.2.6.1|为机动过程姿态确定提供初始姿态
|从偏置机动回正常模式时机动起始时刻的姿态四元数|FREQ25|4.2.6.2|为该机动过程姿态确定提供初始姿态
|机动过程与轨控模式的姿态确定|FREQ26|4.2.6.3|利用陀螺确定出卫星对目标的姿态四元数
|从偏置飞行机动回正常模式后的初始姿态换算|FREQ27|4.2.6.4|为正常模式姿态确定提供初始姿态
|计算星敏感器定姿需要的初始姿态|FREQ28|4.2.7|为星敏感器定姿提供初始的相对惯性的姿态四元数。
|红外与数字太阳双矢量定姿|FREQ29|4.2.8|利用红外、数字/太阳敏感器确定姿态
|星敏感器双矢量定姿|FREQ30|4.2.9|利用星敏感器A、B的测量，估计姿态
|不使用陀螺数据的星敏感器A、B姿态修正|FREQ87|4.2.5.6|利用星敏感器A、B的测量，修正姿态四元数
|不使用陀螺数据的星敏感器A姿态修正|FREQ88|4.2.5.7|利用星敏感器A的测量，修正姿态四元数
|不使用陀螺数据的星敏感器B姿态修正|FREQ89|4.2.5.8|利用星敏感器B的测量，修正姿态四元数
|红外差分姿态确定算法|FREQ90|4.2.10|无陀螺时用红外估计滚动、俯仰姿态角及角速度信息
|卫星跟踪姿态及对地表定向目标角计算|FREQ90.1|""4.2.13
4.2.13.1""|计算卫星正常对地跟踪姿态及对地表定向目标角
|偏航目标角计算|FREQ90.2|4.2.13.2|计算偏航跟踪目标姿态，实现帆板对日定向
",0,1,0,0,0,0,0,0
"功能描述：由平衡方程方法、陀螺自检信号和星敏感器数据进行陀螺的故障检测。

处理：(1)6个或5个陀螺参加诊断时，使用平衡方程进行诊断，并且若ZT35(3)=1地面允许自检信号引入诊断，则自检信号无效的陀螺分数减1。若ZT16(3)(4)=11，则星上自主选取定姿陀螺，否则由地面指定。
(2)4个陀螺参加诊断时，若ZT35(4)=0不允许星敏诊陀螺，则同(1)。
(3)3个陀螺参加诊断时，若ZT35(4)=0不允许星敏诊陀螺，则这3个陀螺就是定姿陀螺。
(4)4个或3个陀螺参加检测时，若ZT35(4)=1，则用星敏差分值诊陀螺。判分的阀值乘以，可以进行调整。当允许星上自主选取定姿陀螺时，仅当平衡方程不平衡时可以切换陀螺。",0,1,0,0,0,0,0,0
轨道计算包括卫星轨道和太阳方位计算、中继卫星轨道计算；GPS计算包括GPS数据转换为轨道平根数计算、GPS平根数数据转换为外推轨道数据计算；地磁场计算为通过轨道外推数据计算地磁场矢量分量。,0,0,0,0,1,0,0,0
"各个模式切换的功能点列表如下：
序号|功能编号|功能
|FREQ51|主动段模式切换
|FREQ51.1|入轨段控制模式切换
|FREQ51.2|巡天观测模式切换
|FREQ51.3|定点观测模式切换
|FREQ51.4|小天区扫描模式切换
|FREQ51.5|姿态机动切换
|FREQ51.6|轨控模式切换
|FREQ51.7|捕获太阳并对日定姿模式切换
|FREQ51.8|帆板未展开切换
|FREQ51.9|无控模式切换
|FREQ51.10|应急模式模式切换
|FREQ51.0|主动段模式初始化
|FREQ51.1.0|入轨段控制模式初始化
|FREQ51.2.0|巡天观测模式初始化
|FREQ51.3.0|定点观测模式初始化
|FREQ51.4.0|小天区扫描模式初始化
|FREQ51.5.0|姿态机动初始化
|FREQ51.6.0|轨控模式初始化
|FREQ51.7.0|捕获太阳并对日定姿模式初始化
|FREQ51.8.0|帆板未展开初始化
|FREQ51.9.0|无控模式初始化
|FREQ51.10.0|应急模式模式初始化

工作模式的转换条件及对应的模式初始化内容具体见用户需求4。
AOCC切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,1,0,0,0,0,0,0
"功能描述：完成遇有单翼帆板未展开时，抖动星体帮助帆板展开的功能。为了节省内存，将此模式的代码从PROM中去掉。若需要此模式，则通过在轨注入的方式，将此模式引入控制。
处理过程：过程如下：
STEP1：如果ZT1 = 5且ZT32 = A且C1 = A1则进行下列处理：
滚动通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP2：如果ZT1 = 5且ZT32 = A且C1 = A2则进行下列处理：
俯仰通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP3：如果ZT1 = 5且ZT32 = A且C1 = A3则进行下列处理：
偏航通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP4：如果ZT1 = 5且ZT32 = A且C1 = FFFF则进行下列处理：
发四个轨控喷管同时工作的脉冲序列：脉冲宽度为0.262，0，0.262，0，… ，0.262，0，共计120个（包括宽度为0的脉冲）。。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。",0,1,0,0,0,0,0,0
"功能描述：CAN通信上行/下行数据的组帧和解包。
调用条件：每个控制任务模式计算完成后；
输入：计算结果。
输出：按照协议组帧数据。
处理：主要完成下列数据组帧、解包功能：星务发送、快帧遥测1打包、快帧遥测2打包、快帧遥测3打包、快帧遥测4打包、快帧遥测5打包、慢帧遥测打包、姿态广播、星敏广播、陀螺广播、其他广播(行周期广播)、重要数据打包、上行:数据指令响应处理、上行:固定地址注入解包、上行:可变地址注入解包、上行:轨道注入解包、上行:程序注入、上行:内存下卸指令注入、上行:任务块、上行:地面站、重要数据返回解包、GPS定位广播解包、整星广播对时解包、GPS高精度秒脉冲对时广播解包、CAN总线使用要求",0,0,0,0,0,0,0,1
功能描述：计算光行差的修正参数，数字太阳敏感器输出角估值。,0,1,0,0,0,0,0,0
功能描述：计算太阳星历、红外补偿量及光行差计算。,0,1,0,0,0,0,0,0
"需求名称|功能及处理描述
对地数传天线1数据的采集与处理|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
对地数传天线2数据的采集与处理|对地数传天线2的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
中继天线数据的采集与处理|在总线指令要求通讯允许的条件下，每500ms向中继天线 LTU发控制指令，获得中继天线数据并处理成对应的角度等信息。",0,0,0,1,0,0,0,0
"功能描述：仅利用星敏感器A、C的测量，修正姿态四元数与姿态角速度移。
",0,1,0,0,0,0,0,0
"功能描述：接收对应秒脉冲的整秒时刻
处理： 将接收对应秒脉冲的整秒时刻存储地址中内容解包成对应秒脉冲的整秒时刻的数据格式。",0,0,0,0,0,0,1,0
"功能描述：计算CMG的框架角速度,。",0,1,0,0,0,0,0,0
功能描述：设置7类快帧遥测数据下传顺序,0,0,0,0,0,0,0,1
"功能描述：与数字太阳通信，发送取数指令，获得部件数据。                                                                                                                                                                                                                                                                                                                                                                                                                    处理：
在AOCC每个控制周期中可能会通过串口向数太发送控制指令或者接收下传数据，见任务书时序图。
功能编号|功能|引用文档
FREQ66|初始化|与一体化太阳通信协议
FREQ67|数太使用要求|任务书、数太协议
FREQ68|通信|任务书、数太协议
FREQ69|通信故障处理|任务书
FREQ70|数据解包与转换|数太协议
FREQ71|数太数据有效性判断、处理|任务书
FREQ72|数太模拟量采集、处理|预留
FREQ73|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,1,0,0
"功能描述：用整星广播时间校正星上时间
处理：解包广播校时数据，
- 若为星务UTC校时，计算星务星箭分离星时；
- 若当前星时与星务星箭分离星时相差绝对值小于dt，则实施校时；否则不校时。
- 校时成功后，更新星敏、CCD、微波测距仪、可见光相机的同步信号基准时刻。
说明：上电/复位时，dt = 200秒；成功校时后，dt = 10秒",0,0,0,0,0,0,1,0
"功能描述：计算正常飞行模式轮控所需电压。
",0,1,0,0,0,0,0,0
"功能描述：利用星敏感器A、B的测量，估计姿态。
输入：	星敏感器数据可用标志F_UsingSS
      	本次采样到的星敏感器A的有效输出(只考虑取一个情况) 
本周期采样到的星敏感器B的有效输出
太阳星历的输出
输出：	本体相对轨道系的姿态
",0,1,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的轨迹规划修正系数
",0,0,0,0,0,0,1,0
"功能描述：0.5秒中断采集各部件数据
输出：内存单元保存的各部件数据与状态。
处理：  
     处理流程如下图所示：
                      图11：数据采集处理流程",0,0,0,0,0,1,0,0
"功能描述：根据陀螺输出，预估卫星姿态和姿态角速度。
输入：上周期姿态角估值
陀螺数据处理的输出 
陀螺系统在星体三轴方向等效的漂移估值 (量纲：弧度/小时)（消初偏时取装订值）。
卫星外推轨道计算输出：",0,1,0,0,0,0,0,0
"软件需求标识：FREQ20 
软件需求名称：动量轮数据处理 
需求类别：其他 
软件需求描述：动量轮数据处理。",0,0,0,0,0,1,0,0
"功能描述：伴飞模式下，计算视速度增量关机时间长度
",0,1,0,0,0,0,0,0
"    各个模式切换的功能点列表如下： 
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ43.0|3.3.0|主动段模式切换条件判断及转出设置
|入轨消初偏模式切换|FREQ43.1|3.3.1|入轨消初偏模式切换条件判断及转出设置
|红外引入对地粗定向模式切换|FREQ43.2|3.3.2|红外引入对地粗定向模式切换条件判断及转出设置
|动量轮启动模式切换|FREQ43.3|3.3.3|动量轮启动模式切换条件判断及转出设置
|正常轨道运行模式切换|FREQ43.4|3.3.4|正常轨道运行模式切换条件判断及转出设置
|轨控模式1模式切换|FREQ43.5|3.3.5|轨控模式1模式切换条件判断及转出设置
|由正常姿态进行姿态机动模式切换|FREQ43.6|3.3.6|由正常姿态进行姿态机动模式切换条件判断及转出设置
|轨控模式2模式切换|FREQ43.7|3.3.7|轨控模式2模式切换条件判断及转出设置
|由轨控姿态机动回正常轨道运行模式切换|FREQ43.8|3.3.8|由轨控姿态机动回正常轨道运行模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ43.9|3.3.9|全姿态捕获模式切换条件判断及转出设置
|应急安全模式模式切换|FREQ43.10|3.3.10|应急安全模式模式切换条件判断及转出设置
|停控模式切换|FREQ43.11|3.3.11|停控模式切换条件判断及转出设置
|帆板未展开模式切换|FREQ43.12|3.3.12|帆板未展开模式切换条件判断及转出设置
|偏置动量控制模式切换|FREQ43.13|3.3.13|偏置动量控制模式切换条件判断及转出设置

切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,1,0,0,0,0,0,0
"软件需求名称：星时校正 
需求类别：其他 
软件需求描述：校正星上星时。
",0,0,0,0,0,1,0,0
功能描述： GPS定轨主程序，包括GPS数据有效、无效时的操作。,0,1,0,0,0,0,0,0
"功能描述：地地全姿态捕获模式控制
处理：
若SystemAttDeterPatternFlag由0变1，则重新计算q，qng赋值。",0,0,0,0,1,0,0,0
"功能描述：根据红外输入，计算姿态偏差、弦宽误差估计与量测新息。
",0,1,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：姿态角与角速度估值：
正常模式星敏感器与陀螺定姿输出 
，
或：正常模式其它情形相应程序的输出，
惯性角速度估值：
    陀螺角速度估值 ，
    或：星敏感器定姿输出(F_NoGyro=1或3) =[，]T
实测飞轮角动量    ，
      斜轮标称角动量    
      姿态偏差积分项    ，
      斜轮角动量偏差积分项  
标志F_SatStage
=[，]T",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|甚高三浮陀螺数据的采集与处理|FREQ1.2.1|""甚高三浮陀螺1553B取数指令
""|陀螺1-6的速度增量|在通讯允许的条件下（每个甚高陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|甚高光纤陀螺数据的采集与处理|FREQ1.2.2|甚高光纤陀螺1553B取数指令|陀螺7-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,1,0,0
"功能描述：追踪器GPS数据有效性判断及处理 
处理：见《卫星GNC分系统GNC计算机应用软件用户需求》的P48-P49。",0,1,0,0,0,0,0,0
功能描述：为该机动过程姿态确定提供初始姿态。,0,1,0,0,0,0,0,0
"序|需求名称|编号|调用条件|功能和处理描述
|上电初始化|FREQ11.0|上电时|""1553B（内总线）初始化：按通讯协议要求进行设置
SpaceWire总线（外总线）初始化：按通讯协议要求进行设置
CAN总线（外总线）初始化：按通讯协议要求进行设置，
变量初始化""
|复位初始化|FREQ11.1|复位时|""1553B（内总线）初始化：按通讯协议要求进行设置
SpaceWire总线（外总线）初始化：按通讯协议要求进行设置
CAN总线（外总线）初始化：按通讯协议要求进行设置，
变量初始化""",1,0,0,0,0,0,0,0
"功能描述：根据给定电压乘电压/力矩系数和角动量变化率之差判断轮子的故障。
",0,1,0,0,0,0,0,0
"功能描述：由模拟太阳信号码、监视码得到模拟太阳角、见太阳标志。
",0,0,0,0,0,1,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|甚高陀螺数据的采集与处理|FREQ1.2.1|""甚高陀螺1553B取数指令（硬件同步信号或广播同步消息）
""|陀螺1-6的速度增量|在通讯允许的条件下（每个甚高陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|光纤陀螺数据的采集与处理|FREQ1.2.2|""光纤陀螺LTU取数指令
""|陀螺7-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,1,0,0
功能描述：将GPS轨道确定参数转换成控制系统中太阳星历和地磁场计算所需的19个轨道参数,0,1,0,0,0,0,0,0
功能描述：地地全姿态捕获模式初始化,0,1,0,0,0,0,0,0
"功能描述：根据帆板角误差、控制帆板跟踪太阳。
",0,1,0,0,0,0,0,0
"功能描述：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。
",0,0,0,0,1,0,0,0
"软件需求名称：化学推进使用及通信 
需求类别：其他 
软件需求描述：与发动机通信，输出本周期喷气脉宽。
处理：
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
UPS初始化|FREQ52|UPS初始化|B|2
化学推进数据采集|FREQ53|化学推进数据采集|B|3
推力器脉冲输出|FREQ54|推力器脉冲输出|B|4
推力器健康字设置|FREQ55|推力器健康字设置|B|5
部件操作（程控490N点火，故障重构）|FREQ56|部件操作（程控490N点火，故障重构）|B|
",0,0,1,0,0,0,0,0
"功能描述：卫星的10个工作模式切换方式。
处理：
对每个模式分别按照切换条件处理。见用户需求3.3节。
工作模式切换表
""换后
模式
切换
前模式""|Mode1|Mode2|Mode3|Mode4|Mode5|Mode6|Mode7|Mode8|Mode9
Mode0|1,2||||||||1,2
Mode1||1,2||||||2|1,2
Mode2|||2|2||||1,2|1,2
Mode3||2||1,2|||||1,2
Mode4||1,2|||1,2||||1,2
Mode5||1,2||1,2||1,2|||1,2
Mode6||1,2||2|1,2||1,2||1,2
Mode7||2|||1,2|1|||1,2
Mode8||1,2|||||||1,2
Mode9||1,2|||||||

说明：代号“1”表示自主进入；代号“2”表示地面/总线指令进入",0,1,0,0,0,0,0,0
功能：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移,0,1,0,0,0,0,0,0
"功能描述：在红外太阳定姿方式下计算四元数，在其余定姿方式下计算欧拉角。
",0,1,0,0,0,0,0,0
"软件需求名称：动量轮控制 
需求类别：其他 
软件需求描述：根据控制律计算结果，驱动动量轮，进行姿态控制。",0,0,1,0,0,0,0,0
功能描述：三浮陀螺数据处理,0,0,0,0,0,1,0,0
"软件需求名称：帆板驱动装置的处理 
需求类别：其他 
软件需求描述：对帆板驱动装置的加断电等进行特殊处理。",0,0,1,0,0,0,0,0
功能描述：根据注入轨道参数计算太阳轨道、方位与其他参数。,0,1,0,0,0,0,0,0
功能描述：主动段模式控制,0,1,0,0,0,0,0,0
"功能描述：与动量轮通信，输出本周期电压。采集动量轮模拟量信息。
处理：
功能编号|功能|引用文档
FREQ102|初始化(加电)|任务书
FREQ103|动量轮使用要求(方向等)|任务书
FREQ104|通信(DA输出、脉冲输入)|任务书
FREQ105|通信故障处理|预留
FREQ106|数据解包与转换|任务书
FREQ107|处理动量轮数据有效性处理|任务书
FREQ108|动量轮模拟量采集、故障|任务书
FREQ109|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
"功能描述：检测系统故障，给出故障标志。
",0,0,0,1,0,0,0,0
"软件需求标识：FREQ19 
软件需求名称：星敏数据处理 
需求类别：其他 
软件需求描述：星敏数据处理。",0,0,0,0,0,1,0,0
"功能描述：实现运行段姿态、帆板和天线的控制。
处理：
（1）Call  （飞轮控制）
（2）若ZT8  3，ZT9  3，ZT，ZT3  B ，{{BZ1 ≠ 8，{{FHU=A，ZT2=2，FWH ≠ 22}或ZT2≠ 2或FWH =22}}或{ BZ1 = 8，FRTS = 1}}，则：
Call  （运行段喷气姿态控制）
（若ZT3 = F，则每4秒Call  一次）（不调用喷气控制时确认电磁阀全关）
（3）若ZT7  8，则： 
Call  （运行段帆板控制）
若ZT7 = 0，则：发两翼帆板归零指令
若ZT7 = 3，则：发左翼为90度，右翼为 -90度指令
若ZT7 = 5，则：发左右皆为90度指令
若ZT7 = 7，则：发左右皆为180度指令
（4）Call  5.9（陀螺故障检测及选择）
（5）若BZ1 = 1或8或9，ZT40(4) = 1，则：
Call  1.7（数传天线捕获跟踪控制）",0,1,0,0,0,0,0,0
"功能描述：消除星体角速度，并使星体Z 轴指向太阳
",0,1,0,0,0,0,0,0
"功能描述：利用星敏感器和陀螺输出计算姿态四元数。
",0,1,0,0,0,0,0,0
"功能描述：入轨后或太阳丢失后，搜索太阳并捕获太阳。
处理：
自主或指令转入该模式，进行如下设置。
根据自锁阀状态设置自锁阀1和/或自锁阀2开。
系统诊断出故障后进入该模式，100秒内不控，具体要求见用户需求。
每个控制周期顺序调用用户需求中的逻辑：
调用轨道与星历；
if(CMGStartFlag=1) 调用CMG数据采集及处理；
调用部件故障检测与信号选取；
调用陀螺数据处理；
	调用惯性姿态陀螺预估；
调用星敏感器数据处理；
调用太阳捕获控制；
调用目标姿态确定；
调用控制器输入量计算；
喷气卸载条件计算
if(CMGStartFlag=1) 调用CMG奇异状态的判断及算法计算；
	if(CMGInControlFlag=1 且UnLoadMode=0)
{ 调用CMG的控制；
if(SSTCatchSuc＝1) 调用 磁卸载控制； }
else { if(CMGStartFlag=1) 调用 CMG启动与保持；
if(TimeStopC<=0且Flag_equation=0) 
{调用 相平面喷气脉宽； }
else {置喷气脉宽为0；SpeedControlTime=0；WacFlag=1；}
}
	调用 系统故障诊断；",0,1,0,0,0,0,0,0
"功能描述：诊断姿控喷管微漏故障
",0,1,0,0,0,0,0,0
"功能描述：PID计算控制力矩经过结构滤波器后，改善姿态控制效果。
处理：
STEP1:滚动通道滤波；
STEP2:俯仰通道滤波；
STEP3:偏航通道滤波。",0,1,0,0,0,0,0,0
"序|需求名称|编号|调用条件|功能和处理描述
|上电初始化|FREQ11.0|上电时|""1553B（内总线）初始化：按通讯协议要求进行设置，初始化RAM区为0
1553B（外总线）初始化：按通讯协议要求进行设置，初始化RAM区为0
当班状态设置
GPS秒脉冲信号设置
脉冲计数初始化
星敏同步信号寄存器初始化
变量初始化""
|复位初始化|FREQ11.1|复位时|""1553B（内总线）初始化：按通讯协议要求进行设置，初始化RAM区为0
1553B（外总线）初始化：按通讯协议要求进行设置，初始化RAM区为0
当班状态设置
GPS秒脉冲信号设置
脉冲计数初始化
星敏同步信号寄存器初始化
变量初始化""
",1,0,0,0,0,0,0,0
"序|需求名称|编号|功能及处理描述
|数字太阳数据的采集与处理|FREQ1.1|""选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
""
|模拟太阳数据的采集与处理|FREQ1.2|""选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
""
|01太阳数据的采集与处理|FREQ1.3|""选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
""
",0,0,0,0,0,1,0,0
"功能描述：CMG奇异状态的判断及算法计算。
输入：采集得的各CMG的框架角Sgang[i]（弧度）；CMG有效性标志Lcmg[i]，Jacobi矩阵sgJ",0,1,0,0,0,0,0,0
"功能描述：帆板驱动线路数据处理 
",0,0,0,0,0,1,0,0
功能描述：若3000秒（全姿态捕获除速率阻尼外1000秒，可注入修改）内，三轴中任一轴喷气总量（正负轴单独判断）超过范围（正常模式50s，粗定向和轮子启动、全姿态捕获100s，可注入修改），则根据自锁阀状态，开关自锁阀。全姿态模式下,0,1,0,0,0,0,0,0
"软件需求名称：接收上行注入数据指令 
需求类别：其他 
软件需求描述：接收并处理上行注入数据指令。",0,0,0,0,0,0,1,0
功能描述：星上实时计算地磁场强度。,0,1,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：动量轮启动的程控指令
      实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：， ，
",0,1,0,0,0,0,0,0
"软件需求名称：接收总线指令 
需求类别：其他 
软件需求描述：接收并处理总线指令。",0,0,0,0,0,0,1,0
"功能描述：利用估计的四元数转换姿态角，计算送给星敏感器的四元数。
",0,1,0,0,0,0,0,0
"功能描述：决定轨控开关机及姿控，输出相应的状态标志及数据。
处理：在各种条件下的处理见下表所示：判断的顺序为自上而下。
表37：轨控开关机的判别处理
条件|处理
""或
""|""FJO = 0
TJO = 0""
""ZT8  3且
ZT9  3且
""|FTO = 0，FXO = 0，
""且
ZT8  3且
0 < ZT9  3且
FTO  A
""|""	时间关机条件： 

姿态关机条件如下：
轨控推力器开关判断：

喷气长度和累计计算如下

""
""BZ1=6
轨控期间""|发的指令
{ FTO = A }，星体无偏航机动|C1 = CCCC
",0,1,0,0,0,0,0,0
"功能描述：接收AOCC重要数据1-4，并处理重要数据1中的内容。
处理：应急线路加电后与OBDH通信，获得陀螺和推力器状态，若连续3个控制周期都没有成功取得重要数据，默认陀螺使用7、8、9号，推力器使用主备份推力器，模拟式太阳敏感器使用ASS1和ASS21。由于AOCC可使用的陀螺为12个（陀螺1~12），可使用的陀螺为9个（陀螺1~9），因此，无法使用陀螺10~12的数据。当恢复AOCC重要数据后，若ZT9表明使用了陀螺10~12，则设置ZT9中陀螺10~12为不可用，陀螺7、8、9为可用，陀螺工作状态BZ9按照设置后的ZT9中由小到大的顺序（从陀螺1到陀螺9）选用3个陀螺。",0,0,0,0,0,0,1,0
"功能描述：处理地面遥控注入的用于替换EEPROM的代码
处理：
-  解包EEPROM代码注入包，得到帧号、源地址（SRAM）、目的地址（EEPROM）、注入内容长度；
- 以源地址为起始地址，将注入内容放入该SRAM区域
说明：星务分系统向GNCC送数采用256字节(有效使用249字节)帧格式。数据格式见《卫星GNC分系统GN与星务分系统通讯协议》",0,0,0,0,0,0,1,0
"功能描述：模式5切换方式。
处理：
若（且WorkModeT=6且 (且)连续次，WorkMode=6；
若（且WorkModeT=4且 (且)连续次，WorkMode=4；
若{若，则WorkMode= WorkModeT，否则WorkMode=4}；
若FailureFlag=3，置WorkMode=2；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；",0,1,0,0,0,0,0,0
"功能描述：将陀螺有效输出数据，换算成卫星三轴角度增量。
",0,1,0,0,0,0,0,0
功能描述：发送控制系统星历数据。,0,0,0,0,0,0,0,1
功能描述：接收遥控固定参数注入块的外1533B接收子地址内存管理区,0,0,0,0,0,0,1,0
功能描述：接收PVT数据,0,0,0,0,0,0,1,0
功能描述：接收遥控固定参数注入块的地面站位置信息功能区数据,0,0,0,0,0,0,1,0
"功能描述：采集动量轮的转速方向和脉冲计量，计算动量轮的角动量
处理：
（1）读每路动量轮的转速脉冲数，将读到的上一个周期的计数器的值减去本周期的计数器的值（要进行计数器过零时的处理），将差值乘以系数0.0395784。
（2）读每路动量轮的转速方向。AOCC通过并行口（F2H）的D0～D5分别测量MW1～MW6的转动方向，测得0表示反转，1表示正转。
（3）将（1）和（2）的结果相乘得到六个动量轮的角动量，
，（Nms）
动量轮状态确定：根据BZ9、BZ10确定参与工作的动量轮标志FWH，FWH取值与BZ9、BZ10的逻辑关系如下表所示，具体见用户需求5.12，其中BZ9、BZ10由动量轮故障诊断确定。
    表33：动量轮状态确定
BZ9、BZ10的组合情况|FWH取值
BZ10（2）|FWH取值
1|0（动量轮无故障）
1|1（动量轮1故障）
1|2（动量轮2故障）
1|3（动量轮3故障）
1|4（动量轮4故障）
1|5（动量轮5故障）
0|6（动量轮6故障）
1|7（动量轮1、5故障）
1|8（动量轮2、5故障）
1|9（动量轮3、5故障）
1|10（动量轮4、5故障）
0|11（动量轮1、6故障）
0|12（动量轮2、6故障）
0|13（动量轮3、6故障）
0|14（动量轮4、6故障）
0|15（动量轮5、6故障）
1|16（动量轮1、2故障）
1|17（动量轮1、3故障）
1|18（动量轮1、4故障）
1|19（动量轮2、3故障）
1|20（动量轮2、4故障）
1|21（动量轮3、4故障）
其余组合|FWH值不变
",0,0,0,0,0,1,0,0
"功能描述：选择通讯的中等精度星敏LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）中等精度星敏共有三个LTU，AOCC每个控制周期向注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中的中等精度星敏LTU发送取数指令。
（2）向选择的中等精度星敏LTU发送完取数指令后，获得中等精度星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,1,0,0
"软件需求名称：上电/复位后模式转换处理 
需求类别：其他 
软件需求描述：电/复位后模式转换处理”。",0,1,0,0,0,0,0,0
功能描述：对数传天线控制指令的处理 ,0,0,1,0,0,0,0,0
"“复位进入模式”中应用软件进行如下初始化工作：
置星时为2100秒；
置“向星务分系统申请重要数据”标志。
在“复位进入模式”中AO进行如下工作：
控制量输出均为0。部件开关设置为“不进行任何操作”。
响应星务分系统遥测轮询、数据遥控指令、数据注入、程序注入并进行相应处理，但不响应星务重要数据的轮询。
在“复位进入模式”中AO不进行控制律计算。",1,0,0,0,0,0,0,0
"功能描述：利用红外数据自主诊断红外部件状态
",0,1,0,0,0,0,0,0
"功能描述：为三轴姿态喷气控制选择推力器。                                                                                                                                                                                                                                                                                                                                                                                                                                                       输入：标志F_JetGroup，F_SatStage
姿态角与角速度：
正常模式星敏感器与陀螺定姿输出(F_NoGyro=0或2) 
，(量纲：弧度)
，(量纲：弧度/秒)
或：正常模式星敏感器定姿输出(F_NoGyro=1或3时)
(量纲：弧度)
(量纲：弧度/秒)
或：机动与轨控模式姿态输出(无量纲)，(量纲：弧度/秒)
或：其它情形相应程序的输出
，(量纲：弧度)
，(量纲：弧度/秒)
，(量纲：度)
输出：	喷气状态，
各推力器分配脉宽，
累计三轴姿控正向喷气时间：，
累计三轴姿控负向喷气时间：，
=[，]T(量纲：弧度/秒2)",0,1,0,0,0,0,0,0
功能描述：星上实时计算卫星轨道。,0,1,0,0,0,0,0,0
AOCC在收到此指令并且判断数据正确后，即认为星箭分离有效，通过方式代码的服务请求，申请OBDH停止发送星箭分离信号。当AOCC应用软件接收到CTU发送至AOCC的通知进全捕指令时，AOCC自主转入全捕模式，并通过服务请求告诉CTU  AOCC已收到CTU通知进全捕指令，停止传送该信号，具体要求详见《星串行数据总线通信协议》。,0,0,0,0,0,0,1,0
"软件需求名称：自锁阀开关控制 
需求类别：其他 
软件需求描述：控制自锁阀开关。",0,0,1,0,0,0,0,0
"功能描述：部件加电标志。与光纤陀螺通信功能。
处理：
见陀螺通信协议、任务书。
功能编号|功能|引用文档
FREQ49|初始化|陀螺协议
FREQ50|陀螺使用要求|任务书
FREQ51|通信|陀螺协议
FREQ52|通信故障处理|任务书
FREQ53|数据解包与转换|陀螺协议
FREQ54|陀螺数据有效性判断、处理|任务书
FREQ55|陀螺模拟量采集、处理|任务书
FREQ56|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,1,0,0
"功能描述：决定采用磁卸载还是喷气卸载方式，调用相应程序。
",0,1,0,0,0,0,0,0
"功能描述：检测推力器的微漏，必要时作相应的主备份切换。
处理：
Ix=Iy=Iz=0",0,1,0,0,0,0,0,0
"功能描述：接收时间码
处理： 记录收到时间码时对应的GPT的计数值和时间码值，并设置相应的标志。",0,0,0,1,0,0,0,0
功能描述：发送全姿态捕获模式数据包,0,0,0,0,0,0,0,1
"序|需求名称|编号|输入章节号|功能描述
|卫星轨道计算|FREQ8|4.1.1|星上实时计算卫星轨道
|GPS计算|FREQ9|4.1.1.2|将GPS轨道确定参数转换成控制系统中太阳星历和地磁场计算所需的19个轨道参数
|光行差的修正参数和数字太阳敏感器输出角估值计算|FREQ10|4.1.2|计算光行差的修正参数，数字太阳敏感器输出角估值
|地磁场模型计算|FREQ11|4.1.3|星上实时计算地磁场强度
",0,1,0,0,0,0,0,0
"功能描述：根据陀螺输入，予估q及姿态角（在星测量回路中），等。。
处理：同用户需求的1.6。
STEP1:计算星敏预估角速度，。计算结果的限幅值是0.027。计算公式见1.6（1）。
STEP2:计算q,和，计算公式见1.6（2）。
STEP3:计算，。对于计算结果，当BZ1=8（侧摆机动）时，否则。对于计算结果，。对于计算结果，。计算公式见1.6（3）。",0,1,0,0,0,0,0,0
功能描述：若本周期角动量与上一周期角动量之差（绝对值）大于0.15Nms，则用上一周期角动量作为本周期输入，角动量变化取0。若连续大于三次或本周期与上一周期角动量之差（绝对值）小于0.15Nms，则以本周期角动量为真值，角动量变化,0,1,0,0,0,0,0,0
"功能描述：搜索并捕获太阳，完成并保持帆板对太阳定向
",0,1,0,0,0,0,0,0
"功能描述：选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输出：数字太阳敏感器输出；模拟太阳敏感器输出；模拟式太阳敏感器视场码；0-1式太阳敏感器的信号（0或1）；数字太阳敏感器视场码。
处理：
（1）太阳共有两个互为备份的LTU，通过每个LTU均可获得数字太阳、模拟太阳、0-1太阳数据；每个控制周期根据DSSLTUSeltFlag确定进行通讯的太阳LTU，发送取数指令。
（2）向太阳LTU发完取数命令后，获得太阳LTU返回的个字节数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式。
",0,0,0,0,0,1,0,0
"功能描述：采集动量轮的转速方向和脉冲计量，计算动量轮的角动量
处理：处理如下：
（1）读每路动量轮计算器的值，将读到的计数器的值减去上一个周期的计数器的值，得到差值；
（2）根据转换公式将脉冲数转换为角动量。
（3）令（i = 1，2，… ，6）。为上一次轮子角动量值。",0,0,0,0,0,1,0,0
"功能描述：把陀螺数据、、输入并变换到星体坐标系中的、、；输入陀螺自检信号GDi（i = 1，…，6）。
处理：
用户需求的的6(1)：陀螺脉冲当量；
用户需求的的6(2)
STEP1:A阵计算；
STEP2:",0,1,0,0,0,0,0,0
"功能描述：采集并处理四个动量轮加电状态，三路伽马关机敏感器关机信号，四路触地开关信号                                                                                                                                                                                                                                                                                                                                          处理：
序号|功能点编号|功能描述
1|FREQ3.3.1|动量轮加电状态
2|FREQ3.3.2|三路伽马关机敏感器关机信号
3|FREQ3.3.3|四路触地开关信号
",0,0,0,0,0,1,0,0
"功能：利用估计的四元数转换姿态角，送给星敏感器的四元数。
",0,1,0,0,0,0,0,0
"功能描述：根据指令完成数传天线的指向控制。
输入：
数传天线(j=1,2)跟踪地面站编号i，跟踪起始时刻ti，地面站i在惯性系指向，被数传天线(j=1,2)跟踪的地面站i指向卫星矢量，卫星指向被数传天线(j=1,2)跟踪的地面站i的矢量在本体系的表示。（i可为1~7）。
输出：
数传天线1和2的指令转角，指令转速，或者复位及保持控制指令。",0,1,0,0,0,0,0,0
"软件需求名称：部件加断电 
需求类别：其他 
软件需求描述：对部件加断电指令的处理。",0,0,0,1,0,0,0,0
"功能描述：星敏感器数据处理，安装偏差估计。
",0,1,0,0,0,0,0,0
功能描述：对弦宽、基准与给定的范围进行比较，确定红外故障。若两红外数据均有效，则还可根据本周期与上周期红外姿态角确定红外故障。,0,1,0,0,0,0,0,0
"功能描述：二次电源切换。
处理：
ACU内部含有两套二次电源，两套互为备份，可以同时加电工作，通常仅一份工作。AOCC每个控制周期采集工作电源的状态模拟量，并设置当班状态（5V和12V遥测模拟量≥3V即当班，若同时符合条件则置主份当班），若连续4个控制周期两套电源均不当班，且允许自主切换，则连续两个控制周期先后发送主份电源开、备份电源关两条指令，并置主份当班。
若当班电源的5V或12V遥测模拟量连续5个控制周期<3V时，且允许自主切换，则连续两个控制周期先后发送另一份电源开、本电源关两条指令，并禁止自主切换；若禁止自主切换，则设置切机命令字。
上电/复位初始化为允许自主切换，当班标志为保持。",0,0,0,1,0,0,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。CCU应用软件取数消息与同步消息的发送时间间隔不小于2ms。
-Y帆板数据的采集与处理|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,1,0,0
"功能描述：选择星敏感器有效数据进行几何姿态确定，并在星敏无效情况下并采用陀螺数据进行姿态预估。
",0,1,0,0,0,0,0,0
功能描述：利用星敏感器数据进行卫星姿态捕获。,0,1,0,0,0,0,0,0
"功能描述：根据红外信息，作姿态滤波修正。
处理：同用户需求的",0,0,0,0,1,0,0,0
"控制计算机实时遥测包括下表的功能点。
序号|功能描述|功能编号
|发送姿态数据包1|FRE65
|发送姿态数据包3|FRE65.1
|星敏感器姿态数据包|FRE65.2
|星敏感器自检数据包|FRE65.3
|姿态控制数据包|FRE65.4
|轨道数据包|FRE65.5
|LTU自检数据包|FRE65.6
|AOCC及状态数据包|FRE65.7
|发送星敏修正数据包|FRE65.8
|发送对日定向数据包|FRE65.9
|数传天线地面夹角数据|FRE65.10

具体的内容及遥测模式切换的原则详见遥测文件。",0,0,0,0,0,0,0,1
功能描述：自旋模式控制,0,1,0,0,0,0,0,0
"功能描述：计算磁卸载所需的磁矩与磁力矩器工作电压。
",0,1,0,0,0,0,0,0
功能描述：计算在整星角动量偏置下，CMG控制时的框架角速率指令。,0,1,0,0,0,0,0,0
功能模式：姿态机动的初始化计算。,0,1,0,0,0,0,0,0
"功能描述：使星体由任意姿态完成重捕地球。
",0,1,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的姿态偏置系数
",0,0,0,0,0,0,1,0
功能描述：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移。,0,0,0,1,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|星敏感器1数据的采集与处理|FREQ1.5.1|""星敏感器
1553B取数指令
""|星敏感器1的四元素、角速度和状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器1数据并处理成对应的四元素和角速度。
|星敏感器2数据的采集与处理|FREQ1.5.2|""星敏感器
1553B取数指令""|星敏感器2的四元素、角速度状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器2数据并处理成对应的四元素和角速度。
|星敏感器3数据的采集与处理|FREQ1.5.3|""星敏感器
1553B取数指令""|星敏感器3的四元素、角速度状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器3数据并处理成对应的四元素和角速度。
|星敏感器4数据的采集与处理|FREQ1.5.4|""星敏感器4
1553B取数指令""|星敏感器4的四元素、角速度状态信息|在通讯允许的条件下（星敏感器4的当班标志为1），每周期向星敏感器 RT发取数指令，获得星敏感器4数据并处理成对应的四元素和角速度。
",0,0,0,0,0,1,0,0
"功能描述：计算偏置动量模式下滚动/偏航轴进动控制及章动阻尼所需的磁力矩器脉宽。                                                                                                                                                                                                                                                                                                                                                           输入：
Y轴角动量偏差    
滚动角，滚动角速度，偏航角，偏航角速度
地磁场强度（T） ，及标量B，星下点经纬度L,
输出：磁力矩器工作脉宽，",0,1,0,0,0,0,0,0
"功能描述：卫星速率阻尼下来后，转动卫星，使得数字或模拟太阳见到太阳；先绕本体x轴转动，若转动360度太阳未见太阳，停止x轴转动，再绕本体y轴转动，若转动360度太阳仍未见太阳，重复上述过程(若模拟太阳搜索，则减少转动角度)；
输入：，控制周期；滚动、俯仰数字太阳监视码，TsearchSun；滚动、俯仰模拟太阳监视码；

",0,0,0,1,0,0,0,0
"功能描述：根据轨道数据计算偏流角。
",0,1,0,0,0,0,0,0
功能描述：模拟太阳故障状态。,0,1,0,0,0,0,0,0
"功能描述：设置2类慢帧遥测数据下传顺序
触发条件：模式字改变、数据指令",0,0,0,0,0,0,0,1
"序|需求名称|编号|输入章节号|功能描述
|轨道与星历|FREQ2.0|5.1.1|卫星轨道、太阳星历、地面站位置、地磁场强度等计算程序的主流程。
|卫星轨道计算|FREQ2.1|5.1.2|计算卫星当前轨道
|GPS轨道数据有效性判断|FREQ2.2|5.1.3|对GPS轨道数据的有效性进行判断
|GPS轨道版轨道计算|FREQ2.3|5.1.4|利用GPS轨道版数据进行GPS定轨程序
|轨道、目标姿态预计算|FREQ2.4|5.1|完成下控制周期的轨道星历与目标姿态预先计算
|近圆中低轨卫星轨道根数外推算法产品规范|FREQ2.5|/|规范化算法：
|近圆中低轨卫星GPS轨道计算算法算法产品规范|FREQ2.6|/|规范化算法：
|岁差章动矩阵计算算法算法产品规范|FREQ2.7|/|规范化算法：
|4阶星上地磁场计算方法算法产品规范|FREQ2.8|/|规范化算法：
|光行差计算算法产品规范|FREQ2.9|/|规范化算法：
",0,1,0,0,0,0,0,0
功能：利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移。,0,1,0,0,0,0,0,0
"功能描述：选择通讯的帆板LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）帆板共有四个LTU，各有两个互为备份的LTU，通过每个LTU均可获得对应的帆板转角和零位信息；每个控制周期根据BAPTALTUSeltFlag确定进行通讯的帆板LTU，发送取数指令。
（2）向帆板LTU发完取数命令后，获得LTU返回数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式。在控制周期任务后根据帆板控制算法算出需要发送的帆板控制指令。
（3）帆板LTU数据采集过程中的故障处理见任务书中规定。",0,0,0,0,0,1,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。
-Y帆板数据的采集与处理|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,1,0,0
"功能描述：根据天线安装定义和地面站坐标，实时计算天线和地面站的夹角。
",0,1,0,0,0,0,0,0
"功能描述：根据指令完成数传天线的指向控制。
输入：数传天线j (j=1,2)，预置指令，跟踪开始指令，跟踪结束指令，地面站i在惯性系指向，被数传天线j(j=1,2)跟踪的地面站i指向卫星矢量，卫星指向被数传天线j(j=1,2)跟踪的地面站i的矢量在本体系的表示，数传天线收到的预置角度
输出：数传天线1和2的指令转角",0,1,0,0,0,0,0,0
"功能描述：发送事件数据给OBDH保存
处理：将事件数据打包后放到事件数据内存地址空间中。",0,0,0,0,0,0,0,1
功能描述：利用数字太阳信息，进行太阳捕获，对太阳定向；,0,1,0,0,0,0,0,0
"功能描述：发送应急控制器重要数据。
处理：将应急控制器重要数据按照协议打包发送至发送应急控制器重要数据地址中。",0,0,0,0,0,0,0,1
功能描述：根据指令完成数传天线的指向控制。,0,1,0,0,0,0,0,0
"功能描述：进行I/O板SpaceWire接口读入和输入数据的处理；由于不同敏感器输入的姿态角度信息的格式和量化单位都不相同，需要将它们进行格式转换。输入信息格式转换后的单位规定为：地球敏感器、太阳敏感器、陀螺积分的角度单位为弧度（rad），动量轮转速单位为（rpm） 
处理：
(1)  判断IO当班状态；
(2)  697控制双口RAM；
(3) 根据当班状态，选择SPACEWIRE相应通道，主份IO当班，从通道2读取双口RAM中的数据；备份IO当班，从通道3读取双口RAM中的数据；
(4) 对读取的双口RAM中的数据进行解包
(5) 输入数据处理；（包括：太敏、地敏、三浮、光纤、星敏、时间、ADU控制信息、IO状态信息等）。
接口输入功能
功能描述：进行接口数据的读取 
处理：输入功能具体见PM板与IO板接口。(1) 从双口RAM中读取I/O发送的数据；(2) 根据协议对接收的数据进行解包；
输入数据处理功能分解
接口输入后，根据通讯协议和数据格式进行数据处理，下表示输入数据处理的功能分解：
表5.2-4 输入数据处理功能分解1
序号|编号|功能说明|任务书中的章节号|功能描述
|FREQ10.1|太敏数据处理地敏数据处理|6.1.1|太阳敏感器数据进行解码，读入的偏移二进制码转换为控制计算用的浮点数格式；
|FREQ10.2|地敏数据处理|6.1.2|将从接口读入的ES数据转化为弧度值
|FREQ10.3|甚高三浮陀螺数据处理|6.1.3|将三浮陀螺在一个采样周期内的脉冲数转化为角度增量，并做限幅与剔野处理
|FREQ10.4|光纤陀螺数据处理|6.1.4|对光纤陀螺数据包进行解码，测量数据由定点数转换为控制计算用的浮点数格式；
|FREQ10.7.2|星敏曝光时刻计算|6.1.5|星敏曝光时刻计算

表5.2-5 输入数据处理功能分解2
序号|需求ID号|功能点说明|用户需求中章节号|功能描述
|FREQ10.3.1|三浮陀螺数据剔野|11.1.1|三浮陀螺数据剔野
|FREQ10.4.1|光纤陀螺数据剔野|11.1.1|光纤陀螺数据剔野
|FREQ10.5|陀螺的应用选择|11.1.1|控制分系统配置了9个陀螺，根据陀螺健康字和电源状态字确定陀螺状态字，计算分配矩阵。也可通过陀螺组合遥控指令处理，设置陀螺状态字，进而计算出分配矩阵。故障后通过地面遥控进行陀螺重新组合分配
|FREQ10.6|单独测量时的陀螺数据处理|11.1.1|根据陀螺测量值，得到三轴姿态角速度，用于姿态采用陀螺几分测量时
|FREQ10.7|星敏感器数据处理|11.1.2|对星敏数据进行解包、数据有效性判断、通讯故障判断、星敏数据剔野
|FREQ10.7.1|星敏数据剔野|11.1.2|星敏数据剔野
",0,0,0,0,0,1,0,0
功能描述：根据太阳矢量在帆板2法平面内投影与帆板法线之间的夹角，通过帆板驱动机构2控制帆板2，使帆板2能捕获及跟踪太阳。,0,1,0,0,0,0,0,0
"功能描述：模拟量遥测 
",0,0,0,0,0,1,0,0
"功能描述：正常对地运行模式控制
",0,1,0,0,0,0,0,0
功能描述：通过注入轨道参数，计算轨道外推数据。,0,1,0,0,0,0,0,0
"功能描述：发送星敏陀螺数据
处理：将星敏陀螺数据打包后放到发送星敏陀螺数据存储地址中
AOCC每个控制周期（250ms）组织128个字节星敏陀螺数据，OBDH每500ms取1次星敏陀螺数据（256个字节）。其中前128字节数据对应小星时的星敏陀螺数据，后128字节数据对应大星时的星敏陀螺数据。",0,0,0,0,0,0,1,0
"功能描述：发送和接收OBDH重要数据
调用条件：有发送和接收OBDH重要数据命令字时
输入：OBDH重要数据地址中内容
输出：OBDH重要数据地址中内容。
处理：OBDH重要数据有四块， AOCC不做任何改动保存在RAM中。",0,0,0,0,0,0,0,1
"功能描述：使用星敏感器B、C的测量，修正姿态四元数与姿态角速度。
",0,1,0,0,0,0,0,0
"功能描述：卫星正常运行模式之一，完成在阳照区和非任务区的对日功能，保证星上能源。
处理：
该模式卫星正常在轨工作模式，入轨期间，CMG启动在满足一定的姿态条件后，由地面指令“允许转入对日定向模式”指令，控制星上模式由CMG启动模式转入对日定向模式。之后控制分系统按照地面规划的指令在轨道A、B、C、D四个点进行姿态机动来完成日地、地日、地地之间的姿态转换。辐射标定模式下的姿态固定，由数据指令控制进入标定模式。
在该模式下，控制系统根据数据块指令提供的开始和结束时间，开始、停止对指定天线控制角度进行计算，并0.5秒向天线发送一次控制指令每个控制周期顺序调用用户需求中的逻辑：
调用轨道与星历；
调用CMG数据采集及处理；
调用部件故障检测与信号选取；
调用陀螺的数据处理；
调用四元数陀螺预估；
调用星敏感器数据处理；
调用利用星敏感器的姿态确定；
调用中继天线捕获跟踪控制；
调用对地数传天线捕获跟踪控制；
调用目标姿态确定；
调用控制器输入量计算；
调用喷气卸载条件计算；
调用CMG奇异状态的判断及算法计算；
if(UnLoadMode=0)
{调用CMG的控制；调用磁卸载控制；}
else {调用CMG启动与保持；
if(Flag_equation=0且TimeStopC<=0)调用相平面喷气脉宽；}
调用系统故障诊断；",0,1,0,0,0,0,0,0
"功能描述：轨控段喷气控制计算。
处理：同用户需求的
（1）各轴喷气参数设置如表36所示
表36：轨控段喷气姿态控制各轴喷气参数设置
|滚动|俯仰|偏航
|0.4 mθD04|0.4 mθD04|0.4 mθD04
|1.0 mθD13（注1）|1.0 mθD13（注1）|1.0 mθD13（注1）
|1.0 mθB36|1.0 mθB36|1.0 mθB36
|3.0 mθB33（注1）|3.0 mθB33（注1）|3.0 mθB33（注1）
|0.1|0.14|0.07
|0.2|0.2|0.2
|（注3）|（注3）|（注3）
|0.3|0.3|0.3
|0.43（注2）|0.43（注2）|0.43（注2）
|（注3）|（注3）|（注3）
KJ2(s)|2|2|2
aJS（/s2）|0.137|0.235|0.089

注1：在BZ1 =3、4的条件下
注2：在BZ1 =2的条件下
注3：在BZ1 =4的条件下
（2）进行各轴平面喷气控制规律计算（同用户需求的）
（3）根据姿轨控喷气规律计算结果，发出相应的喷气指令（同用户需求的）",0,0,0,1,0,0,0,0
"功能描述：姿态角、角速度与姿态四元数预估。
",0,1,0,0,0,0,0,0
"需求名称|功能描述
部件数据有效性判断|对部件采样数据的有效性进行判断，并选择引入闭环控制系统的数据
陀螺数据有效性判断|判断定姿用陀螺数据的有效性，选择参与定姿的陀螺
模拟太阳敏感器数据有效性判断|确定ASS21，ASS22，ASS31，ASS32及帆板角度传感器，等的信号选取
红外地球敏感器数据有效性判断|判断红外地球敏感器有效性
星敏感器数据有效性判断|对星敏感器输出数据进行有效性判断，并选取定姿星敏组合
数字太阳敏感器数据有效性判断|对数字太阳敏感器输出数据进行有效性判断
RS422通讯故障诊断|进行RS422通讯故障诊断及处理
光纤陀螺通讯诊断及处理|进行光纤陀螺通讯故障诊断及处理
数字太阳通讯诊断及处理|进行数字太阳通讯故障诊断及处理
太阳模拟量通讯诊断及处理|进行太阳通讯故障诊断及处理
对地数传天线通讯诊断及处理|进行对地数传天线通讯故障诊断及处理
中继天线通讯诊断及处理|进行中继天线通讯故障诊断及处理
1553B内总线通讯故障诊断|进行1553B内总线通讯故障诊断及处理
红外通讯故障诊断|红外通讯故障诊断及处理
甚高陀螺通讯故障诊断|大量程通讯故障诊断及处理
ACU通讯故障诊断|ACU通讯故障诊断及处理
帆板通讯故障诊断|帆板通讯故障诊断及处理
多头星敏通讯故障诊断|多头星敏通讯故障诊断及处理
1553B内总线总线监视及处理要求|CCU作为内1553B总线的BC，在与各RT通讯时需要进行总线状态监视
部件故障诊断与处理|确定各敏感器和执行机构故障诊断及处理
动量轮故障检测|检测工作中的大力矩飞轮的故障
推进喷气异常检测|检测推力器微漏、过量喷气等，必要时作相应的主备份切换和禁止
帆板故障诊断|帆板故障检测及处理
模式1的系统故障诊断|在模式1中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式2的系统故障诊断|在模式2中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式3的系统故障诊断|在模式3中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式5的系统故障诊断|在模式5中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式7的系统故障诊断|在模式7中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式8的系统故障诊断|在模式8中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式9的系统故障诊断|在模式9中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
磁力矩器数模一致性诊断|磁力矩器数模一致性诊断
DSS输出一致性诊断|DSS输出一致性诊断
ASS1输出一致性诊断|ASS1输出一致性诊断
ACU 1553B接收故障诊断及处理|由于卫星的执行机构控制均需通过ACU进行，当ACU接收控制指令内存区异常将导致卫星失去控制能力，因此有必要对ACU接收执行机构控制指令的正确性进行判断。在检测到执行机构控制指令接收校验和异常后CCU需要自主进行处理",0,1,0,0,0,0,0,0
"功能描述：发送AOCC姿态数据（含侧摆角度）
处理： OBDH在相机成像期间每500ms从AOCC接收一次姿态数据（含2字节侧摆角度值），AOCC在OBDH完成接收姿态数据后，将新的姿态数据（含2字节侧摆角度值）写入总线发送缓冲区。其处理过程如下：
STEP1：AOCC应用程序每0.524秒查询一次有无OBDH发送数据请求，如果有则转入第二步，否则退出；
STEP2：根据不同的数据装载模式，确定装载数据，并按照遥测要求进行格式转换；
STEP3：把遥测缓存区的内容放入OBDH定义的内存中。",0,0,0,0,0,0,0,1
