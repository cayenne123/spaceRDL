Requirements Description,初始化,控制计算,控制输出,故障诊断和处理,数据有效性判断,数据采集,遥控,遥测
"功能描述：滚动/俯仰姿态机动目标姿态确定。
",0,1,0,0,0,0,0,0
"功能：利用星敏感器A、B的测量，修正姿态四元数与姿态角速度。
",0,1,0,0,0,0,0,0
"功能描述：利用C头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.12。
STEP1：计算，将下标A换成C；FM3更改：若，则：，FSTD=1；
STEP2：计算。的各项乘以，的各项乘以。将下标A换成C；
STEP3：计算q；
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算。",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|喷气开关逻辑相平面分区，喷气脉冲宽度计算|FREQ31|4.3.1.1|进行单轴相平面分区及控制规律计算
|三轴姿态喷气控制与推力器脉宽分配|FREQ32|4.3.1.3|为三轴姿态喷气控制选择推力器
|轨控发动机与其备份的使用|FREQ33|4.3.1.4|轨控模式时使用轨控发动机及其备份
|动量轮摩擦补偿计算|FREQ34|4.3.2.2|动量轮摩擦力矩的补偿电压计算
|动量轮角动量保持控制|FREQ35|4.3.2.3|计算将动量轮保持至标称角动量所需的电压
|动量轮的启动与保持|FREQ36|4.3.2.4|启动动量轮至标称角动量，并保持
|正常飞行模式动量轮分配电压计算|FREQ37|4.3.2.5|计算正常飞行模式轮控所需电压
|正常模式轮子保护与动量卸载|FREQ38|4.3.3.1|决定采用磁卸载还是喷气卸载方式，调用相应程序
|磁卸载计算|FREQ39|4.3.3.2|计算磁卸载所需的磁矩与磁力矩器工作电压
|结构滤波器计算|FREQ95|4.3.2.6|PID计算控制力矩经过结构滤波器后，改善姿态控制效果
|太阳定向主程序|FREQ40|4.4.3.3|搜索并捕获太阳，完成并保持帆板对太阳定向
|重捕地球与建立正常姿态（1）|FREQ41|4.4.4.1|在完成对日定向后，由地面指令转入重捕地球。在偏航捕获阶段，通过红外和太阳敏感器定姿，消除卫星的偏航角。在完成偏航捕获后，由红外地球敏感器测量信号进行计算得到俯仰角和滚动角，控制滚动、俯仰使其趋向于0
|捕获地球与建立正常姿态（2）|FREQ42|4.4.4.2|当红外敏感器故障时，在太阳定向完成后，利用数字太阳与星敏感器信息，进行全姿态捕获，并建立正常姿态。
|三轴等效角动量偏差|FREQ91|4.3.4.1|根据飞轮实测角动量和标称角动量计算三轴等效角动量偏差
|俯仰通道轮控算法|FREQ92|4.3.4.2|根据俯仰角和俯仰通道角动量偏差信息实现俯仰轴姿态控制
|磁进动、章动阻尼及俯仰轮卸载控制|FREQ93|4.3.4.3|通过磁力矩器，实现滚动-偏航轴的进动控制及章动阻尼，并对俯仰飞轮进行磁卸载
|三轴轮控算法|FREQ94|4.3.4.4|偏置动量轮处于力矩模式，根据红外地球敏感器测量信息计算得到的滚动角和俯仰角实现三轴姿态控制。滚动、俯仰轴采用角动量反馈方式控制，偏航轴采用耦合控制
|帆板捕获及跟踪控制|FREQ102|4.3.5|根据地面指令或自主使帆板跟踪太阳
|干扰补偿控制算法及动量轮分配电压计算|FREQ95|任务书的4.1.15|计算有效载荷干扰补偿控制电压，以及计算动量轮分配电压
|全姿态捕获动量轮控制方式主程序|FREQ40.5|4.4.5|全姿态捕获动量轮控制方式主程序
",0,1,0,0,0,0,0,0
"功能描述：根据陀螺输入预估卫星对地姿态。
",0,0,0,1,0,0,0,0
"功能描述：接收数传天线状态数据
处理： 将接收数传天线状态存储地址中内容解包成数传天线状态的数据格式，根据不同的数传天线状态设置对应数传天线的加断电状态。",0,0,0,0,0,0,1,0
"功能描述：进行I/O板SpaceWire接口读入和输入数据的处理；由于不同敏感器输入的姿态角度信息的格式和量化单位都不相同，需要将它们进行格式转换。输入信息格式转换后的单位规定为：地球敏感器、太阳敏感器、陀螺积分的角度单位为弧度（rad），动量轮转速单位为（rpm） 
处理：
(1)  判断IO当班状态；
(2)  697控制双口RAM；
(3) 根据当班状态，选择SPACEWIRE相应通道，主份IO当班，从通道2读取双口RAM中的数据；备份IO当班，从通道3读取双口RAM中的数据；
(4) 对读取的双口RAM中的数据进行解包
(5) 输入数据处理；（包括：太敏、地敏、三浮、光纤、星敏、时间、ADU控制信息、IO状态信息等）。
接口输入功能
功能描述：进行接口数据的读取 
处理：输入功能具体见PM板与IO板接口。(1) 从双口RAM中读取I/O发送的数据；(2) 根据协议对接收的数据进行解包；
输入数据处理功能分解
接口输入后，根据通讯协议和数据格式进行数据处理，下表示输入数据处理的功能分解：
表5.2-4 输入数据处理功能分解1
序号|编号|功能说明|任务书中的章节号|功能描述
|FREQ10.1|太敏数据处理地敏数据处理|6.1.1|太阳敏感器数据进行解码，读入的偏移二进制码转换为控制计算用的浮点数格式；
|FREQ10.2|地敏数据处理|6.1.2|将从接口读入的ES数据转化为弧度值
|FREQ10.3|甚高三浮陀螺数据处理|6.1.3|将三浮陀螺在一个采样周期内的脉冲数转化为角度增量，并做限幅与剔野处理
|FREQ10.4|光纤陀螺数据处理|6.1.4|对光纤陀螺数据包进行解码，测量数据由定点数转换为控制计算用的浮点数格式；
|FREQ10.7.2|星敏曝光时刻计算|6.1.5|星敏曝光时刻计算

表5.2-5 输入数据处理功能分解2
序号|需求ID号|功能点说明|用户需求中章节号|功能描述
|FREQ10.3.1|三浮陀螺数据剔野|11.1.1|三浮陀螺数据剔野
|FREQ10.4.1|光纤陀螺数据剔野|11.1.1|光纤陀螺数据剔野
|FREQ10.5|陀螺的应用选择|11.1.1|控制分系统配置了9个陀螺，根据陀螺健康字和电源状态字确定陀螺状态字，计算分配矩阵。也可通过陀螺组合遥控指令处理，设置陀螺状态字，进而计算出分配矩阵。故障后通过地面遥控进行陀螺重新组合分配
|FREQ10.6|单独测量时的陀螺数据处理|11.1.1|根据陀螺测量值，得到三轴姿态角速度，用于姿态采用陀螺几分测量时
|FREQ10.7|星敏感器数据处理|11.1.2|对星敏数据进行解包、数据有效性判断、通讯故障判断、星敏数据剔野
|FREQ10.7.1|星敏数据剔野|11.1.2|星敏数据剔野
",0,0,0,0,0,1,0,0
功能描述：检测红外HL、HR 的故障，并选取正确的红外信号。,0,0,0,0,1,0,0,0
"功能描述：与CAN通信获得上行/下行数据。
调用条件：OBC在CAN总线中断中接收/发送数据；
通过CAN总线与星务分系统通信，交换数据，以实现星地联系和对卫星的人工干预。",0,0,0,0,0,0,0,1
功能描述：计算地磁场强度。,0,1,0,0,0,0,0,0
"功能描述：为三轴姿态喷气控制选择推力器；并记录喷气时间和次数等。
",0,0,0,1,0,0,0,0
"功能描述：将陀螺有效输出数据，换算成卫星三轴角度增量。
",0,1,0,0,0,0,0,0
"功能描述：根据GNC控制量对动量轮、星敏防尘机构及推进线路盒进行控制。执行顺序要求：先对DM发送控制指令，后对上升器推进线路盒发送控制指令，最后对着陆器推进线路盒发送控制指令
序号|功能点编号|功能描述|说明
|FREQ3.5.1|动量轮|通过串口向DM发送动量轮的控制电压信号
|FREQ3.5.2|星敏防尘机构|通过串口向DM发送星敏防尘机构开关指令
|FREQ3.5.3|推力器|通过串口向推进线路盒发出姿控推力器控制脉宽，7500N变推力发动机及3000N发动机的控制指令
",0,0,1,0,0,0,0,0
功能描述：把陀螺数据、、输入并变换到星体坐标系中的、、。,0,0,0,0,1,0,0,0
"功能描述：模式4切换方式。
处理：
if() 置WorkMode=5，WorkModeT=6，；//程控指令转对地
if(lipse=1且且AutoPermission=1) 置WorkMode＝5；WorkModeT=6；；；//进入阴影区自主转对地
if() 置WorkMode=5；若，若，；WorkModeT=6；
if() 置WorkMode=5；若，若，WorkModeT=6；
收到星务的“辐射定标”指令，置WorkMode=5，WorkModeT=6，；//辐射定标模式，为注入的辐射定标目标角
if(FailureFlag＝1) 置WorkMode=2；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；",0,1,0,0,0,0,0,0
"功能描述：发送姿态数据包1
",0,0,0,0,0,0,0,1
功能：在不使用陀螺数据时，对姿态角、角速度与姿态四元数预估。,0,1,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|姿态控制算法|FREQ4.0|5.4|选择控制方式，并计算控制输出
|喷气控制|FREQ4.1|5.4.1|为三轴姿态喷气控制选择喷管；并记录喷气时间等
|CMG控制说明|FREQ4.2|5.4.2.1|CMG控制说明
|CMG高速启动|FREQ4.4|5.4.2.2|启动CMG高速
|CMG群角动量释放|FREQ4.5|5.4.2.3|释放CMG群积累的角动量
|姿态控制力矩及CMG框架指令计算|FREQ4.6|5.4.2.4|使用红外、星敏、太阳定姿时，计算CMG的框架角速率指令
|偏置动量的CMG指令计算|FREQ4.7|5.4.2.5|计算在整星角动量偏置下，计算CMG控制时的框架角速率指令
|喷气卸载条件计算|FREQ4.8|5.4.3|喷气卸载进入和退出条件计算
|CMG数据处理|FREQ4.9|5.4.4|CMG数据处理
|磁卸载控制|FREQ4.10|5.4.5|根据轨控需求和姿控推力器使用情况，开推力器进行轨道控制
|轨道控制喷气|FREQ4.3|5.4.6|根据合成角动量及地磁场强度决定并输出磁棒控制电压
|地面站位置计算|FREQ4.11|5.6.1.1|地面站赤经赤纬计算
|数传天线指向控制|FREQ4.14|5.6.1|根据指令完成数传天线的指向控制
|CMG群标称角动量维持算法算法产品规范|FREQ4.15|/|规范化算法：
|直线型相平面喷气姿态控制算法产品规范|FREQ4.16|/|规范化算法：
|SGCMG群框架角速度指令解算算法产品规范|FREQ4.17|/|规范化算法：
|四阶结构滤波器算法产品规范|FREQ4.18|/|规范化算法：
|连续电压式磁卸载算法产品规范|FREQ4.19|/|规范化算法：
|地面目标矢量计算算法产品规范|FREQ4.20|/|规范化算法：
|基于三轴角动量反馈的偏置动量控制方法产品规范|FREQ4.21|/|规范化算法：
|数传天线指向目标角计算|FREQ4.14.2|5.6.1.2|根据指定跟踪数传天线与其被指定跟踪站的方位，计算其跟踪转角
",0,1,0,0,0,0,0,0
"功能描述：使星体−Z 轴对日定向，星体偏航姿态为零，适当时重捕地球。
",0,1,0,0,0,0,0,0
"功能描述：搜索并捕获太阳，完成并保持帆板对太阳定向
",0,1,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的结构滤波器系数
处理：
调整各系数的初装值。",0,0,0,0,0,0,1,0
功能描述：根据注入轨道参数计算太阳轨道、方位与其他参数。,0,1,0,0,0,0,0,0
"功能描述：采集22路数字太阳粗码、监视码和全开码。
处理：
采集方法：连续采集28路（中间有细码信息，处理时略过），采集1路的操作步骤（以DSS1的粗码1为例）：
向选通地址输出偏移地址：0x1200 0000 = 00H；
等待至少100µs,启动A/D转换：0x1200 0020 = 0；
等待至少40µs后；
连续3次读取A/D数据总线上的数据：data1 = 0x1200 0020 (data2，data3类似)；
取data1、data2、data3三个数据的中间值，作为本路模拟量的最终采集结果。",0,0,0,0,0,1,0,0
"功能描述：利用估计的四元数转换姿态角，计算送给星敏感器的四元数。
",0,1,0,0,0,0,0,0
"功能描述：若AOCC与星敏感器通讯不成功，则记录星敏感器故障一次。若连续240次不成功，判断该星敏感器故障。若星敏感器连续1000次数据无效，需重新启动星敏感器。
",0,1,0,0,0,0,0,0
"功能描述：采集帆板归零信号，并处理成需要的数据格式。
处理：帆板归零的信号",0,0,0,0,0,1,0,0
"功能描述：光纤陀螺数据处理
",0,0,0,0,0,1,0,0
"功能描述：决定采用磁卸载还是喷气卸载方式，调用相应程序。
",0,1,0,0,0,0,0,0
"功能描述：上行注入数据接收和处理
处理： 
序号|功能点编号|功能描述|备注
|FREQ4.1.1|姿控数据包1|该数据块采用内存修改实现
|FREQ4.1.2|姿控数据包2|该数据块采用内存修改实现
|FREQ4.1.3|IMU系数包|该数据块采用内存修改实现
|FREQ4.1.4|相平面系数包|该数据块采用内存修改实现
|FREQ4.1.5|姿态数据包|该数据块采用内存修改实现
|FREQ4.1.6|星敏滤波系数包|该数据块采用内存修改实现
|FREQ4.1.7|主减速系数包|""该数据块采用内存修改实现
删除BKFlag启动动力下降标志，该变量移至导航初始数据包""
|FREQ4.1.8|接近下降系数包|该数据块采用内存修改实现
|FREQ4.1.9|垂直下降系数包|该数据块采用内存修改实现
|FREQ4.1.10|轨道数据包|该数据块采用内存修改实现
|FREQ4.1.11|自主定位数据包|该数据块采用内存修改实现
|FREQ4.1.12|天文历书包|该数据块采用内存修改实现
|FREQ4.1.13|起飞参数包|该数据块采用内存修改实现
|FREQ4.1.14|导航修正系数包|该数据块采用内存修改实现
|FREQ4.1.15|软着陆轨道控制系数包|该数据块采用内存修改实现
|FREQ4.1.16|部件加断电命令包|
|FREQ4.1.17|LTU命令包|""CCU与推进线路盒的指令不通过LTU命令包发送。
与驱动和太阳模块的接口取数指令和控制指令都可通过地面注入发起""
|FREQ4.1.18|加电状态字设置包|该数据块采用内存修改实现
|FREQ4.1.19|串口周期通讯指定包|""该数据块采用内存修改实现
ZZ2的D0位与D5位定义互换""
|FREQ4.1.20|星敏感器RTS命令包|
|FREQ4.1.21|PID系数包|该数据块采用内存修改实现
|FREQ4.1.22|调制系数包|该数据块采用内存修改实现
|FREQ4.1.23|动量轮系数包1|该数据块采用内存修改实现
|FREQ4.1.24|动量轮系数包2|该数据块采用内存修改实现
|FREQ4.1.25|陀螺脉冲当量系数包|该数据块采用内存修改实现
|FREQ4.1.26|加计脉冲当量系数包|该数据块采用内存修改实现
|FREQ4.1.27|故障判别因子系数包|
|FREQ4.1.27|垂直上升及备份姿控PID系数包|
|FREQ4.1.28|内存修改包|修改内存字数由58改为57
|FREQ4.1.29|对日定向系数包|该数据块采用内存修改实现
|FREQ4.1.30|轨控命令包|""该数据块采用内存修改实现
删除变轨系数""
|FREQ4.1.31|惯性调姿命令包|该数据块采用内存修改实现
|FREQ4.1.32|程序包|
|FREQ4.1.33|星敏标定数据包|该数据块采用内存修改实现
|FREQ4.1.34|导航初始数据包|""该数据块采用内存修改实现
增加BKFlag启动动力下降标志""
|FREQ4.1.35|导航敏感器系统误差初值包|该数据块采用内存修改实现
|FREQ4.1.36|微波标定数据包|与LTU命令块合并
|FREQ4.1.37|内存下卸包|
|FREQ4.1.38|驱动与太阳模块状态控制包|
|FREQ4.1.39|着陆器推进控制包|
|FREQ4.1.40|上升器推进控制包|
|FREQ4.1.41|IMU数据存储控制包|IMU数据存储控制标志IMU_flag的定义更改

备注中注明“该数据块采用内存修改实现”的命令块，软件编码不实现该数据包的注入功能，数据包中变量需要修改时通过内存修改包实现。软件编码应保证该数据包中变量处于连续的内存区。",0,0,0,0,0,0,1,0
"功能描述：无陀螺时用红外估计滚动、俯仰姿态角及角速度信息。
",0,1,0,0,0,0,0,0
"功能描述：NSMU初始化
处理：
初始化类型|自主切换允许标志|NSMUState
上电|允许|主份，发主开备关
上电|允许|备份，发备开主关
上电|允许|主份，发主开及备关
上电|允许|空闲
",1,0,0,0,0,0,0,0
"功能描述：进行单轴相平面分区及控制规律计算。由决定是否要喷气；喷气的脉冲宽度；确定本时刻的。
",0,1,0,0,0,0,0,0
"功能描述：串口各部件数据采集和处理
处理：
对于有自检需求的LTU部件，在发送自检指令前将自检应答数据初始化为0xFF（微波测距测速敏感器自检数据初始化为0）。发送前应答数据有初始化要求的自检或遥测获取指令类型：包括图像处理单元自检、激光测距敏感器遥测参数获取、激光测速敏感器校时及遥测参数获取、三维成像敏感器自检和三维成像敏感器遥测参数获取等。CCU上电初始化时默认进行部件自检或校时指令通讯。
序号|功能点编号|功能描述|说明
|FREQ3.2.2.10|部件数据采集顺序|异步串口1数据采集顺序为：DM取数；激光IMU取数；光纤IMU取数；星敏1取数；星敏2取数；微波雷达(a)应答机取数。 异步串口2数据采集顺序为：异步串口2数据采集顺序为：自检及校时指令，LRF取数，LVS取数，星敏3取数，微波雷达(b)应答机取数，RVS取数
",0,0,0,0,0,1,0,0
"软件需求名称：帆板控制算法 
需求类别：其他 
软件需求描述：
表格工作项|软件需求标识|软件需求名称|
FREQ12.3-R4.6.1|帆板控制策略|《用户需求》4.6.1|
FREQ12.3-R4.6.2|帆板控制量确定|《用户需求》4.6.2|
FREQ12.3-R4.6.3|帆板控制指令转速计算|《用户需求》4.6.3|
",0,1,0,0,0,0,0,0
"功能描述：把陀螺数据、、输入并变换到星体坐标系中的、、；输入陀螺自检信号GDi（i = 1，…，6）。
处理：
用户需求的的6(1)：陀螺脉冲当量；
用户需求的的6(2)
STEP1:A阵计算；
STEP2:",0,1,0,0,0,0,0,0
"功能描述：接收记录AOCC时间指令
处理：CTU在需要恢复星上时间时，向AOCC发送“记录AOCC时间指令”，AOCC收到指令后立即记录AOCC时间并将时间数据写入发送AOCC时间指定的存储地址空间中。",0,0,0,0,0,0,1,0
"功能描述：利用星敏感器捕获地球分两个阶段。在第一阶段，60秒判断一次星敏感器姿态输出。如果星敏感器A、B、C均有姿态输出，且测量的光轴夹角满足一定条件，则利用星敏感器双矢量定姿确定姿态。若仅有A或仅有B或仅有C有姿态输出，则偏航转过小角度（3度），重复捕获。偏航转过3度后，若星敏感器A或B或C有姿态输出，且满足一定条件，利用星敏感器双矢量定姿。若三个星敏感器均无姿态输出或由输出但仍不满足一定的条件，进行偏航转动（45度）。若偏航转动1周天仍未捕获成功，则滚动转动90度。若全天球捕获成功，则当姿态角和姿态角速度满足一定条件，进入阶段2。在阶段2，利用四元数进行姿态确定（与姿态机动定姿相同）。喷气控制。
",0,1,0,0,0,0,0,0
"功能描述：根据陀螺输入，预估卫星惯性姿态。
",0,1,0,0,0,0,0,0
"功能描述：完成卫星在失去姿态基准情况下的全姿态捕获，对日定向功能。
处理过程：过程如下：
分两个过程：
第一步捕获太阳（BZ1=3且FSA=0）（在0.262秒中断中完成）
STEP1：进行姿态预估（4），得到姿态角和角速度。
STEP2：进行Z轴捕获太阳的处理过程
发左右帆板归零指令
设定三轴捕获的角速度，（见用户需求）
进行速率喷气控制（见用户需求）
如果ZT2 = 2且FWi  C对工作的飞轮成立，则进行飞轮动量保持控制及飞轮启动；如果ZT2  2或FWi < C 对某一工作的飞轮成立，则将六个轮子的控制电压置为0
满足下列两个条件时，设置FSA=5：
ZT13  4（用0-1太阳捕获）且且指定的敏感器见太阳
ZT13 = 4（用数字太阳捕获）且两个数字太阳均在视场内
第二步太阳定向（BZ1=3且FSA不等于0）
STEP1：进行红外数据采集及处理并将磁力矩器的输出电压设置为0。
STEP2：进行Z轴对日定向和陀螺故障检测及选择：
STEP3：根据ZT7的取值，进行相应的帆板控制。
在BZ1=3中，FSA有三中状态分别为0、5、A，这三个状态的转换关系如图12和表41所示：
图 12： FSA的状态转移图
表 40： FSA状态转换的条件
条件|具体说明
条件1|""ZT13  4（用0-1太阳捕获）且且指定的敏感器见太阳
ZT13 = 4（用数字太阳捕获）且两个数字太阳均在视场内""
条件2|""ZT13  4（用0-1太阳捕获）且且Ls = 1且指定的敏感器不见太阳
ZT13 = 4（用数字太阳捕获）且且 ""
条件3|""ZT13  4（用0-1太阳捕获）且且Ls = 1且
ZT13 = 4（用数字太阳捕获）且且且""
条件4|""ZT13  4（用0-1太阳捕获）且且Ls = 1且指定的敏感器不见太阳
ZT13 = 4（用数字太阳捕获）且且 ""
",0,1,0,0,0,0,0,0
"功能描述：根据姿态估值与数字太阳输出，计算量测的一步预测与新息，建立数字太阳输出的可用性标志。
",0,1,0,0,0,0,0,0
"软件需求名称：帆板使用及通信 
需求类别：其他 
软件需求描述：与帆板通信，控制帆板并获得帆板状态数据。
处理：
见通信协议。 
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
帆板初始化|FREQ46|帆板初始化|B|2
帆板数据采集|FREQ47|帆板数据采集|B|3
数据解包与转换|FREQ48|数据解包与转换|B|4
帆板数据有效性判断、处理|FREQ49|帆板数据有效性判断、处理|B|5
帆板控制量输出|FREQ50|帆板控制量输出|B|6
帆板故障重构|FREQ51|帆板故障重构|C|
",0,0,1,0,0,0,0,0
"功能描述：
  通过简化伪速率调制器计算5N推力器喷气脉冲，并输出(功能编号：FReq-3。
处理：根据三轴简化伪速率调制器的输出值计算出12个5N推力器的输出值。重新置定时器0的初值，设置5N推力器的输出，启动定时器0计数。逻辑如下：
根据5.2.5节获取控制力矩Yi：
若Yi–r>h1,  则输出Y＝1，Tri＝1；
  		若Yi–r<-h1, 则输出Y＝-1，Tri＝-1；
  		否则输出Y＝0，Tri＝0；
		r = 0.614*r + 0.0861*Y   // r 上电初始化为0
当 Tri = 1 
	ThrNoNi = ThrNoNi + 1                   		 
当Tri = -1
	ThrNoPi = ThrNoPi + 1                   		
当Y为+1时产生一个64ms的负脉冲，Y为-1时产生一个64ms的正脉冲。
具体喷管的选择参考任务书。
   推力器双分支工作时，若A份中的推力器不健康，则使用B份对应的推力器。
说明： 控制力矩的计算增加 伪速率调制器r的计算，同时修改h1的参数",0,0,1,0,0,0,0,0
功能描述：根据太阳矢量在帆板2法平面内投影与帆板法线之间的夹角，通过帆板驱动机构2控制帆板2，使帆板2能捕获及跟踪太阳。,0,1,0,0,0,0,0,0
"功能描述：搜索地球，直到红外有地球信息。
",0,1,0,0,0,0,0,0
功能描述：根据星敏感器故障标志、星敏感器有效数据判断标志（由星敏感器数据包给出，（包括状态字b27、同步脉冲计数值、数据产生相对时间、姿态四元数信息等）），判断星敏感器数据有效性。,0,1,0,0,0,0,0,0
功能模式：姿态机动的初始化计算。,0,1,0,0,0,0,0,0
"功能描述：在完成对日定向后，。
输入：陀螺数据处理的输出 ，
太阳星历的输出，
数字太阳敏感器输出：, （量纲：弧度）
红外地球敏感器数据有效性标志F_IresValid（由数据有效性判据给出）
数字太阳敏感器数据有效性标志F_Ds1Valid，F_Ds2Valid（由数据有效性判据给出），
红外数据有效性输出 ，
",0,1,0,0,0,0,0,0
"“复位进入模式”中应用软件进行如下初始化工作：
置星时为2100秒；
置“向星务分系统申请重要数据”标志。
在“复位进入模式”中AO进行如下工作：
控制量输出均为0。部件开关设置为“不进行任何操作”。
响应星务分系统遥测轮询、数据遥控指令、数据注入、程序注入并进行相应处理，但不响应星务重要数据的轮询。
在“复位进入模式”中AO不进行控制律计算。",1,0,0,0,0,0,0,0
功能描述：计算定点观测模式下的目标姿态TI C 和帆板理论转角。,0,1,0,0,0,0,0,0
功能描述：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。,0,1,0,0,0,0,0,0
"功能描述：利用磁强计定姿数据进行卫星姿态捕获，恢复正常姿态。
",0,1,0,0,0,0,0,0
"功能描述：利用双矢量姿态输出修正姿态估值、估计陀螺漂移及红外常值误差。
",0,1,0,0,0,0,0,0
"功能：利用星敏感器A的测量，修正姿态四元数与估计角速度。
",0,1,0,0,0,0,0,0
"功能描述：发送遥测数据
处理：
遥测数据分为实时遥测数据和延时遥测数据。
实时遥测数据格式包含5种格式：发射模式、正常模式、变轨模式、全姿态捕获模式、停控模式/应急模式。对于AOCS分系统而言，发射模式和正常模式的处理方式相同。若AOCS分系统出现模式转换则需通过方式代码的服务申请，请求OBDH变化遥测格式。
OBDH在收到地面指令或者在接收到AOCS的服务请求后，在125ms的时间内给AOCC发送对应的‘同步’方式代码。若AOCC在服务请求后大于0.25s的时间内未收到对应的‘同步’方式代码，则再次申请改变模式，若同一次申请的申请次数大于40次，则停止本次的申请。遥测数据格式内容具体见遥测文件。",0,0,0,0,1,0,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。
-Y帆板数据的采集与处理|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,1,0,0
"功能描述：使星体-Z轴对日定向后，使用星敏感器重捕地球。
",0,1,0,0,0,0,0,0
"功能描述：根据需求，计算去往巡天模式机动过程中所需的目标姿态
",0,1,0,0,0,0,0,0
"功能描述：利用估计的四元数转换姿态角，送给星敏感器的四元数。

",0,1,0,0,0,0,0,0
"功能描述：与地检通信，获得地检数据。
处理：
功能编号|功能|引用文档
FREQ77|初始化|任务书
FREQ78|地检使用要求|任务书
FREQ79|通信(串口)|任务书
FREQ80|通信故障处理|任务书
FREQ81|数据解包与转换|任务书
FREQ82|地检数据有效性判断、处理|任务书
FREQ83|地检模拟量采集、处理|预留
FREQ84|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
"功能描述：减小卫星的俯仰角。
输入：陀螺数据输出 ，
红外数据有效性标志F_IresValid（由有效性判据给出）、见太阳状态、故障标志IRES_FLAG
红外弦宽
红外数据处理（全姿态捕获）的输出，",0,1,0,0,0,0,0,0
"功能描述：在完成对日定向后，由地面指令转入地球捕获。通过红外和数字太阳敏感器定姿，消除卫星的偏航角。
输入：陀螺数据处理的输出 ，
数字太阳敏感器数据有效性标志F_Ds1Valid，F_Ds2Valid（由数据有效性判据给出），数字太阳敏感器输出： （量纲：弧度）
红外地球敏感器数据有效性标志F_IresValid（由数据有效性判据给出）
上周期姿态角估值，
太阳星历的输出，
",0,1,0,0,0,0,0,0
功能描述：接收遥控轨道参数注入块,0,0,0,0,0,0,1,0
"时间服务用于CCU的校时，卫星时间服务为1s时间同步周期进行一次，BC采用子地址29广播消息发送至各RT。同时实现了OBDH校时时刻和GPS秒脉冲时刻的发送。CCU的处理中，整个的时间为OBDH校时时刻（包括秒部和微妙部），其中的秒部为GPS秒脉冲时刻。因此包含的功能点为两个：
序号|功能描述|功能编号|
|接收OBDH校时时刻|FREQ7.1.1|设置OBDH校时标志TimeFlg.RcvOBDH
|接收GPS秒脉冲时刻|FREQ7.1.2|设置GPS校时标志
",0,0,0,0,0,0,1,0
功能描述：太阳全姿态捕获模式初始化,0,1,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的星敏姿态修正系数,0,0,0,0,0,0,1,0
"序|需求名称|编号|功能及处理描述
|红外1数据的采集与处理|FREQ3.1|选择通讯的红外1LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
|红外2数据的采集与处理|FREQ3.2|选择通讯的红外2LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
",0,0,0,0,0,1,0,0
"功能描述：轨控段喷气控制计算。
处理：同用户需求的
（1）各轴喷气参数设置如表36所示
表36：轨控段喷气姿态控制各轴喷气参数设置
|滚动|俯仰|偏航
|0.4 mθD04|0.4 mθD04|0.4 mθD04
|1.0 mθD13（注1）|1.0 mθD13（注1）|1.0 mθD13（注1）
|1.0 mθB36|1.0 mθB36|1.0 mθB36
|3.0 mθB33（注1）|3.0 mθB33（注1）|3.0 mθB33（注1）
|0.1|0.14|0.07
|0.2|0.2|0.2
|（注3）|（注3）|（注3）
|0.3|0.3|0.3
|0.43（注2）|0.43（注2）|0.43（注2）
|（注3）|（注3）|（注3）
KJ2(s)|2|2|2
aJS（/s2）|0.137|0.235|0.089

注1：在BZ1 =3、4的条件下
注2：在BZ1 =2的条件下
注3：在BZ1 =4的条件下
（2）进行各轴平面喷气控制规律计算（同用户需求的）
（3）根据姿轨控喷气规律计算结果，发出相应的喷气指令（同用户需求的）",0,0,0,1,0,0,0,0
"需求名称|功能及处理描述
对地数传天线1数据的采集与处理|对地数传天线1 LTU控制指令
对地数传天线1的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
对地数传天线2数据的采集与处理|对地数传天线2
LTU控制指令|对地数传天线2的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
中继天线数据的采集与处理|中继天线LTU控制指令|中继天线的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向中继天线 LTU发控制指令，获得中继天线数据并处理成对应的角度等信息。",0,0,0,0,0,1,0,0
"功能：利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移。
输入：星敏感器A、B修正新息，四元数、陀螺常漂
输出：修正四元数、陀螺常漂
",0,1,0,0,0,0,0,0
"根据不同的任务要求划分了各个模式，模式控制作为一个功能的集合体反映了任务的执行情况，是确认测试和系统实验验证的要的功能。
序|需求名称|编号|输入章节号|功能描述
|入轨段控制模式控制|FREQ5.2.1|4.1|入轨段控制模式控制调用流程
|正常对地运行模式控制|FREQ5.2.2|4.2|正常对地运行模式控制调用流程
|点对点机动模式控制|FREQ5.2.3|4.3|点对点机动模式控制调用流程
|姿态/角速度预置模式控制|FREQ5.2.4|4.4|姿态/角速度预置模式控制调用流程
|偏置飞行模式控制|FREQ5.2.5|4.5|偏置飞行模式控制调用流程
|匀地速跟踪模式控制|FREQ5.2.6|4.6|匀地速跟踪模式控制调用流程
|角速度跟踪模式控制|FREQ5.2.7|4.7|角速度跟踪模式控制调用流程
|轨控模式控制|FREQ5.2.8|4.9|轨控模式控制调用流程
|全姿态捕获模式控制|FREQ5.2.9|4.10|全姿态捕获模式控制调用流程
|无控模式控制|FREQ5.2.10|4.11|无控模式控制调用流程
|测试与标定模式控制|FREQ5.2.11|4.8|测试与标定模式控制调用流程

模式初始化的功能点如下：
序|需求名称|编号|输入章节号|功能描述
|入轨段控制模式初始化|FREQ5.3.1|4.1|入轨段控制模式初始化设置
|正常对地运行模式初始化|FREQ5.3.2|4.2|正常对地运行模式初始化设置
|点对点机动模式初始化|FREQ5.3.3|4.3|点对点机动模式初始化设置
|姿态/角速度预置模式初始化|FREQ5.3.4|4.4|姿态/角速度预置模式初始化设置
|偏置飞行模式初始化|FREQ5.3.5|4.5|偏置飞行模式初始化设置
|匀地速跟踪模式初始化|FREQ5.3.6|4.6|匀地速跟踪模式初始化设置
|角速度跟踪模式初始化|FREQ5.3.7|4.7|角速度跟踪模式初始化设置
|轨控模式初始化|FREQ5.3.8|4.9|轨控模式初始化设置
|全姿态捕获模式初始化|FREQ5.3.9|4.10|全姿态捕获模式初始化设置
|无控模式初始化|FREQ5.3.10|4.11|无控模式初始化设置
|测试与标定模式初始化|FREQ5.3.11|4.8|测试与标定模式初始化设置

主动段和无控工作模式下并不进行姿态确定和控制的计算，其它各个模式控制中调用卫星轨道和星历计算、姿态确定、姿态和轨道控制及部件有效性和故障诊断以及模式初始化的内容具体见用户需求的4。",0,1,0,0,0,0,0,0
"功能描述：选择通讯的红外LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）红外共有两个LTU（正俯仰红外LTU和负俯仰红外LTU），AOCC每个控制周期向注入文件中的ZT5和IresLTUSeltFlag的最大组合中指定的红外LTU发送取数指令
（2）向选择的红外LTU发送完取数指令，获得红外LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,1,0,0
"软件需求名称：上电和复位初始化 
需求类别：其他 
软件需求描述：系统软件上电复位后，调用应用软件AppInit函数，并根据初始化内容，启动任务
处理：
OBC上电/复位后，由系统软件引导应用软件运行。首先进行初始化，包括系统软件初始化和系统软件调用应用软件提供的初始化函数（AppInit）。启动任务并开始进行任务调度管理。 ",1,0,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的系统安全模式姿态控制器系数
处理：
调整安全模式偏航角偏差限幅的初装值。",0,0,0,0,0,0,1,0
"功能描述：
将从1553B总线上接收到ISUA、ISUC遥测数据，以及的常规遥测数据根据遥测打包协议进行打包（FReq-8）。
处理： 1553B总线通过子地址11接收到ISUA、ISUC常规遥测数据，ISUC闭环控制反馈数据，当轮询子地址10到来时，将计算的常规遥测数据同子地址11接收到的ISUA、ISUC常规遥测数据、部分ISUC闭环控制反馈数据，一并打包并发送到子地址10。遥测内容的相关变化见遥测文件以及1553B通讯协议。
遥测打包时模式字与方式字占用1个字节，模式字占用高4位，方式字占用低4位。对于未明确定义的遥测当量，使用CMU的当量，表示范围根据占用的字节数决定。",0,0,0,0,0,0,0,1
"功能描述：处理地面遥控注入的用于替换EEPROM的代码
处理：
-  解包EEPROM代码注入包，得到帧号、源地址（SRAM）、目的地址（EEPROM）、注入内容长度；
- 以源地址为起始地址，将注入内容放入该SRAM区域
说明：星务分系统向GNCC送数采用256字节(有效使用249字节)帧格式。数据格式见《卫星GNC分系统GN与星务分系统通讯协议》",0,0,0,0,0,0,1,0
功能描述：接收数据指令注入块的自主诊断允许类指令,0,0,0,0,0,0,1,0
"功能描述：根据姿态角计算方向余弦阵
",0,0,0,1,0,0,0,0
"功能描述：根据指令完成数传天线的指向控制。
输入：数传天线j (j=1,2)，预置指令，跟踪开始指令，跟踪结束指令，地面站i在惯性系指向，被数传天线j(j=1,2)跟踪的地面站i指向卫星矢量，卫星指向被数传天线j(j=1,2)跟踪的地面站i的矢量在本体系的表示，数传天线收到的预置角度
输出：数传天线1和2的指令转角",0,1,0,0,0,0,0,0
"功能描述：
循环太阳搜索时对部件的切换（功能编号：FReq-16）。
处理：
(1)第一次滚动搜索不成功时，若另一份SPE健康，切换另一份SPE；
(2)第二次滚动搜索不成功时，若另一份MPSDP健康，切换另一份MPSDP；否则切换另一份SPE，此条件下第三次搜索不成功直接进入（4）;  
(3)第三次滚动搜索不成功时，切换另一份SPE;
(4)第四次滚动搜索不成功时，转停控;
部件切换的间隔周期，在保证不冲突的情况下，软件可自主确定。",0,1,0,0,0,0,0,0
功能描述：发送姿态控制数据包1,0,0,0,0,0,0,0,1
"功能描述：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移。
",0,1,0,0,0,0,0,0
"功能描述：接收数据指令注入块的系统状态设置类指令	
处理：
序号13允许CMG高速自主启动和序号34禁止CMG高速自主启动初值更改，改为默认允许。序号29允许自主喷气保护和序号34禁止自主喷气保护初值更改，改为默认允许。",0,0,0,0,0,0,1,0
"功能描述：发送和接收时间差值
调用条件：有发送和接收时间差值命令字时
周期：CTU复位时
输入：星时，计数值
输出：时间差值
处理：具体处理要求见与外总线通讯协议。",0,0,0,0,0,0,0,1
"功能描述：根据+Y帆板角误差控制帆板跟踪太阳。
",0,0,0,1,0,0,0,0
"功能描述：利用红外数据自主诊断红外部件状态
",0,1,0,0,0,0,0,0
"功能描述：卫星绕滚动轴转动，直到满足姿态角条件，进入下一阶段俯仰捕获。姿态确定由红外和陀螺。姿态控制是喷气控制
",0,1,0,0,0,0,0,0
"功能描述：根据框架角偏差计算指令转速。
处理：主要处理过程如下：
当接收到由OBDH发送来的中继快扫到位指令,进入天线预置状态，令FAFP=1，预置的目标角为命令块中的-10对应时刻通过轨道计算得到的天线框架角。控制中继天线转动快扫到达目标位置。当时间大于-10后，退出预置状态令FAFP=0。
当接收到由OBDH发送来的中继复位指令,进入天线复位状态，令FARP=1。根据命令块中数据标志来确定天线要复位的位置。如果标志为55H，天线复位到命令块中指定的角度位置；如果标志为FFH，则天线复位到零位。
当地面上行注入ZT40（1）=1时，天线进入螺旋扫描状态。按照特定的步长控制天线转动，当螺旋扫描持续的时间超过注入的天线捕获扫描时间时，将ZT40(1) 置0退出螺旋扫描状态。
当接收到由OBDH发送来的中继程序跟踪停止指令，停止向中继捕获跟踪控制单元发送控制信息，并设定标志传到遥测。其余情况下天线处于程序跟踪状态。
卫星增加了侧摆中继时传的工作模式，快摆时工作时序见任务书.5。",0,1,0,0,0,0,0,0
"功能描述：与地检通信，获得地检数据。
处理：
功能编号|功能|引用文档
FREQ82|初始化|任务书
FREQ83|地检使用要求|任务书
FREQ84|通信(串口)|任务书
FREQ85|通信故障处理|任务书
FREQ86|数据解包与转换|任务书
FREQ87|地检数据有效性判断、处理|任务书
FREQ88|地检模拟量采集、处理|预留
FREQ89|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。CCU应用软件取数消息与同步消息的发送时间间隔不小于2ms。
-Y帆板数据的采集与处理|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,1,0,0
"功能描述：根据陀螺输入，予估卫星对地姿态。

处理：
STEP1:计算；
STEP2:计算，区分工作模式BZ1=1（三轴稳定正常轨道运行姿态）或8（侧摆机动）或9（侧摆角保持），BZ1≠1和8和9两种情况；
STEP3:计算；
STEP4:若BZ1=1（三轴稳定正常轨道运行姿态）或2（偏航机动并稳定运行）或6（轨控期间），；
STEP5:若BZ1=1（三轴稳定正常轨道运行姿态），则；
STEP6:若BZ1=8（侧摆机动），则，；
STEP7:若BZ1=9（侧摆角保持），则，；
STEP8:若BZ1=B（入轨段控制模式）且(消初偏结束时刻)。",0,1,0,0,0,0,0,0
"功能描述：利用星敏感器B、D的测量，修正姿态四元数与估计陀螺漂移。
",0,1,0,0,0,0,0,0
"功能描述：与发动机通信，输出本周期喷气脉宽。
处理：
功能编号|功能|引用文档|备注
FREQ52|UPS初始化|任务书|B
FREQ53|化学推进数据采集|任务书|B
FREQ54|推力器脉冲输出|任务书|B
FREQ55|推力器健康字设置|任务书|B
FREQ56|部件操作（程控490N点火，故障重构）|任务书|B
",0,0,1,0,0,0,0,0
"功能描述：完成整星绕滚动轴的姿态侧摆机动
处理过程：过程如下：
STEP1：当ZT F（不用红外+单个斜装陀螺定姿），进行姿态预估，得到姿态角和角速度。
STEP2：进行运行段姿态确定，具体过程如下：
进行红外数据采集及处理和q及s姿态予估器
当星敏感器修正时间大于等于4500秒时，将星敏感器测量回路求得的姿态角和角速度，赋值为姿态角和角速度，
根据轮子的工作状况，计算滚动轴最大控制力矩
计算滚动轴角加速度、加速时间
设置侧摆标志FRTS的值，0为通过轮控进行侧摆，1为通过喷气进行侧摆，设置的条件如下表所示：
条件|FRTS的取值
ZT35(2) = 1，|1
其余情况|0

计算滚动轴期望轨迹和
得到输入控制律的姿态角和角速度，
STEP3：进行运行段控制，具体过程如下：
根据ZT2的值进行飞轮控制
当ZT8  3（姿控发动机可用）且ZT9  3（轨控发动机可用）且FRTS = 1（用喷气进行侧摆）且ZT（不用红外+单个斜装陀螺定姿）时，进行轨控段喷气姿态控制
进行陀螺故障检测及选择
当ZT40(4) = 1时，进行数传天线捕获跟踪控制
STEP4：根据ZT7的取值，进行相应的帆板控制。
ZT7的值|处理
 8|进行运行段帆板控制
ZT7 = 0|发两翼帆板归零指令
ZT7 = 3|发左翼为90度，右翼为 -90度指令
ZT7 = 5|发左右皆为90度指令
ZT7 = 7|发左右皆为180度指令
ZT7 = 9|发指令
ZT7 = A|发指令
ZT7 = B|发指令
",0,1,0,0,0,0,0,0
功能描述：入轨段初始化,0,1,0,0,0,0,0,0
"功能描述：计算CMG的框架角速度,。",0,1,0,0,0,0,0,0
"功能描述：计算巡天模式下的目标姿态
",0,1,0,0,0,0,0,0
"功能描述：模式2切换方式。
处理：
FailureFlag=4且AutoInStopNum<2时，置WorkMode=8，SpeedControlTime＝0，AutoInStopNum=AutoInStopNum+1；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；",0,0,0,1,0,0,0,0
功能描述：若AOCC与星敏感器通讯不成功，则记录星敏感器故障一次。若连续240次不成功，判断该星敏感器故障。若星敏感器连续2000次故障，需重新启动星敏感器。,0,1,0,0,0,0,0,0
"功能描述：根据飞轮角动量及地磁场强度决定并输出磁棒控制电压。
",0,1,0,0,0,0,0,0
"功能描述：与动量轮通信，输出本周期电压。采集动量轮模拟量信息。
处理：
功能编号|功能|引用文档
FREQ102|初始化(加电)|任务书
FREQ103|动量轮使用要求(方向等)|任务书
FREQ104|通信(DA输出、脉冲输入)|任务书
FREQ105|通信故障处理|预留
FREQ106|数据解包与转换|任务书
FREQ107|处理动量轮数据有效性处理|任务书
FREQ108|动量轮模拟量采集、故障|任务书
FREQ109|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
功能描述：确定各部件的工作状态，并开关相关部件电源。,0,0,0,0,0,1,0,0
"功能描述：仅利用星敏感器A的测量，修正姿态四元数与姿态角速度移。
",0,1,0,0,0,0,0,0
"功能描述：利用加速度计数据诊断加速度计部件状态
",0,1,0,0,0,0,0,0
"功能描述：利用估计的四元数转换姿态角，送给星敏感器的四元数。
",0,1,0,0,0,0,0,0
当需要请求服务时，将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。,0,0,0,0,1,0,0,0
"功能描述：修正光行差量的计算。
处理：同用户需求的4.13。
STEP1：计算",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|红外1数据的采集与处理|FREQ1.3.1|""红外1
1553B取数指""|红外1的弦宽和前基|在通讯允许的条件下（红外1的当班标志为1），每1秒向红外1RT发取数指令，获得红外1数据并处理成对应的弦宽和前基。
",0,0,0,0,0,1,0,0
"功能描述：选择通讯的红外LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）AOCC每两个0.524秒根据加断电控制字IR_PWR（设置原则见任务书的附录D），向加电的红外LTU发送取数命令（向红外LTU1发送13H，向红外LTU2发送23H），获得每个红外LTU返回的5个字节数据。
（2）将数据根据LTU通讯协议转换成（红外1的前沿到基准）、（红外2的前沿到基准），（红外1的前沿到后沿）、（红外2的前沿到后沿）。
（3）AOCC每两个0.524秒同时向两个红外LTU发自检命令，根据返回的自检信息确定红外1、2有无信号标志HL（1为有效，0为无效）和HR（1为有效，0为无效）。
（4）每31个0.524秒控制周期（约16秒），根据ZT31向红外LTU1和LTU2发送切换方案命令
ZT31(1)＝1，红外H1用主份；ZT31(1)＝0，红外H1用备份
ZT31(2)＝1，红外H2用主份；ZT31(2)＝0，红外H2用备份
ZT31(3)＝1，ZT31(4)＝0，ZT5＝1，红外H1加电
ZT31(3)＝0，ZT31(4)＝1，ZT5＝2，红外H2加电
其余情况下，红外H1、H2都加电
红外LTU数据采集过程中的故障处理见本文的5.2.9.3。",0,0,0,0,0,1,0,0
"    各个模式切换的功能点列表如下：
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ5.1.0|4|主动段模式切换条件判断及转出设置
|初始速率阻尼模式切换|FREQ5.1.1|4.1|初始速率阻尼模式切换条件判断及转出设置
|正常对日巡航模式切换|FREQ5.1.2|4.2|正常对日巡航模式切换条件判断及转出设置
|点对点机动模式切换|FREQ5.1.3|4.3|点对点机动模式切换条件判断及转出设置
|姿态/角速度预置模式切换|FREQ5.1.4|4.4|姿态/角速度预置模式切换条件判断及转出设置
|对地定向模式切换|FREQ5.1.5|4.5|对地定向模式切换条件判断及转出设置
|匀地速跟踪模式切换|FREQ5.1.6|4.6|匀地速跟踪模式切换条件判断及转出设置
|轨控模式切换|FREQ5.1.9|4.9|轨控模式切换条件判断及转出设置
|太阳捕获模式切换|FREQ5.1.10|4.10|太阳捕获模式切换条件判断及转出设置
|无控模式切换|FREQ5.1.11|4.11|无控模式切换条件判断及转出设置
|凝视姿态跟踪模式切换|FREQ5.1.12|4.12|凝视姿态跟踪模式切换条件判断及转出设置

切换条件具体见用户需求4。CCU切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,1,0,0,0,0,0,0
"功能描述：根据红外信息，作姿态滤波修正。
处理：同用户需求的",0,0,0,0,1,0,0,0
"功能描述：校正星上星时。
输入：星上星时变量、均匀校时间隔、均匀校时时间、全量校时时间、增量校时时间、星务校时时间、相关数据指令。
输出：校正后的星上当前星时变量。
",0,0,0,0,0,1,0,0
"功能描述：根据红外输出，估计卫星姿态与陀螺漂移。
",0,1,0,0,0,0,0,0
功能描述：释放CMG群积累的角动量。,0,1,0,0,0,0,0,0
"功能描述：处理星务返回的重要数据
处理：解包并更新重要数据",0,0,0,0,0,0,1,0
"功能描述：对帆板驱动装置1和帆板驱动装置2进行独立控制和诊断，一个帆板驱动装置失效不影响对另一个帆板驱动装置的控制与诊断。
",0,1,0,0,0,0,0,0
功能描述：若本周期角动量与上一周期角动量之差（绝对值）大于0.15Nms，则用上一周期角动量作为本周期输入，角动量变化取0。若连续大于三次或本周期与上一周期角动量之差（绝对值）小于0.15Nms，则以本周期角动量为真值，角动量变化,0,1,0,0,0,0,0,0
功能描述：计算磁卸载所需的磁矩与磁力矩器工作脉宽。,0,1,0,0,0,0,0,0
"功能描述：根据陀螺输出，预估卫星姿态和姿态角速度。
",0,0,0,1,0,0,0,0
"功能描述：发送高精度姿态数据
处理：每个控制周期查询一次是否需要进行数据打包，若需要，则进行数据打包。",0,0,0,0,0,0,0,1
"功能描述：采集星上时钟的计数值，计算星时及作相应的处理
处理： 
（1）CPU星时时钟的星时采集计算与校时
CPU外部星时时钟星时计算的输入为上一个周期对应的绝对星时t，和上个周期中控制周期读取的计数值为TOLD。在每个控制周期中处理过程如下：
STEP1：选取控制周期星时锁存通道，读取锁存的计算值，记为TNEW；
STEP2：计算TNEW减去TOLD的差值，记为DELTT（当量为1微秒）；
STEP3：本周期的绝对星时t=t+DELTT/1000000；
STEP4：保存本周期的计数值，即TOLD=TNEW。
CPU星时时钟星时校时是通过OBDH校时，OBDH校时分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时；",0,0,0,0,0,1,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：动量轮启动的程控指令
      实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：， ，",0,0,0,1,0,0,0,0
"功能描述：使用红外、星敏、太阳定姿时，计算CMG的框架角速率指令。
处理：
软件设计时应注意保护Vm，保证此节使用的Vm未在周期性清0处理中被清除。",0,1,0,0,0,0,0,0
"功能描述：陀螺数据处理。
处理：
每个惯性姿态敏感器组件中，单个陀螺输出包括1个加速脉冲信号和1个减速脉冲信号。每个信号由1个19位计数器完成对信号的计数。计数器采用加计数方式，当脉冲数超过524287时，计数器清零，重新计数，应用软件判断计数器溢出，使用说明见表3-7。数据为无符号数据。
本周期陀螺n（n＝1～6）加（减）速脉冲计数值(个)=（本周期加（减）脉冲数 － 上周期加（减）脉冲数）；
陀螺n角度增量( º)＝ （陀螺n加速脉冲计数值 – 陀螺n减速脉冲计数值）×陀螺脉冲当量，陀螺脉冲当量为：5×10-5 度。
FREQ65|陀螺数据采集|
FREQ66|陀螺加电状态判断|
",0,0,0,0,0,1,0,0
"功能描述：根据姿态估值与数字太阳输出，计算量测的一步预测与新息，建立数字太阳输出的可用性标志。
输入： 5.2.14.3输出的
       姿态估值 
       数字太阳数据有效性标志F_Ds1Valid， F_Ds2Valid（由有效性判据给出）
      	  数字太阳敏感器输出：, (量纲：弧度)",0,1,0,0,0,0,0,0
"功能描述：与CAN通讯获得上行/下行数据。
调用条件：AOCC被动接收/发送数据；
处理：通过CAN总线与星务分系统通讯，交换数据，以实现星地联系和对卫星的人工干预。主要完成下列功能：
AOCC向星务分系统发送数据（中断接收星务分系统命令，依据命令发送各类遥测参数）；
发送快帧遥测；
发送慢帧遥测；
将AOCC为星务保存的重要数据发送给星务分系统；
发送星敏感器和姿态辅助数据；
有内存下卸要求时，发送AOCC指定内存内容；
AOCC接收星务分系统数据（中断方式）包括接收固定地址参数注入；接收可变地址参数注入；接收轨道参数数据；接收程序注入；接收数据指令；接收重要数据返回；接收整星对时广播数据；接收GPS高精度秒脉冲对时广播；接收GPS导航数据，GPS定位广播数据引入控制使用之前，软件需对广播数据中的W28表示的定位状态进行判断，即D6～D4：为101、011、110之一时，引入系统，否则为无效，控制系统不使用
如果应用软件3s收不到星务分系统信息或连续5周期挂起，对CAN总线控制器重新初始化。",0,0,0,0,0,0,0,1
"功能描述：轨道与星历计算。
",0,1,0,0,0,0,0,0
"功能描述：星上自主检测推进系统故障。
",0,1,0,0,0,0,0,0
功能描述：使用红外、星敏、太阳定姿时，计算正常飞行轮控所需电压。,0,1,0,0,0,0,0,0
功能描述：利用星敏感器数据进行卫星姿态捕获。,0,1,0,0,0,0,0,0
"功能描述：与星敏感器通信，获得星敏感器数据。
处理：
见星敏通信协议、任务书。
功能编号|功能|引用文档
FREQ57|初始化|星敏协议
FREQ58|星敏使用要求|任务书
FREQ59|通信|星敏协议
FREQ60|通信故障处理|任务书
FREQ61|数据解包与转换|星敏协议
FREQ62|星敏数据有效性判断、处理|任务书
FREQ63|星敏模拟量采集、处理|任务书
FREQ64|部件在轨转发（在轨修改）|任务书

3）GPS高精度校时与星敏感器数据的使用
功能描述：根据GPS秒脉冲，秒脉冲广播，进行GPS高精度校时和星敏感器时标处理。",0,0,0,0,0,1,0,0
"控制计算机实时遥测包括下表的功能点。
序号|功能描述|功能编号
|发送姿态数据包1|FRE65
|发送姿态数据包3|FRE65.1
|星敏感器姿态数据包|FRE65.2
|星敏感器自检数据包|FRE65.3
|姿态控制数据包|FRE65.4
|轨道数据包|FRE65.5
|LTU自检数据包|FRE65.6
|AOCC及状态数据包|FRE65.7
|发送星敏修正数据包|FRE65.8
|发送对日定向数据包|FRE65.9
|数传天线地面夹角数据|FRE65.10

具体的内容及遥测模式切换的原则详见遥测文件。",0,0,0,0,0,0,0,1
"功能：利用星敏感器B、C的测量，修正姿态四元数与估计陀螺漂移。
",0,1,0,0,0,0,0,0
"功能描述：发送矢量字
处理：将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。应用软件中对应各个请求编码的条件如下表所示（十六进制）：
服务编码|发送的条件
58H|上电/复位时发送，一次成功则不再发送第二次，如果一次不成功，则再发第二次；同样若第二次也不成功，则再发最后一次。
38H|每隔1分钟或模式改变时发送
96H|待定
69H|进入全姿态捕获模式后发送，收到确认字后停止发送
8CH|进入无控模式后发送，收到确认字后停止发送
C8H|BAPTA异常跟踪后发送，收到确认字后停止发送
",0,0,0,0,0,0,0,1
"功能描述：利用B头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.11
STEP1：计算，将下标A换成B；FM3更改：若，则：，FSTD=1；
STEP2：计算。的各项乘以，的各项乘以。将下标A换成B；
STEP3：计算q
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算",0,1,0,0,0,0,0,0
"功能描述：红外数据处理
",0,0,0,0,1,0,0,0
"功能描述：根据陀螺输入预估卫星惯性姿态四元数。
",0,1,0,0,0,0,0,0
"功能描述：帆板未展开时的三轴喷气姿态控制。

处理：同用户需求的
（1）各轴喷气参数设置如表34所示
表34：消初段喷气姿态控制各轴喷气参数设置
|滚动|俯仰|偏航
|0.4|0.4|0.4
|1.0|1.0|1.0
|0.27|0.2|0.15
|0.15|0.15|0.15
|0.35|0.35|0.35
KJ2(s)|1|2|2
aJS（/s2）|0.281|0.216|0.118

（2）进行各轴平面喷气控制规律计算（同用户需求的）
（3）根据姿轨控喷气规律计算结果，发出相应的喷气指令（同用户需求的）",0,1,0,0,0,0,0,0
"功能描述：引入飞轮控制（包含启动、动量保持、喷气卸载等）及撤去飞轮控制。
处理：
根据ZT2的取值进行不同的处理，处理逻辑见下表，见用户需求。
ZT2=1：飞轮启动，动量保持
ZT2=2：飞轮整星零动量控制模式
ZT2 6：不用轮控
ZT3≤3：用红外+太阳+陀螺定姿，且接入控制回路
ZT3=A：星敏无陀螺定姿，且接入控制回路，整星零动量控制方式
ZT3=C：用星敏感器+陀螺定姿，且接入控制回路
ZT3=F：用红外+单个斜装陀螺定姿，且接入控制回路
                      表38：飞轮控制的判别处理
条件|处理
 ZT2 6或3个动量轮工作|（i = 1， … ，6）
ZT2=1，3个以上动量轮工作|飞轮动量保持控制及飞轮启动
ZT2=2，3个以上动量轮工作|""喷气卸载逻辑判断：
①，。当BZ1 = 8时令,=0.
② 当连续三次，则：FHU = A,若BZ1 =1或 2或 9，则：FHU = A 
③当FHU = A且ZT8  3且ZT9  3，则：飞轮动量保持控制及飞轮启动 
④当ZT,ZT，且且且，则：FHU = 0
⑤当ZT3 = F或B且且BZ50且且，则：FHU = 0
⑥ 若ZT3=A，则：
若且FSTD 1且且，则：FHU = 0
""

卫星的三轴转动惯量分别为 3023.2kgm2、  3453.1kgm2 、 4998.7kgm2。
其中飞轮动量保持控制及飞轮启动的处理详见用户需求，飞轮控制电压计算详见用户需求1.3.4",0,1,0,0,0,0,0,0
"功能描述：计算正常飞行模式轮控所需电压。
",0,1,0,0,0,0,0,0
"将接收AOCC系统注入参数存储地址中内容解包成对应的参数和变量的数据格式。
序号|功能描述|功能编号
|姿控数据块1|FREQ65.1
|变轨数据块|FREQ65.2
|轨道数据块|FREQ65.3
|动量轮参数块|FREQ65.4
|轮控系数块|FREQ65.5
|相平面控制参数块|FREQ65.6
|陀螺当量修正数据块|FREQ65.7
|红外太阳修正数据块|FREQ65.8
|星敏感器数据块|FREQ65.9
|故障判别因子系数块|FREQ65.10
|陀螺故障判别因子系数块|FREQ65.11
|全姿态捕获参数块|FREQ65.12
|SDC命令块|FREQ65.13
|LTU命令块|FREQ65.14
|程序块|FREQ65.15
|内存修改块|FREQ65.16
|姿控数据块2|FREQ65.17
|陀螺红外参数数据块|FREQ65.18
|星敏修正时无陀螺模式的修正参数块|FREQ65.19
|整星偏置动量数据块|FREQ65.20
|轨道注入保护参数块|FREQ65.21
|星敏感器程序块|FREQ65.22
|星敏感器程序注入控制块|FREQ65.23
|EEPROM程序操作块|FREQ65.24
|帆板命令块|FREQ65.25

具体内容见注入文件。",0,0,0,0,0,0,1,0
"功能描述：根据需求，计算去往小天区扫描模式机动过程中所需的目标姿态。
",0,1,0,0,0,0,0,0
功能描述：根据帆板角误差控制帆板跟踪太阳。,0,1,0,0,0,0,0,0
功能描述：根据从0.25秒/1秒内陀螺的角度增量，算出卫星在惯性空间的角速度。,0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|对地数传天线1数据的采集与处理|FREQ1.7.1|""对地数传天线1 LTU控制指令
""|对地数传天线1的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
|对地数传天线2数据的采集与处理|FREQ1.7.2|""对地数传天线2
LTU控制指令""|对地数传天线2的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
",0,0,0,0,0,1,0,0
功能描述：在正常模式中，利用1N推力器实现小推力变轨功能。,0,1,0,0,0,0,0,0
功能描述：接收总线指令。,0,0,0,0,0,0,1,0
"功能描述：选择通讯的星敏LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。                                                                                                                                                                                                                                                                                                                                               处理：
（1）星敏共有三个LTU，AOCC每个控制周期向注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中的星敏LTU发送取数指令。
（2）向选择的星敏LTU发送完取数指令后，获得星敏LTU返回的数据，将数据转换为所需的数据格式，具体参见星敏通讯协议
（3）星敏LTU数据采集过程中的故障处理见任务书中规定。",0,0,0,0,0,1,0,0
"功能描述：太阳定向完成后，利用数字太阳与红外信息，进行俯仰、滚动捕获，并建立正常姿态
",0,1,0,0,0,0,0,0
"功能描述：接收应急线路注入数据。
处理：应急线路的上行注入数据为姿控数据块，具体见上行注入文件。",0,0,0,0,0,0,1,0
"功能描述：各个模式的姿态和轨道控制。
处理：
定义星箭分离前为主动段工作模式（包括射前和主动段飞行状态），WorkMode=0。主动段工作模式下，应用软件进行下列工作：
星时计算；
数据采样，但无任何控制指令输出；
组帧遥测数据；
响应OBDH通讯命令；
在主动段查询星箭分离信号的有效性，确认依据为：读取2路星箭分离状态，若任意1路星箭分离为“已分离”状态，则认为本周期查到星箭已分离。如果在连续8个周期中至少6个周期都查到星箭已分离，则可确认为星箭已分离，进入入轨段模式，WorkMode =1。
通过注入在轨维护程序，实现部件测试功能。
模式控制作为一个功能的集合体反映了任务的执行情况，是确认测试和系统实验验证的重要的功能。各个模式控制中调用流程和条件见用户需求4.1至4.14：",0,1,0,0,0,0,0,0
"此章节01星为“发送AOCC侧摆事件数据”，现删除，替换为“发送AOCC硬件工作状态数据”
功能描述：发送AOCC硬件工作状态数据
处理：当控制计算机发生加电工作时，此功能有效标志默认为无效，当班计算机不会存储重要数据。此功能需要通过内存修改功能有效标志才能启动，每4S保存一次，存满后申请发送。复位后不清此功能的有效标志。OBDH中的数据为切机前的控制计算机保存的重要数据，可供地面下卸分析使用。",0,0,0,0,0,0,0,1
"功能描述：使用星敏感器A、B的测量，修正姿态四元数与姿态角速度。
",0,1,0,0,0,0,0,0
功能描述：发送姿态机动过程参数包。,0,0,0,0,0,0,0,1
功能描述：接收遥控固定参数注入块的数传天线系数,0,0,0,0,0,0,1,0
"功能描述：仅利用星敏感器C的测量，修正姿态四元数与姿态角速度移。
",0,1,0,0,0,0,0,0
"软件需求标识：FREQ14.1 
软件需求名称：数据采集 ",0,0,0,0,0,1,0,0
OBDH重要数据有两块，大小共为128字节，AOCC不做任何改动保存在RAM中。如果AOCC发生复位，应利用方式代码请求服务，索取OBDH重要数据进行保存。若在大于0.256s的时间内仍未收到接收OBDH重要数据的指令，则重新请求服务，同时索要OBDH重要数据的计数器累加，若此计数器大于等于40，则不再索要OBDH重要数据。若索要OBDH重要数据成功，将此计数器清零。,0,0,0,0,0,0,0,1
"功能描述：选择通讯的CMG线LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）CMG共有三个LTU，AOCC每个控制周期根据注入文件中的ZT14和加电状态的最大组合向指定的CMG LTU发送取数指令
（2）向选择的CMG LTU发送完取数指令，获得CMG LTU返回的数据，将数据转换为所需的数据格式，具体参见LTU通讯协议。
（3）CMG LTU数据采集过程中的故障处理见任务书中规定。",0,0,0,0,0,1,0,0
"上电/复位后，系统软件进行相应的初始化工作，之后调用应用软件的AInit()函数进行应用软件的初始化。应用软件初始化工作主要包括硬件初始化、变量初始化、星箭分离查询、确定部件加断电状态状态。
硬件初始化的内容如下表所示：
表5-2 上电/复位后硬件初始化表
内  容|状  态
串口初始化|按前面要求进行设置
CANA、B总线初始化|按通讯协议要求进行设置

硬件初始化完成后应用软件需对初始值不为0的变量初始化（系统软件已对B段变量清零），相应变量的初始化值见《卫星控制分系统控制计算机应用软件用户需求》和《卫星控制分系统注入参数及数据指令的用户需求》。应用软件需读取一次星时计数器值。
硬件和变量初始化完成后，应用软件连续进行5次星箭分离查询，每次间隔大于1ms。若连续3次查到星箭分离，则认为星箭已分离，置当前控制模式为“复位进入模式”，设置星时为0.75秒；否则认为星箭未分离，进行主动段初始化工作。",1,0,0,0,0,0,0,0
功能描述：利用星敏感器数据计算卫星对惯性的角速度在本体系的分量,0,0,0,1,0,0,0,0
"功能描述：根据任务要求，应用软件进行LTU初始化、1553B初始化、调用系统软件的StartStarTimer、变量的初始化
处理：
进行1553B初始化，处理过程见4.3.2的OBDH初始化功能
GPS秒脉冲信号接口寄存器初始化
设置3个星敏的 RTS信号为无效
把模式字初始化为零
上电时，将在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff；复位时，若在轨维护程序区未发生双错，则应用软件从三取二区恢复在轨注入模块地址映射表JumpSlot、继续运行在轨维护程序；若在轨维护程序区发生双错，则应用软件不恢复在轨注入模块地址映射表JumpSlot，同时在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff，运行原PROM区的函数模块
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。",1,0,0,0,0,0,0,0
"功能描述：利用星敏感器和陀螺输出计算姿态四元数。
",0,1,0,0,0,0,0,0
"功能描述：利用陀螺确定出卫星对目标的姿态四元数。
",0,1,0,0,0,0,0,0
功能描述：计算太阳星历、红外补偿量及光行差计算。。,0,1,0,0,0,0,0,0
功能描述：抖动帆板。,0,1,0,0,0,0,0,0
"功能描述：与星敏感器通讯，获得星敏感器数据。
处理：
在使用Astro10星敏感器之前需对星敏感器进行初始化，完成后向星敏感器发出R有效信号，并通过串行口得到星敏感器提供的数据。在AO与星敏感器通信过程中，AO始终处于主动状态。当AO发出R信号下降沿后星敏感器在5ms内返回数据，AO在接收完数据后把R信号置高电平，星敏感器在R信号的上升沿之后的1ms内停止发送数据。
tro10星敏感器通讯故障时，不使用Astro10星敏感器数据进行姿态修正。",0,0,0,0,0,1,0,0
"功能描述：选择通讯的LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）甚高精度星敏共有1个LTU，AOCC每个控制周期根据注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中是否通讯的甚高精度星敏LTU发送取数指令。
（2）向甚高精度LTU发送完取数指令后，获得甚高精度星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,1,0,0
"功能描述：无陀螺时用红外估计滚动、俯仰姿态角及角速度信息。
输入：前两个周期、上个周期得到的，
红外处理数据，
红外常值偏差估值，（量纲：弧度）
红外数据有效性标志F_IresValid(由有效性判据给出)
红外工作周期（=0.75s）
",0,1,0,0,0,0,0,0
"软件需求标识：FREQ21 
软件需求名称：部件加断电指令处理 
需求类别：其他 
软件需求描述：部件加断电指令处理。",0,0,0,0,0,1,0,0
"功能描述：发送星敏陀螺数据
处理：将星敏陀螺数据打包后放到发送星敏陀螺数据存储地址中
AOCC每个控制周期（250ms）组织128个字节星敏陀螺数据，OBDH每500ms取1次星敏陀螺数据（256个字节）。其中前128字节数据对应小星时的星敏陀螺数据，后128字节数据对应大星时的星敏陀螺数据。",0,0,0,0,0,0,1,0
功能描述：帆板未展开模式控制,0,1,0,0,0,0,0,0
功能描述：主动段模式控制,0,1,0,0,0,0,0,0
"功能描述：喷气控制，要求将CMG控至标称角动量，保持这个标称角动量。
输入：地面注入的CMG引入标志[i]（0切除；1引入）；各CMG的框架角度Sgang[i]（弧度）；三轴角动量偏差、、（Nms）；CMG有效标志Lcmg[i]（1代表有效，0代表无效）",0,1,0,0,0,0,0,0
功能描述：若某个模拟太阳故障，则模拟太阳数据无效。若某个模拟太阳不见太阳标志，则该模拟太阳无效。,0,1,0,0,0,0,0,0
"功能描述：选择通讯的天线LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
  （1）加电状态的判断：OBDH在给捕跟分系统发送加电命令的同时，将该命令发送给AOCC。AOCC根据命令字的内容，记录加电状态和工作的主备状态。当第一次得到加电指令时，如果没有主备命令，默认工作在主份；当没有加电，但是发送了主备切换命令，切换有效。中继捕跟分系统断电，再加电后，保留中继上次加电工作状态；当AOCC发生复位、NMI和切机时，保留中继上次加电工作状态。
（2）数据通讯：当接收到中继快扫命令，并且AOCC判断中继捕获跟踪分系统加电状态下，AOCC每个0.524秒控制周期，向GDA发送一次天线驱动机构双轴指向数据。并接收GDA传回的X、Y轴测量角度信号和两轴的偏差角度（X轴框架角、Y轴框架角、X轴偏差角、Y轴偏差角、X轴框架角速度、Y轴框架角速度）。当接收到中继停止命令或判断中继不加电，则停止通讯。",0,0,0,0,0,1,0,0
