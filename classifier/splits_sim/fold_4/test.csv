Requirements Description,初始化,控制计算,控制输出,故障诊断和处理,数据有效性判断,数据采集,遥控,遥测
"功能描述：发送星敏陀螺数据给OBDH保存
处理：将星敏陀螺数据打包后放到星敏陀螺数据内存地址空间中。",0,0,0,1,0,0,0,0
"功能描述：选择通讯的数传天线LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）数传天线有四个LTU，天线1和2各有两个互为备份。应用软件初始上电时不与数传天线通讯，与数传天线开始通讯的条件为：收到数传天线预指或复位总线指令和数传天线加电。停止与数传天线通讯的条件为：收到数传天线停止总线指令和数传天线断电。其中数传天线加断电状态由1553B的接收数传天线伺服控制器状态设置数据命令来确定。同时也根据这个命令确定参与通讯的LTU。初始为选择主份，收到主切备时切换到备份；在备份通讯时，收到备切主时切换到主份。
（2）向数传天线LTU发完取数命令后，获得数传天线LTU返回的数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式。",0,0,0,0,0,1,0,0
"功能描述：发送天线数据包
",0,0,0,1,0,0,0,0
功能描述：接收遥控固定参数注入块的系统功能参数设置区数据,0,0,0,0,0,0,1,0
"序|需求名称|编号|输入|输出|功能及处理描述
|对地数传天线1数据的采集与处理|FREQ1.7.1|""对地数传天线1 LTU控制指令
""|对地数传天线1的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
|对地数传天线2数据的采集与处理|FREQ1.7.2|""对地数传天线2
LTU控制指令""|对地数传天线2的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
|中继天线数据的采集与处理|FREQ1.7.3|中继天线LTU控制指令|中继天线的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向中继天线 LTU发控制指令，获得中继天线数据并处理成对应的角度等信息。
",0,0,0,0,0,1,0,0
"功能描述：轨控模式控制
",0,0,0,1,0,0,0,0
轨道与星历计算包括卫星轨道计算、太阳星历计算、GPS计算、地磁场计算四部分。应用软件根据注入轨道参数或GPS数据进行卫星轨道实时计算，确定卫星轨道根数。太阳星历计算可确定太阳方位以及惯性系到轨道坐标系转换矩阵。地磁场的计算可确定地磁场强度。应用软件根据以上计算结果为姿态确定和姿态控制提供轨道和星历以及地磁场强度数据。卫星轨道、太阳星历、地磁场和GPS数据转换为轨道根数计算在1.0秒控制任务的任务1中完成。,0,1,0,0,0,0,0,0
"模式字定义如下，装订值为0：
模式字|工作模式描述
0|主动段
1|正常对地运行
2|偏航机动
3|全姿态捕获
4|对地捕获
5|帆板未展开
6|轨控
7|无控
8|侧摆机动
9| 侧摆保持
11|入轨段控制
12|自旋模式
13|应急模式
14|星敏全姿态捕获模式

工作模式的转换可分为以下二种情况：
按地面上行注入进行转换：通过注入姿控数据块中的模式字进行转换；
按应用软件用户需求给定的条件判别，由软件自主控制转换：自主转换分两种：一种为正常运行转换；一种为故障时转换。下面分别进行说明
正常转换图为：
正常运行自主转换如下表所示：条件标识原则：ZCCX—Y，其中ZCC表示正常自主转换条件，X为转出的模式字，Y为转入的模式字。
标识|具体条件
ZCC0—B|星箭分离
ZCCB—1|Tin >4800 
ZCC1—2|
ZCC1—6|
ZCC1—8|且且且
ZCC2—1|
ZCC2—6|
ZCC4—1|FEA=A
ZCC6—1|
ZCC6—2|)且
ZCC8—1|""满足下列条件之一：
若动量轮侧摆且目标侧摆角为0，当姿态角误差小于0.5度，角速度误差小于0.01度/s连续次
若喷气侧摆且目标侧摆角为0，当姿态角误差小于1度，角速度误差小于0.015度/s连续次
若星时大于侧摆机动时间＋600秒且侧摆目标角为0""
ZCC8—9|""满足下列条件之一：
若动量轮侧摆且目标侧摆角不为0，当姿态角误差小于0.5度，角速度误差小于0.01度/s连续次
若喷气侧摆且目标侧摆角不为0，当姿态角误差小于1度，角速度误差小于0.015度/s连续次
若星时大于侧摆机动时间＋600秒且侧摆目标角不为0""
ZCC9—8|""满足下列条件之一：
且
""

故障自主转换如下表所示：条件标识原则：GCX—Y，其中GCC表示正常自主转换条件，X为转出的模式字，Y为转入的模式字。其中进入应急模式的条件为读到应急线路加电，记为GCC-D。其余的自主故障切换如下图所示：
故障条件定义如下：
标识|具体条件
GCC1—3|FailureFlag=1并且WacqSunFlag =0并且ZT7属于[1，4]区间内
GCC1—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCC1—E|FailureFlag=1并且WacqSunFlag=1并且ZT7属于[1，4]区间内
GCC3—7|FailureFlag＝4且AutoInStopNum<2
GCC3—E|SMODE＝3且TSMODE>8000（若ZT11=4则取值为32000）
GCC4—1|FEA=A
GCC4—3|WacqUseIresOrSTSFlag=1且TCOUNT>24000
GCC5—3|脉冲发完后
GCC6—1|FailureFlag＝2且无机动要求
GCC6—2|FailureFlag＝2且无机动要求
GCC7—3|>6900 且AutoInStopNum<2且WacqSunFlag =0
GCC7—E|>6900 且AutoInStopNum<2且WacqSunFlag =1
GCC8—1|FailureFlag=3
GCC9—3|FailureFlag=1并且WacqSunFlag=1并且ZT7属于[1，4]区间内
GCC9—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCC9—E|FailureFlag=1并且WacqSunFlag=0并且ZT7属于[1，4]区间内
GCCB—3|FailureFlag=1并且ZT7属于[1，4]区间内
GCCB—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCCE—1|StarCatchFlag=1且(1-()<0.000685)且norm()<0.000875
GCCE—7|TCOUNT>31200或（FailureFlag＝4且AutoInStopNum<2）

AOCC切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,1,0,0,0,0,0,0
"表格工作项|软件需求标识|软件需求名称|
FREQ23.1|固定地址参数|见“上行注入”5|
FREQ23.2|可变地址参数|见“上行注入”6|
FREQ23.3|轨道参数|见“上行注入”7|
FREQ23.4|程序注入|见“上行注入”8|
FREQ23.5|内存下卸|见“上行注入”9|
FREQ23.6|星敏部件控制注入|见“上行注入”10|
FREQ23.7|中继目标轨道|见“上行注入”11|
FREQ23.8|轨控命令|见“上行注入”12|
FREQ23.9|间接指令|见“上行注入”13|
FREQ23.10|固定地址|见“上行注入”14|
",0,0,0,0,0,0,1,0
功能描述：为三轴姿态喷气控制选择喷管；并记录喷气时间等。,0,1,0,0,0,0,0,0
"功能描述：使星体−Z 轴捕获太阳。
",0,1,0,0,0,0,0,0
功能描述：发送姿态机动过程参数包。,0,0,0,0,0,0,0,1
功能描述：计算在整星角动量偏置下，CMG控制时的框架角速率指令。,0,1,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|姿态控制算法|FREQ4.0|5.4|选择控制方式，并计算控制输出
|喷气控制|FREQ4.1|5.4.1|为三轴姿态喷气控制选择喷管；并记录喷气时间等
|CMG控制说明|FREQ4.2|5.4.2.1|CMG控制说明
|CMG高速启动|FREQ4.4|5.4.2.2|启动CMG高速
|CMG群角动量释放|FREQ4.5|5.4.2.3|释放CMG群积累的角动量
|姿态控制力矩及CMG框架指令计算|FREQ4.6|5.4.2.4|使用红外、星敏、太阳定姿时，计算CMG的框架角速率指令
|偏置动量的CMG指令计算|FREQ4.7|5.4.2.5|计算在整星角动量偏置下，计算CMG控制时的框架角速率指令
|喷气卸载条件计算|FREQ4.8|5.4.3|喷气卸载进入和退出条件计算
|CMG数据处理|FREQ4.9|5.4.4|CMG数据处理
|磁卸载控制|FREQ4.10|5.4.5|根据轨控需求和姿控推力器使用情况，开推力器进行轨道控制
|轨道控制喷气|FREQ4.3|5.4.6|根据合成角动量及地磁场强度决定并输出磁棒控制电压
|地面站位置计算|FREQ4.11|5.6.1.1|地面站赤经赤纬计算
|数传天线指向控制|FREQ4.14|5.6.1|根据指令完成数传天线的指向控制
|CMG群标称角动量维持算法算法产品规范|FREQ4.15|/|规范化算法：
|直线型相平面喷气姿态控制算法产品规范|FREQ4.16|/|规范化算法：
|SGCMG群框架角速度指令解算算法产品规范|FREQ4.17|/|规范化算法：
|四阶结构滤波器算法产品规范|FREQ4.18|/|规范化算法：
|连续电压式磁卸载算法产品规范|FREQ4.19|/|规范化算法：
|地面目标矢量计算算法产品规范|FREQ4.20|/|规范化算法：
|基于三轴角动量反馈的偏置动量控制方法产品规范|FREQ4.21|/|规范化算法：
|数传天线指向目标角计算|FREQ4.14.2|5.6.1.2|根据指定跟踪数传天线与其被指定跟踪站的方位，计算其跟踪转角
",0,1,0,0,0,0,0,0
"功能描述：利用星敏感器数据进行卫星姿态捕获。
",0,1,0,0,0,0,0,0
"功能描述：选择通讯的LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）甚高精度星敏共有1个LTU，AOCC每个控制周期根据注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中是否通讯的甚高精度星敏LTU发送取数指令。
（2）向甚高精度LTU发送完取数指令后，获得甚高精度星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,1,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|平台陀螺数据的采集与处理|FREQ1.2.1|""平台陀螺1553B取数指令
""|陀螺1-4的速度增量|在通讯允许的条件下（每个陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|测微陀螺数据的采集与处理|FREQ1.2.2|""
遥测数据""|陀螺5-8的速度增量|从遥测数据中，获得陀螺数据并处理成对应的速度增量。
",0,0,0,0,0,1,0,0
"功能描述：各模式控制量计算
序号|功能编号|功能简述|功能详述
|FREQ3.4.3.1|等待段调用流程|用户需求4.1.1【调用流程】
|FREQ3.4.3.2|太阳定向模式调用流程|用户需求4.1.2【调用流程】
|FREQ3.4.3.3|恒星定向2/4模式调用流程|用户需求4.1.3【调用流程】
|FREQ3.4.3.4|惯性调姿模式调用流程|用户需求4.1.5【调用流程】
|FREQ3.4.3.5|轨控定向模式调用流程|用户需求4.1.6【调用流程】
|FREQ3.4.3.6|着陆准备模式调用流程|用户需求4.1.7【调用流程】
|FREQ3.4.3.7|主减速模式调用流程|用户需求4.1.8【调用流程】
|FREQ3.4.3.8|快速调整模式调用流程|用户需求4.1.9【调用流程】
|FREQ3.4.3.9|接近下降模式调用流程|用户需求4.1.10【调用流程】
|FREQ3.4.3.10|悬停模式调用流程|用户需求4.1.11【调用流程】
|FREQ3.4.3.11|避障模式调用流程|用户需求4.1.12【调用流程】
|FREQ3.4.3.12|缓速下降模式调用流程|用户需求4.1.13【调用流程】
|FREQ3.4.3.13|自主定位模式调用流程|用户需求4.1.14【调用流程】
|FREQ3.4.3.14|起飞准备模式调用流程|用户需求4.1.15【调用流程】
|FREQ3.4.3.15|垂直上升模式调用流程|用户需求4.1.16【调用流程】
|FREQ3.4.3.16|上升调姿模式调用流程|用户需求4.1.17【调用流程】
|FREQ3.4.3.17|轨道入射模式调用流程|用户需求4.1.18【调用流程】
|FREQ3.4.3.18|星光环月模式调用流程|用户需求4.1.19【调用流程】
|FREQ3.4.3.19|速率阻尼模式调用流程|用户需求4.1.20【调用流程】
|FREQ3.4.3.20|无控模式调用流程|用户需求4.1.21【调用流程】
",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|给VIPPCU发送轮询和校时包|FREQ1.8.1|""无
""|校时等数据|在每个控制周期与VIPPCU通讯时，在“轮询与校时包”中发送本周期的控制UTC时间
|VIPPCU加电状态状态数据的采集与处理|FREQ1.8.2|""加电状态
""||CCU通过采集来自VIPPCU的 “VIPPCU A机加电状态”、“VIPPCU B机加电状态”两个0～5V模拟量，来确定VIPPCU的A、B机加电状态。
|给VIPPCU发送的下平台控制数据|FREQ1.8.3|无|控制数据|CCU给VIPPCU发送的下平台控制数据。
|给VIPPCU发送CCU的重要数据|FREQ1.8.5|无|CCU的重要数据|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|给VIPPCU发送VIPPCU的重要数据|FREQ1.8.6|无|VIPPCU的重要数据|给VIPPCU发送VIPPCU的重要数据
|转发VIPPCU上注指令参数块|FREQ1.8.7|无|VIPPCU上注指令参数块|需要时，转发VIPPCU上注指令参数块
|接收VIPPCU遥测数据|FREQ1.8.8|VIPPCU遥测数据|无|每个控制周期，接收VIPPCU遥测数据，解包成需要的数据
|接收CCU重要数据返回包|FREQ1.8.9|CCU重要数据|指令|上电/复位后应用软件首先从VIPPC恢复重要数据。
",0,0,0,0,0,1,0,0
根据同步字的编码内容进行相应的处理：,0,0,0,0,0,0,1,0
功能描述：由模拟太阳粗细码得到模拟太阳角、全开码、见太阳标志。,0,0,0,0,0,1,0,0
功能描述：计算地磁场矢量分量。,0,1,0,0,0,0,0,0
"功能描述：将星务通过CAN总线广播的GPS定位数据转换成轨道根数。
处理：
由GPS定位数据r（位置），v（速度）计算出轨道六要素（半长轴、偏心率（由两部分组成）、轨道倾角、升交点赤经、平近地点幅角）并通过半长轴、轨道倾角、升交点赤经、平近地点幅角、星时校验，再通过轨道六要素计算其他轨道根数。",0,1,0,0,0,0,0,0
功能描述：为星敏感器定姿提供初始的相对惯性的姿态四元数。,0,1,0,0,0,0,0,0
"功能描述：部件通讯选通
处理：
详见“任务书”5.1.2.2串口数据采集和处理的（一）部件通讯与选用。",0,0,0,1,0,0,0,0
"功能描述：进行模式初始化。
处理：
（1）置帆板归零； 
（2）置 ===0；=0;= 0；",0,1,0,0,0,0,0,0
"功能描述：根据任务要求，应用软件1553B初始化、变量的初始化                                                                                                                                                                                                                                                                                                                                                                                                             处理：
进行1553B初始化，处理过程见的OBDH初始化功能
设置3个星敏的 RTS信号为无效
把模式字初始化为零
上电时，将在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff；复位时，若在轨维护程序区未发生双错，则应用软件从三取二区恢复在轨注入模块地址映射表JumpSlot、继续运行在轨维护程序；若在轨维护程序区发生双错，则应用软件不恢复在轨注入模块地址映射表JumpSlot，同时在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff，运行原PROM区的函数模块
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。",1,0,0,0,0,0,0,0
功能描述：进行单轴相平面分区及控制规律计算。由决定是否要喷气；喷气的脉冲宽度；确定本时刻的。,0,1,0,0,0,0,0,0
"功能描述：决定利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序。
",0,1,0,0,0,0,0,0
"功能描述：
  通过简化伪速率调制器计算5N推力器喷气脉冲，并输出(功能编号：FReq-3。
处理：根据三轴简化伪速率调制器的输出值计算出12个5N推力器的输出值。重新置定时器0的初值，设置5N推力器的输出，启动定时器0计数。逻辑如下：
根据5.2.5节获取控制力矩Yi：
若Yi–r>h1,  则输出Y＝1，Tri＝1；
  		若Yi–r<-h1, 则输出Y＝-1，Tri＝-1；
  		否则输出Y＝0，Tri＝0；
		r = 0.614*r + 0.0861*Y   // r 上电初始化为0
当 Tri = 1 
	ThrNoNi = ThrNoNi + 1                   		 
当Tri = -1
	ThrNoPi = ThrNoPi + 1                   		
当Y为+1时产生一个64ms的负脉冲，Y为-1时产生一个64ms的正脉冲。
具体喷管的选择参考任务书。
   推力器双分支工作时，若A份中的推力器不健康，则使用B份对应的推力器。
说明： 控制力矩的计算增加 伪速率调制器r的计算，同时修改h1的参数",0,0,1,0,0,0,0,0
功能描述：帆板未展开模式控制,0,1,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的中继天线系数,0,0,0,0,0,0,1,0
功能描述： CMG控制,0,1,0,0,0,0,0,0
功能描述：根据指令完成中继天线的捕获跟踪控制。,0,1,0,0,0,0,0,0
"功能描述：使用数字太阳敏感器修正姿态，估计陀螺漂移。
",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|红外1数据的采集与处理|FREQ1.3.1|""红外1
1553B取数指""|红外1的弦宽和前基|在通讯允许的条件下（红外1的当班标志为1），每1秒向红外1RT发取数指令，获得红外1数据并处理成对应的弦宽和前基。CCU应用软件取数消息与同步消息的发送时间间隔大于3ms
|红外2数据的采集与处理|FREQ1.3.2|""红外2
LTU取数指令""|红外2的数据|在通讯允许的条件下（红外2的当班标志为1），向红外2 LTU发取数指令，获得红外2数据并处理成对应的数据。
",0,0,0,0,0,1,0,0
"上电/复位后，系统软件进行相应的初始化工作，之后调用应用软件的AInit()函数进行应用软件的初始化。应用软件初始化工作主要包括硬件初始化、变量初始化、星箭分离查询、确定部件加断电状态状态。
硬件初始化的内容如下表所示：
表5-2 上电/复位后硬件初始化表
内  容|状  态
串口初始化|按前面要求进行设置
CANA、B总线初始化|按通讯协议要求进行设置

硬件初始化完成后应用软件需对初始值不为0的变量初始化（系统软件已对B段变量清零），相应变量的初始化值见《卫星控制分系统控制计算机应用软件用户需求》和《卫星控制分系统注入参数及数据指令的用户需求》。应用软件需读取一次星时计数器值。
硬件和变量初始化完成后，应用软件连续进行5次星箭分离查询，每次间隔大于1ms。若连续3次查到星箭分离，则认为星箭已分离，置当前控制模式为“复位进入模式”，设置星时为0.75秒；否则认为星箭未分离，进行主动段初始化工作。",1,0,0,0,0,0,0,0
功能描述：实时计算卫星轨道参数及太阳方位、太阳敏感器理论输出。,0,1,0,0,0,0,0,0
"功能：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。
输入：星敏感器A修正新息，四元数、陀螺常漂
输出：修正四元数、陀螺常漂
",0,1,0,0,0,0,0,0
"此章节01星为“发送AOCC侧摆事件数据”，现删除，替换为“发送AOCC硬件工作状态数据”
功能描述：发送AOCC硬件工作状态数据
处理：当控制计算机发生加电工作时，此功能有效标志默认为无效，当班计算机不会存储重要数据。此功能需要通过内存修改功能有效标志才能启动，每4S保存一次，存满后申请发送。复位后不清此功能的有效标志。OBDH中的数据为切机前的控制计算机保存的重要数据，可供地面下卸分析使用。",0,0,0,0,0,0,0,1
功能描述：决定采用磁卸载还是喷气卸载方式，调用相应程序。,0,1,0,0,0,0,0,0
"功能描述：滚动通道喷气中断处理程序。
处理：将推力器1-8关掉",0,0,0,1,0,0,0,0
功能描述：星上实时计算地磁场强度,0,1,0,0,0,0,0,0
"功能描述：接收同步控制
处理：根据同步字的编码内容进行相应的处理：",0,0,0,0,0,0,1,0
"功能描述：采集星上时钟的计数值，计算星时及作相应的处理
处理：包括CPU内部星时时钟和CPU外部星时时钟的星时采集计算与校时。
（1）CPU外部星时时钟的星时采集计算与校时
CPU外部星时时钟星时计算的输入为上一个周期对应的绝对星时t，和上个周期中控制周期星时锁存寄存器中读取的计数值为TOLD。在每个控制周期中处理过程如下：
STEP1：选取控制周期星时锁存通道，读取锁存的计算值，记为TNEW；
STEP2：计算TNEW减去TOLD的差值，记为DELTT（当量为1微秒）；
STEP3：本周期的绝对星时t=t+DELTT/1000000；
STEP4：保存本周期的计数值，即TOLD=TNEW。
CPU外部星时时钟星时校时包括OBDH校时和GPS高精度校时两种校时方式：
OBDH校时：当“OBDH星时校时开关”为允许的情况下，进行校时，要求“OBDH星时校时开关”为可内存修改的变量（默认为“OBDH星时校时开关”为“允许”），地面可通过内存修改的方式设置“OBDH星时校时开关”。也分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时；
 GPS高精度校时。
OBDH星时校时为系统默认使用的校时方式。GPS秒脉冲高精度时间是否引入系统由注入指令执行控制：若注入指令表示“使用GPS秒脉冲高精度校时时间”，则当满足GPS秒脉冲高精度校时条件时AOCC应用软件仅进行GPS秒脉冲高精度校时时间的计算，系统使用该时间。GPS秒脉冲高精度方式优先级高于OBDH星时校时，当GPS秒脉冲校时时不再进行OBDH星时校时。如果连续超过1分钟均不满足GPS秒脉冲高精度校时条件，则可进行OBDH星时校时。一旦再满足GPS秒脉冲高精度校时条件则继续采用GPS秒脉冲高精度校时。其中GPS秒脉冲高精度校时条件及校时计算具体见任务书中规定。
（2）CPU内部星时时钟的星时采集计算与校时
CPU内部星时时钟星时计算方法。同CPU外部星时时钟星时计算；CPU内部星时时钟星时校时只包括OBDH校时：分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时。
星时的选取
根据注入的姿控数据块2中的CPU星时时钟选用标志来实现内部星时时钟和外部星时时钟的切换，默认为CPU外部星时时钟
均匀校时
内部和外部时钟星时计算中在计算完本周期绝对星时后增加每周期修正量，并在计算前先将它限幅到1毫秒，每周期的修正量初始为0，通过内存修改来修改该修正量。",0,0,0,0,1,0,0,0
"功能描述：根据上行注入指定工作模式和星上自主模式切换的条件进行模式管理。
处理：
工作模式的转换可分为以下两种情况：
按《用户需求》给定的条件判别，由应用软件自主控制转换；
由地面注入的模式运行类指令强行执行。
下图中模式之间的连接线分为实线和虚线，实线表示正常转移，虚线表示故障转移，在下表中具体列出了模式转移的条件。
                            图5-1 自主模式转换图
表5.2.4.4-2 模式自主转换条件（除复位后重要数据恢复成功转模式外）
序号|功能编号|功能简述|功能详述
|FREQ3.4. 1.22|WM0_to_WM1|连续27s满足组合体分离状态为已分离且触地开关状态为未触地后，系统转太阳定向模式，置LAFlag=00H，为组合体状态；
|FREQ3.4. 1.27|WM1_to_WM20|太阳定向模式中，若故障标志FailureFlag=3，则转入无控模式
|FREQ3.4. 1.28|WM2_to_WM3|""恒星定向2模式中，若惯性调姿开始时刻到tgon≤t≤tgon +ΔtMS且
tgon≥0，则转惯性调姿模式""
|FREQ3.4. 1.29|WM2_to_WM19|恒星定向2模式中，若故障标志FailureFlag=1，则转入速率阻尼模式
|FREQ3.4. 1.30|WM3_to_WM4|""惯性调姿模式中，若姿态好或恒星定向4的时间到，即连续20个周期满足|qBT|≤qhon且|ω|≤ωhon或t≥thon，则转入恒星定向4模式""
|FREQ3.4. 1.31|WM3_to_WM19|惯性调姿模式中，若故障标志FailureFlag=1，则转入速率阻尼模式
|FREQ3.4. 1.32|WM4_to_WM5|恒星定向4模式中，若轨控开始时刻到tgi≤t≤tgi+ΔtMS且tgi>0，则转入轨控定向模式
|FREQ3.4. 1.33|WM4_to_WM6|""恒星定向4模式中，若着陆上升组合体状态下着陆准备开始时刻到且启动动力下降标志有效，即LAFlag=0且
t0+Δtdb-t0p≤t≤t0+Δtdb-t0p+ΔtMS且
BKFlag=1，则转入着陆准备模式""
|FREQ3.4. 1.34|WM4_to_WM19|恒星定向4模式中，若故障标志FailureFlag=1，则转入速率阻尼模式
|FREQ3.4. 1.35|WM5_to_WM1|轨控定向模式中，若轨控子模式字GMODE=2后计时>240s，则转入太阳定向模式
|FREQ3.4. 1.36|WM5_to_WM19|轨控定向模式中，若故障标志FailureFlag=1，则转入速率阻尼模式
|FREQ3.4. 1.37|WM6_to_WM7|着陆准备模式中，若着陆准备模式开始时刻到且启动动力下降标志BKFlag=1，则转入主减速模式
|FREQ3.4. 1.38|WM7_to_WM8|主减速模式中，若FailureFlag=0且PDMSFlag=1，则转入快速调整模式
|FREQ3.4. 1.39|WM7_to_WM9_1|主减速模式中，若FailureFlag=0但是高度已经在主减速切换到接近下降的高度内h<hSafe1，则转入接近下降模式
|FREQ3.4. 1.40|WM7_to_WM9_2|主减速模式中，若（出现陀螺饱和Flag=1，则转入接近下降模式
|FREQ3.4. 1.42|WM7_to_WM10_2|主减速模式中，若FailureFlag=5且 速度满足故障时切换到悬停模式的条件且高度已在悬停高度偏差内，则转入悬停模式
|FREQ3.4. 1.44|WM7_to_WM10_4|主减速模式中，若FailureFlag=5且制导时间已经在切换到悬停模式的阀值内，则转入悬停模式
|FREQ3.4. 1.45|WM8_to_WM9_1|快速调整模式中，若PDMSFlag=2，则转入接近下降模式
|FREQ3.4. 1.46|WM8_to_WM9_2|快速调整模式中，若允许调用安全模式制导律ZT11(D10)=1，则转入接近下降模式
|FREQ3.4. 1.47|WM8_to_WM9_3|快速调整模式中，若高度已经小于快速调整转入接近下降的高度h<hSafe2，则转入接近下降模式
|FREQ3.4. 1.48|WM8_to_WM9_4|快速调整模式中，若出现陀螺饱和Flag=1，则转入接近下降模式
|FREQ3.4. 1.49|WM9_to_WM10_1|接近下降模式中，若接近段无超差AppFFlag=0且动力下降段模式切换标志PDMSFlag=4，则转入悬停模式
|FREQ3.4. 1.50|WM9_to_WM10_2|接近下降模式中，若接近段有超差AppFFlag=1且速度满足故障时切换到悬停模式的条件且高度已在悬停高度偏差内h≤hsus+ dhsus，则转入悬停模式
|FREQ3.4. 1.51|WM9_to_WM10_3|接近下降模式中，若接近段有超差AppFFlag=1且制导时间已经在切换到悬停模式的阀值内tgo1<tgo1AS，则转入悬停模式
|FREQ3.4. 1.52|WM10_to_WM11_1|悬停模式中，若已获安全着陆点SLPFlag=1，则转入避障模式
|FREQ3.4. 1.53|WM10_to_WM11_2|悬停模式中，若悬停计时超过悬停模式切换到避障模式的计时阀值tSH，则转入避障模式
|FREQ3.4. 1.54|WM10_to_WM11_3|悬停模式中，若成像时间已经只剩一个控制周期Tsus≤Δt，则转入避障模式
|FREQ3.4. 1.74|WM10_to_WM11_4|悬停模式中，若BZ1=7或8或9或10时发生过复位，则当vmb_B 低于阀值后转避障
|FREQ3.4. 1.55|WM11_to_WM12_1|避障模式中，若高度距离缓速下降起始高度已经达到模式切换阀值，则转入缓速下降模式
|FREQ3.4. 1.56|WM11_to_WM12_2|避障模式中，若制导时间与避障垂向规划轨迹标称时间之差大于2个控制周期，则转入缓速下降模式
|FREQ3.4. 1.57|WM12_to_WM20_1|""缓速下降模式中，若收到关机信号且缓速下降持续时间大于缓速下降切换到无控的时间切换阀值1，则转入无控模式
转模式增加TouchDownFlag=1
删除积分项清0""
|FREQ3.4. 1.58|WM12_to_WM20_2|""缓速下降模式中，若缓速下降持续时间大于缓速下降切换到无控的时间切换阀值2，则转入无控模式
转模式增加TouchDownFlag=1
删除积分项清0""
|FREQ3.4. 1.59|WM12_to_WM20_3|""缓速下降模式中，若缓速下降持续时间大于缓速下降切换到无控的时间切换阀值3且注入指令允许加速度关机，则转入无控模式
转模式增加TouchDownFlag=1
删除积分项清0""
|FREQ3.4. 1.60|WM14_to_WM15|""起飞准备模式中，若起飞时间到且收到着陆上升器分离信号，则转垂直上升模式
转模式删除tLaunch=t""
|FREQ3.4. 1.70|WM14_to_WM20|起飞准备模式中，若FailureFlag=7，则转无控模式，置BZ1=20
|FREQ3.4. 1.61|WM15_to_WM16|""垂直上升模式中，t>tswitch或（max(|φc|,|θc|,|ψc|)<Φswitch且dh>vswitch 且FailureFlag=0，则切换为BZ1=16""
|FREQ3.4. 1.71|WM15_to_WM17|""垂直上升模式中，t>tswitch或（max(|φc|,|θc|,|ψc|)<Φswitch且dh>vswitch 且FailureFlag≠0，则置PEGConvergeFlag=0，切换为BZ1=16""
|FREQ3.4. 1.69|WM15_to_WM20|垂直上升模式中，若t≥tLaunch+Δtac 且RCSOnFlag≠1，则切换为无控模式BZ1=20
|FREQ3.4. 1.62|WM16_to_WM17|上升调姿模式中，若t-tswitch>tPD1且δθgui≤ΔθPD）或t-tswitch>tPD2，则转入轨道入射模式
|FREQ3.4. 1.72|WM16_to_WM17_2|上升调姿模式中，若FailureFlag≠0，则置PEGConvergeFlag=0，并切换轨道入射模式BZ1=17。
|FREQ3.4. 1.63|WM17_to_WM1_1|轨道入射模式中，若GMODE=2且TGMODE·Δt>Δtaf，则转入太阳定向模式
|FREQ3.4. 1.75|WM17_to_WM3|轨道入射模式中，若GMODE=2且FailureFlag=8，则转入惯性调姿
|FREQ3.4. 1.65|WM18_to_WM1|星光环月模式下，若FailureFlag=6，则转入太阳定向模式
|FREQ3.4. 1.66|WM18_to_WM20|星光环月模式下，若收到轨道器或地面发送的转无控命令，或收到微波应答机发送的停控指令后，则转入无控模式
|FREQ3.4. 1.67|WM19_to_WM2|速率阻尼模式下，若连续100个周期满足惯性角速度好，且ZT11(D11)=1，则转恒星定向2
|FREQ3.4. 1.68|WM19_to_WM1|速率阻尼模式下，若FailureFlag=2，则转入太阳定向模式
|FREQ3.4. 1.73|WM19_to_WM1_2|速率阻尼模式下，若连续100个周期满足惯性角速度好，且ZT11(D11) ≠1，则转入太阳定向模式
",0,1,0,0,0,0,0,0
功能描述：太阳全姿态捕获模式初始化,0,1,0,0,0,0,0,0
"功能描述：接收OBDH时间
处理：按接收OBDH时间命令存储地址中内容的数据格式处理成星时的数据格式。此处理在中断中进行。",0,0,0,0,0,0,1,0
"软件需求标识：FREQ18 
软件需求名称：模拟太敏数据处理 
需求类别：其他 
软件需求描述：模拟太敏数据处理。",0,0,0,0,0,1,0,0
功能描述：根据姿态估值与数字太阳输出，判断太阳修正可用性。,0,1,0,0,0,0,0,0
"功能描述：发送AOCC姿态数据（含侧摆角度）
处理： OBDH在相机成像期间每500ms从AOCC接收一次姿态数据（含2字节侧摆角度值），AOCC在OBDH完成接收姿态数据后，将新的姿态数据（含2字节侧摆角度值）写入总线发送缓冲区。其处理过程如下：
STEP1：AOCC应用程序每0.524秒查询一次有无OBDH发送数据请求，如果有则转入第二步，否则退出；
STEP2：根据不同的数据装载模式，确定装载数据，并按照遥测要求进行格式转换；
STEP3：把遥测缓存区的内容放入OBDH定义的内存中。",0,0,0,0,0,0,0,1
功能描述：启动飞轮或动量保持控制。,0,1,0,0,0,0,0,0
"功能描述：采集星上时钟的计数值，计算星时及作相应的处理
处理：包括CPU内部星时时钟和CPU外部星时时钟的星时采集计算与校时。。
（1）CPU外部星时时钟的星时采集计算与校时
CPU外部星时时钟星时计算的输入为上一个周期对应的绝对星时t，和上个周期中控制周期星时锁存寄存器中读取的计数值为TOLD。在每个控制周期中处理过程如下：
STEP1：选取控制周期星时锁存通道，读取锁存的计算值，记为TNEW；
STEP2：计算TNEW减去TOLD的差值，记为DELTT（当量为1微秒）；
STEP3：本周期的绝对星时t=t+DELTT/1000000；
STEP4：保存本周期的计数值，即TOLD=TNEW。
CPU外部星时时钟星时校时包括OBDH校时和GPS高精度校时两种校时方式：
OBDH校时：也分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时；
GPS高精度校时。
OBDH星时校时为系统默认使用的校时方式。GPS秒脉冲高精度时间是否引入系统由注入指令执行控制：若注入指令表示“使用GPS秒脉冲高精度校时时间”，则当满足GPS秒脉冲高精度校时条件时AOCC应用软件仅进行GPS秒脉冲高精度校时时间的计算，系统使用该时间。GPS秒脉冲高精度方式优先级高于OBDH星时校时，当GPS秒脉冲校时时不再进行OBDH星时校时。如果连续超过1分钟均不满足GPS秒脉冲高精度校时条件，则可进行OBDH星时校时。一旦再满足GPS秒脉冲高精度校时条件则继续采用GPS秒脉冲高精度校时。其中GPS秒脉冲高精度校时条件及校时计算具体见任务书中规定。
（2）CPU内部星时时钟的星时采集计算与校时
CPU内部星时时钟星时计算方法。同CPU外部星时时钟星时计算；CPU内部星时时钟星时校时只包括OBDH校时：分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时。
星时的选取
根据注入的姿控数据块2中的CPU星时时钟选用标志来实现内部星时时钟和外部星时时钟的切换，默认为CPU外部星时时钟
均匀校时
内部和外部时钟星时计算中在计算完本周期绝对星时后增加每周期修正量，并在计算前先将它限幅到1毫秒，每周期的修正量初始为0，通过内存修改来修改该修正量。",0,0,0,0,1,0,0,0
功能描述：由平衡方程方法、星敏感器数据进行陀螺的故障检测。,0,1,0,0,0,0,0,0
"功能描述：搜索地球，直到红外有地球信息。
",0,1,0,0,0,0,0,0
"功能描述：检测动量轮的故障。
",0,1,0,0,0,0,0,0
"功能描述：采集星上时钟的计数值，计算星时及作相应的处理
处理：
（1）AOCC的星上时钟是由一片54-4的通道0和1组成的32位计数器，输入脉冲速率为976.5625Hz。AOCC从54-4中读取32位时间（最小码位当量为1.024毫秒），将该时间转换为32位定点数并保存在THDT（LSB=1/8秒）、40位定点数并保存在THDT40（LSB=1/256秒）中。
（2）OBDH通过1553B总线每10分钟给AOCC校时一次（校时误差＜20ms），OBDH所产生的卫星时间为标准北京时间，其时间原点位于北京时间的毫秒的起点。卫星时间由6字节构成（如下表所示），其中高4字节为32比特的二进制的秒数，低2字节为亚秒部，最小码位当量为25微秒。将这个时间转换为LSB=1/8秒并保存在32位定点数TT0、TTS0和40位定点数TT040中，转换为36位定点LSB=1/128秒保存在OBQT36中。
47||     |0
秒（32位）|毫秒（16位）|秒（32位）|毫秒（16位）

（3）对0.524秒控制周期进行时间累计将结果保存在32位定点数TSDT（LSB=1/8秒）
（4）计算32位定点数星时TT（TTH=TT0+THDT、TTS=TTS0+TSDT，TT等于两者之一：默认为TTH，当OBDH星时与TTS的差小于等于1秒且TTH与TTS之差大于8秒选择为TTS或当8254出现故障，软时钟与OBDH的时间比较接近时，采用软时钟TTS）和40位定点数星时TT40（TT040+THDT40 ）
（5）AOCC要将接收到的OBDH时间与AOCC中当前时间TT进行比对，如果相差8秒以上应申请OBDH立即重新校时一次。如果再次相差8秒则校时有效。
（6）将TT转换为如下格式的48位遥测时间并通过OBDH遥测下传：
47||     |0
秒（32位）|毫秒（16位）|秒（32位）|毫秒（16位）

（7）接收OBDH注入的轨道数据块、中继卫星轨道数据块、轨控命令块、帆板命令块中时间（40位定点数，最小码位当量为秒）。根据用户需求用TT40和这些时间进行运算。
（8）接收OBDH每4s向AOCC发送一次GPS定位数据，根据用户需求用TT40和其中的40位定点数，当量为秒的GPS时间进行运算。
（9）接收OBDH的中继快扫到位指令，记中继快扫到位指令中的时间（格式为32位定点数，当量为1秒）。将TT转换为当量为1秒的时间和这个时间进行计算。：
31||0
32位，最小码位当量为1秒|32位，最小码位当量为1秒|32位，最小码位当量为1秒

（10）接收OBDH的整星侧摆指令，将其中两字节相对时间（数据格式是16位无符号定点数，最小码当量1s）转换为24位浮点数并保存在DTM中。记录接收OBDH的整星侧摆指令的时间并保存在（32位定点数，LSB=1/8秒）
整星侧摆指令中的时间格式为：
15||0
16位，最小码位当量为1秒|16位，最小码位当量为1秒|16位，最小码位当量为1秒

（11）将TT转换为36位定点数，LSB=1/128秒的数据格式并保存在QT36中。
（12）将星敏取数返回数据中的相对时间（16位有符号数，码当量1ms，最高位为符号位，负数用补码表示）和校时时刻TT-STSA、TT-STSB、TT-STSC（三个时间格式为精度高于秒的时间）进行运算，将结果转换为32位浮点数并保存在t星A、t星B、t星C中。
（13）校时
定时校时，即OBDH每10分钟向AO发送一次校时指令；
当软钟与OBDH时间差大于8秒，则重新申请一次校时；如果还大于8秒，接授OBDH时间；
当AO发生复位和切机后需要重新校时；
如果计算机软件直接通过非屏蔽软件有系统软件引导到应用软件，也需要校时。",0,0,0,0,0,1,0,0
"功能描述：与星敏感器通信，获得星敏感器数据。
处理：
见星敏通信协议、任务书。
功能编号|功能|引用文档
FREQ57|初始化|星敏协议
FREQ58|星敏使用要求|任务书
FREQ59|通信|星敏协议
FREQ60|通信故障处理|任务书
FREQ61|数据解包与转换|星敏协议
FREQ62|星敏数据有效性判断、处理|任务书
FREQ63|星敏模拟量采集、处理|任务书
FREQ64|部件在轨转发（在轨修改）|任务书

3）GPS高精度校时与星敏感器数据的使用
功能描述：根据GPS秒脉冲，秒脉冲广播，进行GPS高精度校时和星敏感器时标处理。",0,0,0,0,0,1,0,0
"功能描述：以1s为采样周期，计算角速度。。
",0,1,0,0,0,0,0,0
"功能描述：复位取不到重要数据的陀螺引入状态初始化
处理：
复位未取回|采集电源模拟量|大于2.5V的认为引入|若引入陀螺不小于3|补发加电指令
复位未取回|采集电源模拟量|大于2.5V的认为引入|否则(小于3)|按序号补齐3个，发加电指令，10分钟后引入
",1,0,0,0,0,0,0,0
"功能描述：星上自主检测推进系统故障。
",0,1,0,0,0,0,0,0
"功能描述：对星敏感器输出数据进行有效性判断。
输入：STSFailureDiagPermFlag, ZT6，星敏1 输出四元数，
星敏2输出四元数，星敏3输出四元数，预估四元数
t， t星A，t星B ，t星C ,  tmdts ,ZAR , ZBO Z , ZCR Z ,  ms ,  ms1 ,  ms2 ， ms3。
输出：ZA，XA，ZB，XB，ZC，XC，
星敏感器参与定姿标志FSTA，FSTB，FSTC，FSTD 。",0,1,0,0,0,0,0,0
"功能描述：根据上行注入指定工作模式和星上自主模式切换的条件进行模式管理。
处理：
工作模式的转换可分为以下两种情况：
按《用户需求》给定的条件判别，由应用软件自主控制转换；
由地面注入的模式运行类指令强行执行。
在模式切换中以地面上行注入优先，所有模式都可以通过地面注入的模式运行类指令进行转换。下面主要分析自主转换换条件与过程，具体转换条件见用户需求4.1~4.11的模式转换条件。4.4姿态机动模式喷气机动转对地或保持的条件中姿态角控制量判据中由0.000262mΦM4改为0.0262mΦM4。    ",0,1,0,0,0,0,0,0
功能描述：搜索太阳，直到数字太阳敏感器有太阳信息。,0,1,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|轨道与星历|FREQ2.0|5.1.1|卫星轨道、太阳星历、地面站位置、地磁场强度等计算程序的主流程。
|卫星轨道计算|FREQ2.1|5.1.2|计算卫星当前轨道
|GPS轨道数据有效性判断|FREQ2.2|5.1.3|对GPS轨道数据的有效性进行判断
|GPS轨道版轨道计算|FREQ2.3|5.1.4|利用GPS轨道版数据进行GPS定轨程序
|轨道、目标姿态预计算|FREQ2.4|5.1|完成控制周期的轨道星历与目标姿态预先计算
|近圆中低轨卫星轨道根数外推算法产品规范|FREQ2.5|/|规范化算法：
|近圆中低轨卫星GPS轨道计算算法算法产品规范|FREQ2.6|/|规范化算法：
|岁差章动矩阵计算算法算法产品规范|FREQ2.7|/|规范化算法：
|4阶星上地磁场计算方法算法产品规范|FREQ2.8|/|规范化算法：
|光行差计算算法产品规范|FREQ2.9|/|规范化算法：
",0,1,0,0,0,0,0,0
功能描述：偏航捕获模式初始化                                                                                                                                                                                处理：第i项当用星敏捕获时置SMODE =1改为SMODE =0。,0,1,0,0,0,0,0,0
"功能描述：计算给控制器的姿态和角速度误差。
",0,1,0,0,0,0,0,0
"    各个模式切换的功能点列表如下：
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ5.1.0|4|主动段模式切换条件判断及转出设置
|入轨段控制模式切换|FREQ5.1.1|4.1|入轨段控制模式切换条件判断及转出设置
|正常对地运行模式切换|FREQ5.1.2|4.2|正常对地运行模式切换条件判断及转出设置
|点对点机动模式切换|FREQ5.1.3|4.3|点对点机动模式切换条件判断及转出设置
|姿态/角速度预置模式切换|FREQ5.1.4|4.4|姿态/角速度预置模式切换条件判断及转出设置
|偏置飞行模式切换|FREQ5.1.5|4.5|偏置飞行模式切换条件判断及转出设置
|匀地速跟踪模式切换|FREQ5.1.6|4.6|匀地速跟踪模式切换条件判断及转出设置
|角速度跟踪模式切换|FREQ5.1.7|4.7|角速度跟踪模式切换条件判断及转出设置
|轨控模式切换|FREQ5.1.8|4.9|轨控模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ5.1.9|4.10|全姿态捕获模式切换条件判断及转出设置
|无控模式切换|FREQ5.1.10|4.11|无控模式切换条件判断及转出设置
|测试与标定模式切换|FREQ5.1.11|4.8|测试与标定模式切换条件判断及转出设置

切换条件具体见用户需求4。CCU切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,1,0,0,0,0,0,0
功能描述：卫星绕y轴转动，使红外搜索地球。,0,1,0,0,0,0,0,0
"功能描述：三轴喷气姿态控制。
",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|ACU模拟量数据的采集与处理|FREQ1.8.1|""ACU 1553B模拟量数据采集指令
""|模拟量|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
|ACU状态数据的采集与处理|FREQ1.8.2|""ACU 1553B各种状态数据采集指令
""|部件状态、双组元推进状态1、推进状态2、ACU工作状态|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
|ACU中控制指令的输出处理|FREQ1.8.3|计算得到的喷气脉宽、磁力矩器电压|控制指令消息的输出|根据通讯协议，将计算得到的喷气和磁力矩器数据转换为消息需要的格式并输出。
|部件加断电指令的处理|FREQ1.8.4|需要发送的加断电指令|加断电指令消息的输出|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|ACU保存CCU的重要数据|FREQ1.8.5|保存CCU的重要数据|接收CCU的重要数据|AOCC每个控制周期都将重要数据发送给ACU（驱动控制单元）
|从ACU恢复CCU的重要数据|FREQ1.8.6|恢复CCU重要数据|发送的CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
|ACU的程序注入修改|FREQ1.8.7|从OBDH收到的ACU需修改程序内容|ACU需修改程序内容|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
|ACU的内存下传|FREQ1.8.8|从OBDH收到的ACU内存下传设置指令|内存下传设置指令|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
|自锁阀操作|FREQ1.8.9||自锁阀操作指令|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令
",0,0,0,0,0,1,0,0
"功能描述：遥测数据打包
处理： 
序号|功能点编号|功能描述
|FREQ4.2.1|四器巡航模式
|FREQ4.2.2|四器变轨模式
|FREQ4.2.3|组合体分离模式
|FREQ4.2.4|着上巡航模式
|FREQ4.2.5|着上轨控模式
|FREQ4.2.6|着上下降模式
|FREQ4.2.7|月面工作模式
|FREQ4.2.8|上升准备模式
|FREQ4.2.9|上升器巡航模式
|FREQ4.2.10|上升器轨控模式
",0,0,0,0,0,0,0,1
"功能描述：选择通讯的帆板LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）帆板共有四个LTU，各有两个互为备份的LTU，通过每个LTU均可获得对应的帆板转角和零位信息；每个控制周期根据BAPTALTUSeltFlag确定进行通讯的帆板LTU，发送取数指令，具体如下表所示：
BAPTALTUSeltFlag|进行通讯的帆板LTU|发送的取数指令
01H|帆板LTU1、2的主份|B3H
02H|帆板LTU1的备份、帆板LTU2的主份|B3H
03H|帆板LTU1的主份、帆板LTU2的备份|B3H
04H|帆板LTU1的备份、帆板LTU2的备份|B3H
其它|根据LTU故障诊断的结果决定帆板LTU的选取。初始状态为帆板LTU1|B3H

（2）向太阳LTU发完取数命令后，获得太阳LTU返回的个字节数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式，在控制周期任务后根据帆板控制算法算出需要发送的帆板控制指令。AOCC发送的帆板控制指令包括：定角保持命令、帆板正向捕获命令、帆板正向跟踪命令、帆板反向捕获命令、帆板反向跟踪命令、角度保持命令和帆板归零命令。为了提高太阳帆板驱动机构的驱动稳定度，帆板驱动机构控制增加了步进电机相电流修正方法，控制计算机应用软件需要根据注入文件标志LBaptaCurCtrlMode和RBaptaCurCtrlMode的要求在相关控制指令中指定使用所要求的修正表格。。为保证帆板LTU线路归零指令的成功执行，要求应用软件连续3个周期对帆板LTU线路发送归零指令。",0,0,0,0,0,1,0,0
"包括下表的功能点。
序号|功能描述|功能编号
|向ICU发送控制计算机重要数据|FREQ7.6.1
|向OBDH发送控制计算机重要数据|FREQ7.6.2

发送控制计算机重要数据的具体要求见重要数据文件。",0,0,0,0,0,0,0,1
功能描述：：检测工作中的动量轮的故障并设置BZ3。,0,1,0,0,0,0,0,0
"功能描述：部件加电标志。与光纤陀螺通信功能。
处理：
见陀螺通信协议、任务书附录1时序。
功能编号|功能|引用文档|备注
FREQ33|陀螺接口初始化|陀螺协议|B
FREQ34|陀螺数据采集|陀螺协议|A
FREQ35|数据解包与转换|陀螺协议|A
FREQ36|陀螺数据有效性判断、处理|任务书|A
FREQ37|陀螺故障重构|任务书|C
",0,0,0,0,0,1,0,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ3.1|5.2.1|把陀螺数据、、、变换到星体系中的、、
|陀螺预估惯性姿态|FREQ3.2|5.2.2|根据陀螺输入，预估卫星惯性姿态
|陀螺预估对地姿态|FREQ3.3|5.2.3|根据陀螺测量输出，一步预估卫星姿态
|陀螺预估惯性四元数|FREQ3.4|5.2.4|根据陀螺测量输出，一步预估卫星惯性姿态
|动力学预估惯性四元数|FREQ3.5|5.2.5|根据动力学模型，预估卫星惯性姿态
|基于红外滤波的卫星姿态确定|FREQ3.6|5.2.6|根据陀螺预估结果和红外(和数字太阳)输出，确定卫星姿态
|星敏感器与陀螺姿态修正|FREQ3.7|5.2.7|利用星敏感器和陀螺的输出或仅利用陀螺预估输出计算卫星欧拉角和四元数
|单星敏感器的姿态修正|FREQ3.7.1|5.2.7.1|利用单个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|双星敏感器的姿态修正|FREQ3.7.2|5.2.7.2|利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|对地姿态修正|FREQ3.7.3|5.2.7.3|利用估计的四元数转换姿态角
|星敏感器与动力学姿态修正|FREQ3.8|5.2.8|利用星敏感器的输出计算卫星欧拉角和四元数
|仅单星敏感器的姿态修正|FREQ3.8.1|5.2.8.1|仅利用单个星敏感器的测量，修正姿态四元数与姿态角速度
|仅双星敏感器的姿态修正|FREQ3.8.2|5.2.8.2|仅利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|无陀螺对地姿态修正|FREQ3.8.3|5.2.8.3|利用估计的四元数转换姿态角，送给星敏感器的四元数
|红外与太阳双矢量定姿|FREQ3.9|5.2.9|利用红外、数字太阳敏感器确定姿态
|星敏感器相对基准标定|FREQ3.10|5.2.10|对星敏的相对基准进行标定，修正星敏安装矩阵
|星敏感器双矢量姿态确定|FREQ3.11.1|5.2.11.1|利用星敏的测量，确定单点的卫星姿态四元数。
|星敏姿态四元数重置|FREQ3.11.2|5.2.11.2|进行卫星姿态四元数的重置
|三轴欧拉姿态角预估算法产品规范|FREQ3.1.1|/|规范化算法：
|姿态四元数预估算法产品规范|FREQ3.1.2|/|规范化算法：
|重力梯度力矩计算算法产品规范|FREQ3.1.3|/|规范化算法：
|基于红外测量的红外滤波修正算法产品规范|FREQ3.1.4|/|规范化算法：
|基于单星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.5|/|规范化算法：
|基于双星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.6|/|规范化算法：
|基于红外与太阳矢量的双矢量定姿算法产品规范|FREQ3.1.7|/|规范化算法：
|星敏感器相对基准的在轨标定算法产品规范|FREQ3.1.8|/|规范化算法：
|目标姿态计算流程|FREQ3.12|5.3.1|""计算模式的目标姿态
""
|点对点机动目标姿态计算|FREQ3.12.1|5.3.1.1|点对点机动目标姿态计算
|轨控目标姿态计算|FREQ3.12.2|5.3.1.2|轨控目标姿态计算
|姿态机动初始化|FREQ3.12.3|5.3.2|三轴姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉轴/角，以及轨迹的加速，匀速和减速等特征时间点。
|""理论偏流角计算
""|FREQ3.12.4.1|5.3.3.1|""适用于地球椭球模型，基于星体姿态描述为1-2-3 转序计算基于星体+Z 轴或基于指定基准轴（该轴应在XOZ 平面内）情况下的偏流角。
""
|偏流角平滑及偏流角速度计算|FREQ3.12.4.2|5.3.3.2|对偏流角修正启动与停止过程中的偏流角进行平滑处理，并计算偏流角速度。
|太阳高度角计算|FREQ3.12.4.3|5.3.3.3|根据偏流角修正基准计算太阳高度角
|姿态控制量计算|FREQ3.19|5.2.12|根据姿态确定结果和目标姿态计算结果计算误差姿态角和误差姿态角速度
|引入系统闭环姿态确定|FREQ3.20|5.2.13|根据定姿标志确定引入系统的闭环姿态
|陀螺标定过程目标姿态计算|FREQ3.25.0|5.11.1|陀螺标定全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角
|目标姿态计算初始化|FREQ3.25.1|5.11.1.1|对陀螺标定过程中涉及到的两次机动过程进行机动姿态计算的初始化
|惯性姿态点对点机动轨迹规划|FREQ3.25.2|5.11.1.2|对陀螺标定过程所涉及到的两次点对点机动进行轨迹规划
|角速度起速保持与减速过程轨迹规划|FREQ3.25.3|5.11.1.3|对陀螺标定过程中的速度运行进行轨迹规划
|惯性定向时转阶段处理|FREQ3.25.5|5.11.1.5|陀螺标定在第1段中完成惯性定向，并在此期间标定陀螺真实常漂。在惯性定向转速度运行结束时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等。
|速度运行时转阶段处理|FREQ3.25.6|5.11.1.6|SubMode= 2~9，陀螺按照规定的角速度完成起速、恒速运行、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等
|速度曲线规划|FREQ3.25.7|5.11.1.7|根据所选择的机动轨迹，规划出角速度变化曲线
|陀螺标定算法|FREQ3.26.0|5.11.2|在标定过程中，对各个阶段的陀螺等效常漂进行估计
|陀螺常漂修正标志确定|FREQ3.26.1|5.11.2.1|对陀螺标定过程中，陀螺常漂的修正标志进行确定。当星体达到了规定的惯性角速度时，开始进行陀螺常漂估计
|基于星敏陀螺滤波的等效常漂估计|FREQ3.26.2|5.11.2.2|采用星敏陀螺滤波的方法对陀螺等效常漂进行估计
|星敏陀螺滤波的陀螺等效常漂记录|FREQ3.26.3|5.11.2.3|对陀螺等效常漂，选取稳态时的一段数据进行平均，得到各个角速度下的等效常漂和星体真实角速度的估计值
|小角速度时的陀螺安装误差和刻度因子误差估计|FREQ3.26.4|5.11.2.4|经过N次速度机动后，对陀螺的测量模型进行标定，给出标定结果
|陀螺在轨标定时的控制量计算|FREQ3.27|5.11.3|对标定过程中的控制量进行计算
|陀螺安装误差标校结果引入|FREQ3.28|5.11.4|对陀螺完成标定后，待地面确认标定结果无误后，将陀螺的标定结果进行赋值。当地面注入FP__MountingCmp时执行本程序一次
|惯性姿态预处理初始化|FREQ3.29.1.1|5.12.1.1|计算惯性定向及扫描的机动参数
|相机扫描速度建立参数计算|FREQ3.29.1.2|5.12.1.2|计算由建立扫描速度初始姿态到建立恒定速度的时间，以及扫描结束后星体静止后的惯性姿态。
|星体阻尼结束至惯性定向姿态建立参数计算|FREQ3.29.1.3|5.12.1.3|计算星体阻尼结束后的姿态调整到凝视标定的惯性定向姿态，或天区扫描速度建立前所需初始惯性姿态
|惯性目标姿态计算|FREQ3.29.2.0|5.12.2|全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角。
|惯性定向轨迹规划|FREQ3.29.2.1|5.12.2.1|对惯性再定向过程进行轨迹规划
|惯性定向转阶段处理|FREQ3.29.2.2|5.12.2.2|惯性再定向转换处理
|惯性空间扫描轨迹规划|FREQ3.29.2.3|5.12.2.3|对惯性空间扫描过程进行轨迹规划
|惯性扫描转阶段处理|FREQ3.29.2.4|5.12.2.4|SubMode = 2，按照规定的角速度完成角速度的建立、恒速扫描、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化
|目标姿态计算初始化|FREQ3.29.2.5|5.12.2.5|对SubMode=1/10子模式进行机动姿态计算的初始化
|惯性定向姿态控制量计算|FREQ3.29.3|5.12.3|对惯性定向过程中的控制量进行计算
|星敏感器的粗姿态计算|FREQ3.30|5.2.14|计算提供给星敏感器的粗姿态
",0,1,0,0,0,0,0,0
"功能描述：根据红外信息进行姿态滤波修正。
",0,1,0,0,0,0,0,0
功能描述：太阳数据处理,0,0,0,0,0,1,0,0
功能描述：帆板驱动机构切换。,0,0,1,0,0,0,0,0
"功能描述：选择通讯的陀螺LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）陀螺数据采集在BZ8=5（轨控模式轨控期间、帆板未展开模式和全姿态捕获模式太阳捕获期间）的采样周期为0.262秒，其余模式的采样周期为0.524秒。
（2）陀螺共有三个互为备份的LTU，通过每个LTU均可获得六个陀螺的数据；AOCC向陀螺LTU发送取数命令1和取数命令2来获得数据，其中取数命令1有两个字节，取数命令2有一个字节；只有取数命令1通讯不成功时才发取数命令2。AOCC根据ZT14（4）（3）来确定和哪个LTU进行通讯，同时确定通道选择号和取数命令1和取数命令2的第一个字节。 
ZT14(4)(3)的值|进行通讯的陀螺LTU|取数命令1和命令2
01|陀螺LTU1|53H和5CH
10|陀螺LTU2|63H和6CH
11|陀螺LTU3|73H和7CH
00|根据LTU故障诊断的结果决定陀螺LTU的选取。初始状态为陀螺LTU1|53H（或63H或73H）和5CH（或6CH或7CH）

（3）AOCC根据ZT15、ZT16确定要采集哪几个陀螺的数据（加电的陀螺），即决定取数命令1中的第二个字节（工作陀螺编码字节）的低6位，。ZT15、ZT16与第二个字节的对应关系如下：
取数命令1的第二个字节
D0
ZT15（1）

（4）将陀螺LTU返回的数据根据LTU通讯协议中的计算公式转换为陀螺的角度增量（弧度）。根据ZT46、ZT47确定当前引入陀螺。
（5）陀螺LTU数据采集过程中的故障处理见本文的.1。",0,0,0,0,0,1,0,0
功能描述：使用GPS通道版数据进行GPS定轨。,0,1,0,0,0,0,0,0
"软件需求名称：接收广播 
需求类别：其他 
软件需求描述：接收并处理广播指令。",0,0,0,0,0,0,1,0
功能描述：J2000年地心赤道惯性系中的速度增量计算,0,1,0,0,0,0,0,0
"通讯串口
04H|波特率寄存器|RW|""波特率寄存器低位：0x04（115200）
0x18（19200）""
08H|波特率寄存器|RW|波特率寄存器高位：0x00
CAN总线初始化
寄存器名称|初始化内容|初始化意义
""CAN_ADDR        
(CAN总线地址)""|无。|无说明。
""控制寄存器
(Control Register)
""|0x07|""D7D6D5：保留。
D4：超载（接收设备不能按数据发送速率接收数据而造成的数据丢失）中断使能。
高：开放。低：禁止
D3：错误中断使能。
高：开放。低：禁止
D2：发送中断使能。
高：开放。低：禁止
D1：接收中断使能。
高：开放。低：禁止
D0：复位模式。
在初始化的时候，复位模式位置1，才可以进行初始化设置。""
命令寄存器(Command register)|0x=00001100|""D7D6D5：保留。必须。
D4：进入睡眠状态。
高：睡眠 。低：睡眠唤醒。
D3：清除超载状态。不产生超载中断。
高：清除。低：无动作。
D2：释放接收缓冲器。（读接收缓存器内容后，释放缓存器，以便其他报文立即可用）。
高：释放。低：无动作。
D1：夭折发送。
D0：发送请求。
高：报文即将发送。低：无动作。""
""验收代码寄存器
(Acceptance 
Code Register)""|0xa7=10100111|""当通过验收测试的报文被接收，且若存在空的接收缓存器，则各自的描述符和数据场被顺序存贮在空的缓存器中，在不存在空的接收缓存器的情况下，数据超载位被置位高(超载)，当完整的报文被正确接收，将出现下列操作：
接收缓存器状态位被置为高(满)
若接收中断开放位被置为高(开放)，接收中断被置为高(置位)
验收码位(AC.7~AC.0)和报文标识符的最高8位(ID.10~ID.3)必须等于由验收屏蔽位必须满足""
""验收屏蔽寄存器
((Acceptance 
Mask Register))""|0xf8|最后三位相关。
总线时序寄存器0(Bus Timing Register 0)|0x00|""总线时序寄存器的内容决定波特率预分频器(BRP)和同步跳转宽度(SJW)的数值。

通过总线定时器的内容，将波特率预分频器设置为2，即将输入的系统时钟二分频，由于输入的系统时钟已经是将计算机晶体频率14.7456MHz二分频，即7.3728MHz。所以这个时候时钟为3.6864 MHz。""
总线时序寄存器1(Bus Timing Register 1)|0x18|""采样（SAM）=1总线采样1次。
TSEG1和TSEG2确定每位周期的时钟周期数目和采样点位置：

由于一位周期是由

而

波特率＝""
""时钟分频器
(Clock Divider
register)""|0x40|""D7:CAN模式。
0：基本模式。
D5:1(旁路输入比较器，仅在复位模式下起作用)。""
""OCR
(output Control)""|0x|

在完成上述初始化后，要再次初始化控制寄存器。将最低位初始化为0。",1,0,0,0,0,0,0,0
"功能描述：对动量轮的角动量进行调整。
",0,1,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的星敏间基准修正与有效性判断修正系数,0,0,0,0,0,0,1,0
"功能描述：接收AOCC系统注入参数
处理：
当收到接收遥控注入结束标识消息后，将接收AOCC系统注入参数存储地址中内容解包成对应的参数和变量的数据格式。只有当某个块类型的所有数据都收到，且每块数据的校验和都正确时，才能使用此种类型的注入数据。注入的数据具体见上行注入文件。需要注意的是：地面注入ZT9时：若ZT9中为1的个数小于3个，则不改变星上ZT9的取值；应用软件不响应ZT1=2、ZT1=6、ZT1=8的注入指令。",0,0,0,0,0,0,1,0
功能描述：根据给定电压乘电压/力矩系数和角动量变化率之差判断轮子的故障。,0,1,0,0,0,0,0,0
"功能描述：把陀螺数据测量值变换为星体三轴角速度。
",0,1,0,0,0,0,0,0
"功能描述：接收星箭分离信号及天线状态数据
处理：控制计算机在收到星箭分离指令并且判断数据正确后，即认为星箭分离有效，通过方式代码的服务请求，申请OBDH停止发送星箭分离信号。天线状态的数据具体见与外总线通讯协议。",0,0,0,0,0,0,1,0
功能描述：由数字太阳粗码得到数字太阳角、全开码、见太阳标志。,0,0,0,0,0,1,0,0
"功能描述：根据陀螺输入，予估卫星对地姿态。
",0,0,0,0,1,0,0,0
"功能描述：为动量轮启动与保持模式姿态确定提供初始姿态。
",0,1,0,0,0,0,0,0
"功能描述：三轴稳定模式下的帆板控制。
",0,1,0,0,0,0,0,0
功能描述：发送星敏感器数据包,0,0,0,0,0,0,0,1
在载荷成像时，OBDH向AOCC索要辅助数据，包括姿态数据、陀螺数据、星敏感器数据，索要辅助数据的频率为1s。AOCC只有在辅助数据发出后，将辅助数据内容更新。,0,0,0,0,0,0,0,1
功能描述：发送模拟量遥测数据包1,0,0,0,0,0,0,0,1
"软件需求名称：模式初始化 
需求类别：其他 
软件需求描述：见“用户需求”4.1和“任务书”4.1.10“工作模式要求”1）工作模式初始化。 
表格工作项|软件需求标识|软件需求名称|
FREQ12.2-WMInit-1|太阳定向模式初始化|《用户需求》4.1.1【初始化】|
FREQ12.2-WMInit-2|恒星定向1模式初始化|《用户需求》4.1.2【初始化】|
FREQ12.2-WMInit-3|惯性调姿模式初始化|《用户需求》4.1.3【初始化】|
FREQ12.2-WMInit-4|恒星定向2模式初始化|《用户需求》4.1.4【初始化】|
FREQ12.2-WMInit-5|轨控定向模式初始化|""《用户需求》4.1.5【初始化】
《任务书》4.1.10""|
FREQ12.2-WMInit-6|中继跟踪模式初始化|《用户需求》4.1.6【初始化】|
FREQ12.2-WMInit-7|速率阻尼模式初始化|《用户需求》4.1.7【初始化】|
FREQ12.2-WMInit-8|无控模式初始化|《用户需求》4.1.8【初始化】|
",0,1,0,0,0,0,0,0
"功能描述：计算CMG的框架角速度,。",0,1,0,0,0,0,0,0
功能：利用星敏感器A、B、C单独或组合定姿的方式，调用相应姿态修正程序。,0,1,0,0,0,0,0,0
"功能描述：与推进线路盒通信，输出本周期喷气脉宽。
处理：
见通信协议。
功能编号|功能|引用文档
FREQ85|初始化|任务书
FREQ86|推力器使用要求|任务书
FREQ87|通信|任务书
FREQ88|通信故障处理|预留
FREQ89|数据解包与转换|预留
FREQ90|推力器数据有效性处理|预留
FREQ91|推力器模拟量采集、处理|任务书
FREQ92|部件在轨转发（在轨修改）|预留
",0,0,1,0,0,0,0,0
功能描述：将GPS轨道确定参数转换成控制系统中太阳星历和地磁场计算所需的19个轨道参数,0,1,0,0,0,0,0,0
"功能描述：在完成对日定向后，。
输入：陀螺数据处理的输出 ，
太阳星历的输出，
数字太阳敏感器输出：, （量纲：弧度）
红外地球敏感器数据有效性标志F_IresValid（由数据有效性判据给出）
数字太阳敏感器数据有效性标志F_Ds1Valid，F_Ds2Valid（由数据有效性判据给出），
红外数据有效性输出 ，
",0,1,0,0,0,0,0,0
"功能描述：轨道与星历计算。
",0,1,0,0,0,0,0,0
"功能描述：使用红外、星敏、太阳定姿时，计算正常飞行轮控所需电压。
",0,1,0,0,0,0,0,0
功能描述：太阳全姿态捕获模式控制,0,1,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的结构滤波器系数
处理：
调整各系数的初装值。",0,0,0,0,0,0,1,0
当需要请求服务时，将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。,0,0,0,0,1,0,0,0
"功能描述：
 从1553B接收遥控指令数据，进行指令处理（FReq-7）。
处理：根据收到的遥控指令执行按照、ISUA、ISUC进行分类处理，实现指令的处理或者转发。
指令转发前，进行指令的校验，校验通过后，方可转发。指令子单元的分类标识全为立即指令。
指令校验的原则是：校验和、RT地址、RT子地址、指令总长度、注入指令单元的类型识别字、指令序号、注入指令子单元的子单元类型识别字、分类标识、长度均正确；
遥控指令包含三种类型，具体如下：
（1） 切换ISU-C模块指令
指令功能：用于向ISU-C发送切换模块指令。
类型标识字：C300H
指令码长度：216bit
指令码定义及说明：指令码高有效字在前，指令码低有效字在后。
ISU-C注入间接指令32位指令码定义
序号|指令名称|32位指令码
序号|指令名称|功能数据
序号|指令名称|D23～D0（16进制表示）
序号|指令名称|D11～D0
|SADP-A开|0X 000
|SADP-A关|0X 001
|SADP-B开|0X 002
|SADP-B关|0X 003
|MTP-A开|0X 004
|MTP-A关|0X 005
|MTP-B开|0X 006
|MTP-B关|0X 007
|MPSDP-A接A份电源|0X 008
|MPSDP-A接B份电源|0X 009
|MPSDP-B接A份电源|0X 00A
|MPSDP-B接B份电源|0X 00B
|MPSDP-A关|0X 00C
|MPSDP-B关|0X 00D
|LV1开|0X 00E
|LV1关|0X 00F
|LV2开|0X 010
|LV2关|0X 011
|ISU-A DC/DC1加电|0X 012
|ISU-A DC/DC1断电|0X 013
|ISU-A DC/DC2加电|0X 014
|ISU-A DC/DC2断电|0X 015
|ISU-A 主供电接DC/DC1备供电接DC/DC2|0X 016
|ISU-A 主供电接DC/DC2备供电接DC/DC1|0X 017
|ISU-A甲机复位|0X 018
|ISU-A乙机复位|0X 019

类别：01代表指令当量为16ms；10代表指令当量为64ms，MEO卫星指令类型全为01。
脉宽：指令实际脉冲宽度=（脉宽数值+1）*指令当量；
MEO卫星离散开关指令脉冲宽度默认为7（128ms）；指令宽度可随实际需要更改。
指令码高有效字对应上表D31~D16；指令码低有效字对应上表D15~D0。
（2） 切换控制部件指令
指令功能：用于向ISU-A发送切换控制部件指令。
类型标识字：C311H
指令码长度：116bit
指令码定义及说明：
定义
D7~D0
指令码

此指令专门用于CMU应用软件转发的开关控制分系统部件的时标指令。文中的8位指令码定义如下：
表4-8 ISU-A注入间接指令码列表
序号|指令名称|指令码
|地球敏感器A开|0x 50
|地球敏感器A关|0x 4F
|地球敏感器B开|0x 52
|地球敏感器B关|0x 51
|Z2陀螺开|0x 31
|Z2陀螺关|0x 32
|Z3陀螺开|0x 33
|Z3陀螺关|0x 34
|GX电源开|0x 35
|GX电源关|0x 36
|GY电源开|0x 37
|GY电源关|0x 38
|GZ电源开|0x 39
|GZ电源关|0x 3A
|GS电源开|0x 3B
|GS电源关|0x 3C
|反作用轮A开|0x 2E
|反作用轮A关|0x 2F
|反作用轮B开|0x 49
|反作用轮B关|0x 4A
|反作用轮C开|0x 4B
|反作用轮C关|0x 4C
|反作用轮D开|0x 4D
|反作用轮D关|0x 4E
|ISU-C 驱动线路主份电源开|0x 67
|ISU-C 驱动线路主份电源关|0x 68
|ISU-C 驱动线路备份电源开|0x 61
|ISU-C 驱动线路备份电源关|0x 62
|ISU-C CIP主份线路电源开|0x 65
|ISU-C CIP主份线路电源关|0x 66
|ISU-C CIP备份线路电源开|0x 63
|ISU-C CIP备份线路电源关|0x 64
|CMU SPE-A开|0x 57
|CMU SPE-A关|0x 58
|CMU SPE-B开|0x 59
|CMU SPE-B关|0x 5A

说明：此36条指令脉宽均为128ms，脉宽由ISUA保证。
（3） 控制模式转换指令
指令功能：此指令用于控制模式转换。
类型标识字：C322H
指令码长度：116
指令码定义及说明：
指令码|定义
方式字|定义
00H|捕获模式——速率阻尼方式
04H|停控模式

（4） 5N推力器健康状态设置指令
指令功能：设置5N推力器健康状态
类型标识字：C333H
指令码长度：216
指令码定义及说明：
推力器健康状态设置高16位D31~D16在前，
推力器健康状态设置低16位D15~D0在后。
D31~ D0定义如下：
D31|D30|D29|D28|D27|D26|D25|D24
0|0|0|0|0|0|0|0
D23|D22|D21|D20|D19|D18|D17|D16
0|0|JK-6A|JK-5A|JK-4A|JK-3A|JK-2A|JK-1A
D15|D14|D13|D12|D11|D10|D9|D8
0|0|0|0|0|0|0|0
D7|D6|D5|D4|D3|D2|D1|D0
0|0|JK-6B|JK-5B|JK-4B|JK-3B|JK-2B|JK-1B

注：健康标志位为0表示对应推力器健康，健康标志位为1表示对应推力器不健康。将推力器设置为健康，可以使其上线；将推力器设为不健康，可以使其离线。推力器上线后方可被开启，推力器离线后不能被开启。当接收到此指令时，须同时把上述信息以MPS配置信息的形式发送给ISU-C（通过DPRU转发）。
（5） 控制部件健康字设置指令
指令功能：更改部件健康字
类型标识字：C344H
指令码长度：216
指令码定义及说明： 设置状态在前，部件标识在后。
设置状态：取值为0x0000时设置为健康，取值为0x5A5A时设置为不健康；
部件名称及标识见下表分配值：特别当编号为0xFFFF时，表示选择下表所有部件。例如，当设置状态为0x0000，部件编号为0xFFFF时，设置下表所有部件健康。
序号|部件名称|标识|部件编号
1|X陀螺|GA-X|0x0101
2|Y陀螺|GA-Y|0x0202 
3|Z陀螺|GA-Z|0x0303 
4|S陀螺|GA-S|0x0404 
5|喷气控制线路主份|MPSDP-A|0x0707 
6|喷气控制线路备份|MPSDP-B|0x0808 

(6) 控制标志字设置指令
指令功能：设置部件或者控制标志字	
类型标识字：C355H
指令码长度：216
指令码定义及说明： 
标志字识别码在前，标志字指令内容在后。
更改的标志字的内容16位二进制码，具体内容定义：
序号|标志字识别码|指令内容定义|对应符号
标志字1|0x0101|""0：S陀螺顶替X陀螺；
1：S陀螺顶替Y陀螺；  
2：S陀螺顶替Z陀螺；
3：禁止顶替。""|
标志字2|0x0202|""0：A分支推力器工作；
1：B分支推力器工作；  
2：双分支推力器工作。""|
标志字3|0x0303|""0：不允许推力器故障判断；
A：允许推力器故障判断。""|
标志字4|0x0404|""0：不允许二浮陀螺故障判断；
A：允许二浮陀螺故障判断。""|
标志字5|0x0505|""0：设置推力器未发生切换；
A：设置推力器已发生切换。""|任务书中推力器故障诊断中的 flgSwitch
",0,0,0,1,0,0,0,0
"功能编号：FREQ42
功能描述：为三轴姿态喷气控制选择喷管；并记录喷气时间等。
",0,1,0,0,0,0,0,0
"功能描述：选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输出：数字太阳敏感器输出；模拟太阳敏感器输出；模拟式太阳敏感器视场码；0-1式太阳敏感器的信号（0或1）；数字太阳敏感器视场码。
处理：
（1）太阳共有两个互为备份的LTU，通过每个LTU均可获得数字太阳、模拟太阳、0-1太阳数据；每个控制周期根据DSSLTUSeltFlag确定进行通讯的太阳LTU，发送取数指令，具体如下表所示：
DSSLTUSeltFlag |进行通讯的太阳LTU|发送的取数指令
01H|太阳LTU1|43H
02H|太阳LTU2|43H
其它|根据LTU故障诊断的结果决定太阳LTU的选取。初始状态为太阳LTU1|43H

（2）向太阳LTU发完取数命令后，获得太阳LTU返回的个字节数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式，具体参见LTU通讯协议件。
（3）太阳LTU数据采集过程中的故障处理见4.4.3中规定。",0,0,0,0,0,1,0,0
"功能描述：星上实时计算追踪器轨道
",0,1,0,0,0,0,0,0
功能描述：模拟太阳故障状态。,0,1,0,0,0,0,0,0
"功能描述：姿态机动模式控制
",0,1,0,0,0,0,0,0
"功能描述：偏航通道喷气中断处理程序。
处理：将推力器9、10、11、12关掉",0,0,1,0,0,0,0,0
功能描述：帆板故障检测，切换帆板LTU。,0,1,0,0,0,0,0,0
"功能描述：启动动量轮至标称角动量，并保持。
",0,1,0,0,0,0,0,0
"功能描述：光纤陀螺、星敏及一体化红外通讯状态设置指令
",0,0,0,0,0,1,0,0
"功能描述：当收到“停控”数据指令或满足自主进入停控模式的条件时，应用软件进入停控模式。
处理
关闭自锁阀1、2；
与ALTU继续通信，进行轨道与环境计算、采集信息，不进行定姿与控制，输出磁力矩器、推力器控制量为0，发送CMG1~5复位及高速断电指令；之后发送CMG无效0指令。
停止对天线控制计算、通信。",0,1,0,0,0,0,0,0
"功能描述：接收时间码
处理： OBDH分系统每1分钟给控制计算机校时一次。",0,0,0,0,1,0,0,0
"功能描述：根据红外信息绕滚动俯仰转动，进行滚动俯仰捕获
",0,1,0,0,0,0,0,0
"功能描述：根据指令完成数传天线的指向控制。
输入：数传天线j (j=1,2)，预置指令，跟踪开始指令，跟踪结束指令，地面站i在惯性系指向，被数传天线j(j=1,2)跟踪的地面站i指向卫星矢量，卫星指向被数传天线j(j=1,2)跟踪的地面站i的矢量在本体系的表示，数传天线收到的预置角度
输出：数传天线1和2的指令转角",0,1,0,0,0,0,0,0
"功能描述：仅利用星敏感器A的测量，修正姿态四元数与姿态角速度移。
",0,1,0,0,0,0,0,0
功能描述：为动量轮启动与保持模式姿态确定提供初始姿态。,0,1,0,0,0,0,0,0
"功能描述：1553B芯片初始化；
处理：
芯片复位，将1553B芯片的RAM区显式地清零，设置内存映射，将所用1553B寄存器显式地初始化，初始化1553B为RT模式。
其中子地址10、11为循环缓冲方式，其余子地址为单消息方式。
软件的1553B消息处理采用查询方式。",1,0,0,0,0,0,0,0
功能描述：若3000秒（全姿态捕获除速率阻尼外1000秒，可注入修改）内，三轴中任一轴喷气总量（正负轴单独判断）超过范围（正常模式50s，粗定向和轮子启动、全姿态捕获100s，可注入修改），则根据自锁阀状态，开关自锁阀。全姿态模式下,0,1,0,0,0,0,0,0
"功能描述：根据姿态角计算方向余弦阵
",0,0,0,1,0,0,0,0
"功能描述：由平衡方程方法、星敏感器数据进行陀螺的故障检测。
",0,1,0,0,0,0,0,0
"功能描述：接收AOCC重要数据
处理：将接收AOCC重要数据地址中内容解包成重要数据的数据格式。
在AOCC上电/复位或者切机时，AOCC通过方式代码的服务申请，请求OBDH发送星上时间和AOCC重要数据。若连续三个控制周期申请AOCC重要数据失败（重要数据第一块的第一个字不是A090H或者校验和错误或者未收到重要数据），则应用软件按照重要数据的初始值运行。",0,0,0,0,0,0,1,0
"功能描述：卫星绕俯仰轴转动，直到红外搜索到地球。
",0,1,0,0,0,0,0,0
"功能：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移。
输入：星敏感器B修正新息，四元数、陀螺常漂
输出：修正四元数、陀螺常漂
",0,1,0,0,0,0,0,0
"功能描述：滚动/俯仰姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉角，以及轨迹的加速、匀速和减速等特征时间点。
",0,1,0,0,0,0,0,0
"功能：利用星敏感器C的测量，修正姿态四元数与姿态角速度。
",0,1,0,0,0,0,0,0
"功能描述：计算速度增量关机喷气时间
",0,1,0,0,0,0,0,0
"功能描述：决定采用磁卸载还是喷气卸载方式，调用相应程序。
输入：姿态角，姿态角速度，
实测飞轮角动量   =[，]T
标称角动量       =[，]T
      标志             UnLoadMode， F_WheelSaturation， F_AttrOutLmt",0,1,0,0,0,0,0,0
功能描述：抖动帆板。,0,1,0,0,0,0,0,0
"功能描述：利用估计的四元数转换姿态角。
",0,1,0,0,0,0,0,0
"功能：利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移。
输入：星敏感器A、B修正新息，四元数、陀螺常漂
输出：修正四元数、陀螺常漂
",0,1,0,0,0,0,0,0
"功能描述：根据指令完成数传天线的指向控制。
输入：
数传天线(j=1,2)跟踪地面站编号i，跟踪起始时刻ti，地面站i在惯性系指向，被数传天线(j=1,2)跟踪的地面站i指向卫星矢量，卫星指向被数传天线(j=1,2)跟踪的地面站i的矢量在本体系的表示。（i可为1~7）。",0,1,0,0,0,0,0,0
功能描述：当滚动（俯仰）、偏航发动机计数器归零发出中断请求时关闭相应推力器。,0,0,1,0,0,0,0,0
"软件需求名称：推力器控制 
需求类别：其他 
软件需求描述：根据控制律计算结果，驱动推力器，进行姿态控制。",0,0,1,0,0,0,0,0
OBDH重要数据有两块，大小共为128字节，AOCC不做任何改动保存在RAM中。如果AOCC发生复位，应利用方式代码请求服务，索取OBDH重要数据进行保存。若在大于0.256s的时间内仍未收到接收OBDH重要数据的指令，则重新请求服务，同时索要OBDH重要数据的计数器累加，若此计数器大于等于40，则不再索要OBDH重要数据。若索要OBDH重要数据成功，将此计数器清零。,0,0,0,0,0,0,0,1
"软件需求标识：FREQ13 
软件需求名称：采集时序 
软件需求描述：
              不再要求“不论部件是否通讯，均进行延时计数。”",0,0,0,0,0,1,0,0
功能描述：计算磁卸载所需的磁矩与磁力矩器工作电压,0,1,0,0,0,0,0,0
功能描述：对二次电源使用、故障切换。,0,0,1,0,0,0,0,0
"功能描述：模式3切换方式。
处理：
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；
注：若地面指令转入对日定向运行模式或者太阳捕获模式，置CMGStartFlag=1。",0,1,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的地面站位置信息功能区数据,0,0,0,0,0,0,1,0
"功能描述：接收AOCC重要数据1-4，并处理重要数据1中的内容。
处理：应急线路加电后与OBDH通信，获得陀螺和推力器状态，若连续3个控制周期都没有成功取得重要数据，默认陀螺使用7、8、9号，推力器使用主备份推力器，模拟式太阳敏感器使用ASS1和ASS21。由于AOCC可使用的陀螺为12个（陀螺1~12），可使用的陀螺为9个（陀螺1~9），因此，无法使用陀螺10~12的数据。当恢复AOCC重要数据后，若ZT9表明使用了陀螺10~12，则设置ZT9中陀螺10~12为不可用，陀螺7、8、9为可用，陀螺工作状态BZ9按照设置后的ZT9中由小到大的顺序（从陀螺1到陀螺9）选用3个陀螺。",0,0,0,0,0,0,1,0
"功能描述：发送遥测数据
处理：
CTU从AOCC接收遥测数据后，向AOCC发送“当前”的实时遥测帧计数，AOCC随后组织“下一帧”62字节遥测数据并将数据放到相应的子地址（更新总线缓存）。数字量遥测数据格式内容具体见数字量遥测文件。",0,0,0,0,0,0,0,1
"功能描述：接收遥控固定参数注入块的陀螺脉冲当量系数
处理：
调整陀螺1~3的脉冲当量的初装值。",0,0,0,0,0,0,1,0
"功能描述：使星体由任意姿态完成重捕地球。
",0,1,0,0,0,0,0,0
"功能描述：选择通讯的红外LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）AOCC每两个0.524秒根据加断电控制字IR_PWR（设置原则见任务书的附录D），向加电的红外LTU发送取数命令（向红外LTU1发送13H，向红外LTU2发送23H），获得每个红外LTU返回的5个字节数据。
（2）将数据根据LTU通讯协议转换成（红外1的前沿到基准）、（红外2的前沿到基准），（红外1的前沿到后沿）、（红外2的前沿到后沿）。
（3）AOCC每两个0.524秒同时向两个红外LTU发自检命令，根据返回的自检信息确定红外1、2有无信号标志HL（1为有效，0为无效）和HR（1为有效，0为无效）。
（4）每31个0.524秒控制周期（约16秒），根据ZT31向红外LTU1和LTU2发送切换方案命令
ZT31(1)＝1，红外H1用主份；ZT31(1)＝0，红外H1用备份
ZT31(2)＝1，红外H2用主份；ZT31(2)＝0，红外H2用备份
ZT31(3)＝1，ZT31(4)＝0，ZT5＝1，红外H1加电
ZT31(3)＝0，ZT31(4)＝1，ZT5＝2，红外H2加电
其余情况下，红外H1、H2都加电
红外LTU数据采集过程中的故障处理见本文的5.2.9.3。",0,0,0,0,0,1,0,0
功能描述：入轨段控制,0,1,0,0,0,0,0,0
功能描述：对数字太阳有效性进行判断。,0,1,0,0,0,0,0,0
"功能描述：采集28路数字太阳粗码、细码。
处理：
采集方法：连续采集28路，采集1路的操作步骤（以DSS1的粗码1为例）：
向选通地址输出偏移地址：0x1200 0000 = 00H；
等待至少100µs,启动A/D转换：0x1200 0020 = 0；
等待至少40µs后；
连续3次读取A/D数据总线上的数据：data1 = 0x1200 0020 (data2，data3类似)；
取data1、data2、data3三个数据的中间值，作为本路模拟量的最终采集结果。",0,0,0,0,0,1,0,0
"功能描述：太阳地球捕获主程序。
",0,1,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ3.1|5.2.1|把陀螺数据、、、变换到星体系中的、、
|陀螺预估惯性姿态|FREQ3.2|5.2.2|根据陀螺输入，预估卫星惯性姿态
|陀螺预估惯性四元数|FREQ3.4|5.2.4|根据陀螺测量输出，一步预估卫星惯性姿态
|动力学预估惯性四元数|FREQ3.5|5.2.5|根据动力学模型，预估卫星惯性姿态
|星敏感器与陀螺姿态修正|FREQ3.7|5.2.7|利用星敏感器和陀螺的输出或仅利用陀螺预估输出计算卫星欧拉角和四元数
|单星敏感器的姿态修正|FREQ3.7.1|5.2.7.1|利用单个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|双星敏感器的姿态修正|FREQ3.7.2|5.2.7.2|利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|对地姿态修正|FREQ3.7.3|5.2.7.3|利用估计的四元数转换姿态角
|星敏感器与动力学姿态修正|FREQ3.8|5.2.8|利用星敏感器的输出计算卫星欧拉角和四元数
|仅单星敏感器的姿态修正|FREQ3.8.1|5.2.8.1|仅利用单个星敏感器的测量，修正姿态四元数与姿态角速度
|仅双星敏感器的姿态修正|FREQ3.8.2|5.2.8.2|仅利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|无陀螺对地姿态修正|FREQ3.8.3|5.2.8.3|利用估计的四元数转换姿态角，送给星敏感器的四元数
|星敏感器相对基准标定|FREQ3.10|5.2.11|对星敏的相对基准进行标定，修正星敏安装矩阵
|星敏感器双矢量姿态确定|FREQ3.11.1|5.2.14.1|利用星敏的测量，确定单点的卫星姿态四元数。
|星敏姿态四元数重置|FREQ3.11.2|5.2.14.2|进行卫星姿态四元数的重置
|姿态四元数预估算法产品规范|FREQ3.1.2|/|规范化算法：
|重力梯度力矩计算算法产品规范|FREQ3.1.3|/|规范化算法：
|基于单星敏感器测量矢量叉乘信息的滤波修正算法算法产品规范|FREQ3.1.5|/|规范化算法：
|基于双星敏感器测量矢量叉乘信息的滤波修正算法产品规范|FREQ3.1.6|/|规范化算法：
|星敏感器相对基准的在轨标定算法产品规范|FREQ3.1.8|/|规范化算法：
|目标姿态计算流程|FREQ3.12|5.3.2|""计算模式的目标姿态
""
|对地定向目标姿态计算|FREQ3.12.0|5.3.2.1|对地定向目标姿态计算
|点对点机动目标姿态计算|FREQ3.12.1|5.3.2.2|点对点机动目标姿态计算
|姿态预置过程目标姿态计算|FREQ3.12.3|5.3.2.3|姿态预置过程目标姿态计算
|非沿迹跟踪阶段目标姿态计算|FREQ3.12.4|5.3.2.4|角速度建立过程目标姿态计算
|轨控目标姿态计算|FREQ3.12.5|5.3.2.5|轨控目标姿态计算
|凝视过程目标姿态计算|FREQ3.12.6|5.3.2.6|凝视过程中计算三轴目标姿态
|正常对日巡航目标姿态计算|FREQ3.12.7|5.3.2.7|正常对日巡航目标姿态计算
|姿态机动初始化|FREQ3.13.1|5.3.1.1|三轴姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉轴/角，以及轨迹的加速，匀速和减速等特征时间点。
|非沿迹跟踪轨迹初始化|FREQ3.13.2|5.3.1.2|匀地速、匀角速度、匀积分时间非沿迹跟踪初始化，计算地心张角和方向矢量等
|轨控姿态机动轨迹初始化|FREQ3.13.4|5.3.1.4|轨控模式目标姿态计算初始化
|计算多项式轨迹系数|FREQ3.13.5|5.3.3.1|根据轨迹规划时间，初始姿态/姿态角速度和目标姿态/姿态角速度计算基于多项式轨迹规划的轨迹系数
|姿态预置机动目标姿态确定|FREQ3.13.6|5.3.3.2|基于多项式曲线的轨迹规划，计算目标姿态
|非沿迹目标姿态角计算|FREQ3.13.8|5.3.4|根据所指定的扫描起始经纬度和末端点经纬度
|偏流角计算|FREQ3.13.9|5.3.5|适用于地球椭球模型，星体姿态描述为转序，计算基于星体光轴(与星本体＋Z轴平行)下的偏流角
|轨道角速度建立目标姿态计算|FREQ3.13.10|5.3.6|在惯性定向与轨道系姿态保持之间切换时，进行轨道角速度的建立或削除
|姿态控制量计算|FREQ3.19|5.2.12|根据姿态确定结果和目标姿态计算结果计算误差姿态角和误差姿态角速度
|引入系统闭环姿态确定|FREQ3.20|5.2.13|根据定姿标志确定引入系统的闭环姿态
|正弦轨迹规划算法算法产品规范|FREQ3.12.7|/|规范化算法：
|基于加速度导数为正弦函数的轨迹规划算法算法产品规范|FREQ3.12.8|/|规范化算法：
",0,1,0,0,0,0,0,0
"功能描述：接收GPS轨道板定位数据
处理：保存GPS轨道板定位数据，35V帆板电压遥测用于帆板故障检测。",0,0,0,0,0,0,1,0
功能描述：外推轨道计算主程序。,0,0,0,1,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|ACU模拟量数据的采集与处理|FREQ1.8.1|""ACU 1553B模拟量数据采集指令
""|模拟量|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
|ACU状态数据的采集与处理|FREQ1.8.2|""ACU 1553B各种状态数据采集指令
""|各种状态数据|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
|ACU中控制指令的输出处理|FREQ1.8.3|喷气脉宽、MW控制电压和磁力矩器控制脉宽|控制指令消息的输出|根据通讯协议，将计算得到的控制数据转换为消息需要的格式并输出。
|MW数据的采集与处理|FREQ1.8.4|""ACU的MW数据采集指令
""|MW的角动量|在通讯允许的条件下，每周期向ACU RT发MW数据采集指令，获得ACU数据并处理成对应的MW的角动量。
|部件加断电指令的处理|FREQ1.8.5|需要发送的加断电指令|加断电指令消息的输出|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|ACU保存CCU的重要数据|FREQ1.8.6|保存CCU的重要数据|接收CCU的重要数据|AOCC每三个控制周期将重要数据发送给ACU（驱动控制单元）
|从ACU恢复CCU的重要数据|FREQ1.8.7|恢复CCU重要数据|发送的CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
|ACU的程序注入修改|FREQ1.8.8|从OBDH收到的ACU需修改程序内容|ACU需修改程序内容|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
|ACU的内存下传|FREQ1.8.9|从OBDH收到的ACU内存下传设置指令|内存下传设置指令|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
|自锁阀操作|FREQ1.8.10||自锁阀操作指令|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令
",0,0,0,0,0,1,0,0
"功能描述：在红外太阳定姿方式下计算四元数，在其余定姿方式下计算欧拉角。
",0,1,0,0,0,0,0,0
"功能描述：与CAN通讯获得上行/下行数据。
调用条件：AOCC被动接收/发送数据；
输入：上行数据。
输出：下行数据。
处理：通过CAN总线与星务分系统通讯，交换数据，以实现星地联系和对卫星的人工干预。主要完成下列功能：
AOCC向星务分系统发送数据（中断接收星务分系统命令，依据命令发送各类遥测参数）；
发送快帧遥测；
发送慢帧遥测；
将AOCC为星务保存的重要数据发送给星务分系统；
发送星敏感器和姿态辅助数据；
有内存下卸要求时，发送AOCC指定内存内容；
AOCC接收星务分系统数据（中断方式）包括接收固定地址参数注入；接收可变地址参数注入；接收轨道参数数据；接收程序注入；接收数据指令；接收重要数据返回；接收整星对时广播数据；接收GPS高精度秒脉冲对时广播；接收GPS导航数据等。
如果应用软件4s收不到星务分系统信息或连续100秒未收到符合通信协议的正确数据，对CAN总线控制器重新初始化。",0,0,0,0,0,0,0,1
"功能描述：接收内存数据块号
处理：将接收内存数据块号存储地址中内容的解包成内存数据块号，并将需下传的内容放到发送AOCC内存数据指定内存内容地址空间中。此处理在中断中进行。",0,0,0,0,0,0,1,0
"需求名称|功能及处理描述
ACU模拟量数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
ACU状态数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
ACU中控制指令的输出处理|根据通讯协议，将计算得到的控制数据转换为消息需要的格式并输出。
MW数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发MW数据采集指令，获得ACU数据并处理成对应的MW的角动量。
部件加断电指令的处理|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
ACU保存CCU的重要数据|AOCC每三个控制周期将重要数据发送给ACU（驱动控制单元）
从ACU恢复CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
ACU的程序注入修改|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
ACU的内存下传|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
自锁阀操作|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令",0,0,0,0,0,1,0,0
"序|需求名称|编号|功能和处理描述
|滚动俯仰通道喷气中断服务程序|FREQ81|将滚动俯仰通道相应的推力器关掉
|偏航通道喷气中断服务程序|FREQ82|根据状态字关相应的推力器
|轨控发动机喷气中断服务程序|FREQ83|将轨控发动机关掉，如果有1N轨控则根据轨控状态字关相应的推力器
",0,0,0,0,1,0,0,0
"序|需求名称|编号|功能及处理描述
|红外1数据的采集与处理|FREQ3.1|选择通讯的红外1LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
|红外2数据的采集与处理|FREQ3.2|选择通讯的红外2LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
",0,0,0,0,0,1,0,0
"功能：利用星敏感器B、C的测量，修正姿态四元数与估计陀螺漂移。
",0,1,0,0,0,0,0,0
功能：在不使用陀螺数据时，对姿态角、角速度与姿态四元数预估。,0,1,0,0,0,0,0,0
功能描述：仅使用红外定姿时，计算正常飞行轮控所需电压。,0,1,0,0,0,0,0,0
"功能描述：根据指令完成中继天线的捕获跟踪控制。
输入：跟踪开始指令（R_GZKS=1），跟踪结束指令（R_GZJS=1），RelayGDASwapAcqFlag，FRelayGDASwapAcq, ， 
输出：RelayGDAView, FRelayGDASwapAcq ,、，",0,1,0,0,0,0,0,0
功能描述：秒脉冲信号处理。,0,0,0,1,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|ACU模拟量数据的采集与处理|FREQ1.8.1|""ACU 1553B模拟量数据采集指令
""|模拟量|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
|ACU状态数据的采集与处理|FREQ1.8.2|""ACU 1553B各种状态数据采集指令
""|部件状态、双组元推进状态1、推进状态2、ACU工作状态|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
|ACU中控制指令的输出处理|FREQ1.8.3|计算得到的喷气脉宽、磁力矩器电压|控制指令消息的输出|根据通讯协议，将计算得到的喷气和磁力矩器数据转换为消息需要的格式并输出。
|部件加断电指令的处理|FREQ1.8.4|需要发送的加断电指令|加断电指令消息的输出|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|ACU保存CCU的重要数据|FREQ1.8.5|保存CCU的重要数据|接收CCU的重要数据|AOCC每个控制周期都将重要数据发送给ACU（驱动控制单元）
|从ACU恢复CCU的重要数据|FREQ1.8.6|恢复CCU重要数据|发送的CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
|ACU的程序注入修改|REQ1.8.7|从OBDH收到的ACU需修改程序内容|ACU需修改程序内容|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
|ACU的内存下传|FREQ1.8.8|从OBDH收到的ACU内存下传设置指令|内存下传设置指令|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
|自锁阀操作|FREQ1.8.9||自锁阀操作指令|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令",0,0,0,0,0,1,0,0
"功能描述：接收地面指令，用星敏测量数据更新四元素。
",0,1,0,0,0,0,0,0
功能描述：发送部件工作状态数据包,0,0,0,0,0,0,0,1
