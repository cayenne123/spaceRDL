Requirements Description,功能需求/初始化,功能需求/控制计算/姿态控制,功能需求/控制计算/姿态确定,功能需求/控制计算/模式管理,功能需求/控制计算/轨道计算,功能需求/控制计算/运行时保障/故障诊断和处理,功能需求/控制计算/运行时保障/数据有效性判断,功能需求/控制输出,功能需求/数据采集,功能需求/遥控,功能需求/遥测
功能描述：决定磁卸载或喷气卸载方式,0,1,0,0,0,0,0,0,0,0,0
"需求名称|功能及处理描述
ACU模拟量数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
ACU状态数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
ACU中控制指令的输出处理|根据通讯协议，将计算得到的喷气和磁力矩器数据转换为消息需要的格式并输出。
部件加断电指令的处理|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
ACU保存CCU的重要数据|AOCC每个控制周期都将重要数据发送给ACU（驱动控制单元）
从ACU恢复CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
ACU的程序注入修改|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
ACU的内存下传|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
自锁阀操作|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令",0,0,0,0,0,0,0,0,1,0,0
"功能描述：发送AOCC时间
处理：
CTU加电或复位后通过子地址12（T/R＝0）向AOCC发送“接收记录AOCC时间数据”消息，消息内容为5555H。AOCC收到该消息后应在0.1s内准备好AOCC 时间数据，然后OBDH通过子地址12（T/R＝1）取走AOCC时间数据。",0,0,0,0,0,0,0,0,0,1,0
"软件需求名称：故障诊断和处理 
需求类别：其他 
软件需求描述：《用户需求》4.8。 
表格工作项|软件需求标识|软件需求名称|
FREQ12.3-R4.8.1|陀螺故障检测及选择|《用户需求》4.8.1|
FREQ12.3-R4.8.2|加计故障检测及选择|《用户需求》4.8.2|
FREQ12.3-R4.8.3|星敏感器故障检测及选择|《用户需求》4.8.3|
FREQ12.3-R4.8.4|帆板驱动机构故障检测及选择|《用户需求》4.8.4|
FREQ12.3-R4.8.5|动量轮故障检测及选择|《用户需求》4.8.5|
FREQ12.3-R4.8.6-K|推进系统故障检测及选择|《用户需求》4.8.6|
FREQ12.3-R4.8.7-K|系统故障检测及选择|《用户需求》4.8.7|
",0,0,0,0,0,1,0,0,0,0,0
"功能描述：计算正常飞行模式轮控所需电压。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：接收应急线路注入数据。
处理：应急线路的上行注入数据为姿控数据块，具体见上行注入文件。",0,0,0,0,0,0,0,0,0,1,0
"序|需求名称|编号|输入|输出|功能及处理描述
|ACU模拟量数据的采集与处理|FREQ1.8.1|""ACU 1553B模拟量数据采集指令
""|模拟量|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
|ACU状态数据的采集与处理|FREQ1.8.2|""ACU 1553B各种状态数据采集指令
""|部件状态、双组元推进状态1、推进状态2、ACU工作状态|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
|ACU中控制指令的输出处理|FREQ1.8.3|计算得到的喷气脉宽、磁力矩器电压|控制指令消息的输出|根据通讯协议，将计算得到的喷气和磁力矩器数据转换为消息需要的格式并输出。
|部件加断电指令的处理|FREQ1.8.4|需要发送的加断电指令|加断电指令消息的输出|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|ACU保存CCU的重要数据|FREQ1.8.5|保存CCU的重要数据|接收CCU的重要数据|AOCC每个控制周期都将重要数据发送给ACU（驱动控制单元）
|从ACU恢复CCU的重要数据|FREQ1.8.6|恢复CCU重要数据|发送的CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
|ACU的程序注入修改|FREQ1.8.7|从OBDH收到的ACU需修改程序内容|ACU需修改程序内容|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
|ACU的内存下传|FREQ1.8.8|从OBDH收到的ACU内存下传设置指令|内存下传设置指令|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
|自锁阀操作|FREQ1.8.9||自锁阀操作指令|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：与推进线路盒通信，输出本周期喷气脉宽。
处理：
功能编号|功能|引用文档
FREQ90|初始化|任务书
FREQ91|推力器使用要求|任务书
FREQ92|通信|任务书
FREQ93|通信故障处理|预留
FREQ94|数据解包与转换|预留
FREQ95|推力器数据有效性处理|预留
FREQ96|推力器模拟量采集、处理|任务书
FREQ97|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,1,0,0,0
"功能描述：接收遥控固定参数注入块的轨道参数
处理：
GPS无效判断的连续次数变量由1改为7。
调整序号14注入轨道根数有效性阀值、序号16~18岁差章动系数的初装值。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：利用B，C头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.9
STEP1：计算，将下标A换成C；FM3更改：若，则：，FSTD=1；
STEP2：计算，的各项乘以，的各项乘以。将下标A换成C；
STEP3：计算q；
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：使用红外、数字太阳敏感器确定姿态。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：计算星上星时。
处理：
应用软件通过软钟结合硬钟的方式获得星时。即在需要计算星时时，读取当前星时计数器，将上次与本次之差作为两次读入的时间差（增计数，当量1us），累计在星时变量上。",0,0,0,0,0,0,0,0,1,0,0
"功能：在不使用陀螺数据时，对姿态角、角速度与姿态四元数预估。
",0,0,1,0,0,0,0,0,0,0,0
功能描述： GPS定轨主程序，包括GPS数据有效、无效时的操作。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：发送AOCC重要数据给OBDH保存
处理：将重要数据打包后放到AOCC重要数据内存地址空间中。重要数据的内容具体见重要数据文件。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：轨控段喷气控制计算。
处理：同用户需求的
（1）各轴喷气参数设置如表36所示
表36：轨控段喷气姿态控制各轴喷气参数设置
|滚动|俯仰|偏航
|0.4 mθD04|0.4 mθD04|0.4 mθD04
|1.0 mθD13（注1）|1.0 mθD13（注1）|1.0 mθD13（注1）
|1.0 mθB36|1.0 mθB36|1.0 mθB36
|3.0 mθB33（注1）|3.0 mθB33（注1）|3.0 mθB33（注1）
|0.1|0.14|0.07
|0.2|0.2|0.2
|（注3）|（注3）|（注3）
|0.3|0.3|0.3
|0.43（注2）|0.43（注2）|0.43（注2）
|（注3）|（注3）|（注3）
KJ2(s)|2|2|2
aJS（/s2）|0.137|0.235|0.089

注1：在BZ1 =3、4的条件下
注2：在BZ1 =2的条件下
注3：在BZ1 =4的条件下
（2）进行各轴平面喷气控制规律计算（同用户需求的）
（3）根据姿轨控喷气规律计算结果，发出相应的喷气指令（同用户需求的）",0,1,0,0,0,0,0,0,0,0,0
"功能描述：模式7切换方式。
处理：
若或者收到轨控结束指令，关姿控发动机，置WorkMode=5；if(lipse=0){WorkModeT=4；}
else{WorkModeT=6；}；
若FailureFlag=2，若RollMnvStyleFlag＝0且PitchMnvStyleFlag＝0，置WorkMode=6，否则(WorkMode=5；WorkModeT=6，；)；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；
注：满足以上任意条件退出时，置tФi、tθi、t pi 为10年后的大星时，
RollMnvStyleFlag＝0、PitchMnvStyleFlag＝0，。",0,0,0,1,0,0,0,0,0,0,0
"序|需求名称|编号|功能及处理描述
|液浮陀螺数据的采集与处理|FREQ2. 1|向选择的液浮陀螺LTU发送完取数指令，获得陀螺LTU返回的数据，将数据转换为控制计算所需的数据格式
|光纤陀螺数据的采集与处理|FREQ2.2|向选择的光纤陀螺LTU发送完取数指令，获得陀螺LTU返回的数据，将数据转换为控制计算所需的数据格式
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：完成卫星入轨后一圈内的控制，完成卫星入轨后的初始姿态捕获，消除星箭分离和太阳帆板展开所产生的姿态扰动，进行动量轮启动和控制，建立对地定向三轴稳定的正常运行姿态
进入条件：
满足下列条件之一：
自主条件（满足下列条件之一）：
星箭分离后的应用软件累计运行时间（24位浮点数）且（0.524秒控制周期累计计数）
ZT1 = 0（入轨初模式）且ZT32 = A（ZT1不等于1）且
退出条件：
满足下列条件之一：
自主条件：满足转入BZ1=1（Z轴对地控制模式）
地面上行注入ZT1不等于（B 、0、1、4）
处理过程：过程如下：
STEP1：进行姿态预估（同用户需求的），得到姿态角和角速度，并赋给姿态角和角速度偏差
STEP2：根据入轨时间分别进行不同的处理：
当[0，5）秒时，先关LV2、4，再开LV1、3，分两个周期进行（第一个周期先关LV2、4，第二个周期再开LV1、3）。
当（1，80（消初偏结束时刻））秒时， 进行消初段喷气姿态控制。
当（80，95）秒时，不控直接退出。
当大于95秒时，进行运行段喷气姿态控制。
当大于120秒（红外接入时刻）时，姿态红外修正、陀螺故障检测及选择和运行段帆板控制。
当（4200（动量轮接入时刻），5400）秒时，如果左右帆板转角输出的绝对值都小于10度，则将ZT19、ZT20分别赋给BZ9、BZ10；如果ZT2不等于2，则置ZT2为1。
当大于4750秒时，如果ZT2等于1且三轴角动量偏差均小于1，则置ZT2为2。
当大于等于4800秒时，置BZ1=1，ZT1=1。
STEP3：根据ZT2的值进行飞轮控制。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：发送和接收时间差值
调用条件：有发送和接收时间差值命令字时
周期：CTU复位时
输入：星时，计数值
输出：时间差值
处理：具体处理要求见与外总线通讯协议。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：使星体−Z 轴捕获太阳。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：选择星敏感器有效数据进行几何姿态确定，并在星敏无效情况下并采用陀螺数据进行姿态预估。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：根据CMG所对应的期望角动量与CMG产生的实际角动量之差，自主诊断CMG的工作状态。,0,0,0,0,0,1,0,0,0,0,0
"功能描述：根据轨道数据计算偏流角。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：选择通讯的星敏LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输入：ZT6、inAPSLTUSeltFlag、星敏LTU返回的数据。
输出：星敏输出的四元数、相对时间和数据有效性标志。
处理：
（1）星敏共有两个LTU，AOCC每个控制周期向注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中的星敏LTU发送取数指令。
（2）向选择的星敏LTU发送完取数指令后，获得星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,0,0,0,1,0,0
功能描述：地面站赤经赤纬计算,0,0,0,0,1,0,0,0,0,0,0
"功能：利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：检测推力器的微漏，必要时作相应的主备份切换。,0,0,0,0,0,1,0,0,0,0,0
"功能描述：利用估计的四元数转换姿态角，送给星敏感器的四元数。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的执行机构参数设定及诊断参数
处理：
调整CMG高速角动量与标称值偏差阀值系数的初装值。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：发送星敏陀螺数据
处理：将星敏陀螺数据打包后放到发送星敏陀螺数据存储地址中
AOCC每个控制周期（250ms）组织128个字节星敏陀螺数据，OBDH每500ms取1次星敏陀螺数据（256个字节）。其中前128字节数据对应小星时的星敏陀螺数据，后128字节数据对应大星时的星敏陀螺数据。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：陀螺数据处理。
处理：
每个惯性姿态敏感器组件中，单个陀螺输出包括1个加速脉冲信号和1个减速脉冲信号。每个信号由1个20位计数器完成对信号的计数。计数器采用加计数方式，当脉冲数超过1048575时，计数器清零，重新计数，应用软件判断计数器溢出，数据为无符号数据。
本周期陀螺n（n＝1～6）加（减）速脉冲计数值(个)=（本周期加（减）脉冲数 － 上周期加（减）脉冲数）；
陀螺n角度增量( º)＝ （陀螺n加速脉冲计数值 – 陀螺n减速脉冲计数值）×陀螺脉冲当量。
对于陀螺n的脉冲数N需要分段处理：要求将每个陀螺量程范围-2.8º/s ~ +2.8º/s分为5段，每段使用不同的标度因数K，分段情况具体见任务书4.1.5.3节要求，当脉冲数超出范围时，则使用±2.8º/s时的标度因数",0,0,0,0,0,0,0,0,1,0,0
"功能描述：仅利用星敏感器B、C的测量，修正姿态四元数与姿态角速度移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：选择视速度增量关机位置控制喷管
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：完成陀螺判断和处理功能（功能编号：FReq-14）。
处理：陀螺故障判断与处理逻辑，进行陀螺饱和故障、陀螺输出常值故障诊断、陀螺跳数故障、控制量与角速度增量不匹配的故障诊断。其中陀螺常值故障诊断由以前的角速度前后周期绝对值之差累计，变更为：角速度前后周期之差累计。并且陀螺平衡方程满足时，增加清相关计数器的可靠性操作。具体处理逻辑详见任务书 中的5.4.5.8.1节。",0,0,0,0,0,1,0,0,0,0,0
"功能描述：对帆板驱动装置1和帆板驱动装置2进行独立控制和诊断，一个帆板驱动装置失效不影响对另一个帆板驱动装置的控制与诊断。
",0,0,0,0,0,1,0,0,0,0,0
功能描述：发送部件工作状态数据包,0,0,0,0,0,0,0,0,0,0,1
"功能描述：分支号与喷管对应选择

处理：
序号|分支状态|姿控分支标志|姿控发动机|轨控分支标志|轨控发动机
1|A、B、C分支都好|A|A1|BC|B1
1|A、B、C分支都好|A|A2|BC|B2+B3+C2+C3
1|A、B、C分支都好|A|A3|BC|B5
1|A、B、C分支都好|A|A4|BC|B4
1|A、B、C分支都好|A|A6|BC|B6+B7+C6+C7
1|A、B、C分支都好|A|A5|BC|B8+B9+C8+C9
2|A、B分支好|A|同A分支|B|同BC
2|A、B分支好|A|同A分支|B|B2+B3
2|A、B分支好|A|同A分支|B|同BC分支
2|A、B分支好|A|同A分支|B|同BC分支
2|A、B分支好|A|同A分支|B|B6+B7
2|A、B分支好|A|同A分支|B|B8+B9
3|A、C好|A|同上|C|C1+C10
3|A、C好|A|同上|C|C2+C3
3|A、C好|A|同上|C|C5
3|A、C好|A|同上|C|C4
3|A、C好|A|同上|C|C6+C7
3|A、C好|A|同上|C|C8+C9
4|B、C好|C|C6+C9|B|同B分支
4|B、C好|C|C7+C8|B|同B分支
4|B、C好|C|C1|B|同B分支
4|B、C好|C|C10|B|同B分支
4|B、C好|C|C2|B|同B分支
4|B、C好|C|C3|B|同B分支
5|A好|A|同A分支|0|无效
6|B好|0|无效|B|同B分支
7|C好|C|同C分支|0|无效",0,1,0,0,0,0,0,0,0,0,0
功能：利用星敏感器A的测量，修正姿态四元数与估计角速度。,0,0,1,0,0,0,0,0,0,0,0
"时间服务用于CCU的校时，卫星时间服务为1s时间同步周期进行一次，BC采用子地址29广播消息发送至各RT。同时实现了OBDH校时时刻和GPS秒脉冲时刻的发送。CCU的处理中，整个的时间为OBDH校时时刻（包括秒部和微妙部），其中的秒部为GPS秒脉冲时刻。因此包含的功能点为两个：
序号|功能描述|功能编号|
|接收OBDH校时时刻|FREQ7.1.1|设置OBDH校时标志TimeFlg.RcvOBDH
|接收GPS秒脉冲时刻|FREQ7.1.2|设置GPS校时标志
",0,0,0,0,0,0,0,0,0,1,0
"功能：利用星敏感器A的测量，修正姿态四元数与估计角速度。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：若本周期角动量与上一周期角动量之差（绝对值）大于0.15Nms，则用上一周期角动量作为本周期输入，角动量变化取0。若连续大于三次或本周期与上一周期角动量之差（绝对值）小于0.15Nms，则以本周期角动量为真值，角动量变化取
输入：实测飞轮角动量，
      上周期角动量数据，
      剔野判断计数器N_WheelPick_i (i=x,y,z,s)",0,0,0,0,0,0,1,0,0,0,0
"功能描述：将CMG启动到标称转数。
处理：
发送指令“运行CMG启动模式”进入CMG启动模式。
	根据地面数据指令，设置CMG引入状态；
	应用软件连续5个控制周期给引入的CMG加电；
	根据自锁阀状态设置自锁阀1和/或自锁阀2开；
	上述动作完成后，自主控制引入的4或5个CMG框架角转到标称位置；
	当框架角度达到要求值后，地面发“CMG高速启动”指令，应用软件连续5个控制周期自主向引入的4或5个CMG发送“CMG高速启动”指令，令4或5个CMG的高速转速达到6000rpm；（本步骤也可通过地面指令完成）
	CMG高速启动时间为10~15分钟
每个控制周期顺序调用用户需求中的逻辑：
调用轨道与星历；
调用CMG数据采集及处理；
调用部件故障检测与信号选取；
调用陀螺数据处理；
调用惯性姿态陀螺预估；
调用星敏感器数据处理；
调用太阳捕获控制；//在有星敏和无星敏时均可启动CMG
调用目标姿态确定；
调用控制器输入量计算；
调用CMG奇异状态的判断及算法计算；
调用CMG启动与保持；
if(CMGStartComm =1) 给CMG发启动指令；
if(Flag_equation=0)调用相平面喷气脉宽；
调用系统故障诊断；",0,0,0,1,0,0,0,0,0,0,0
功能描述：检测红外HL、HR 的故障，并选取正确的红外信号。,0,0,0,0,0,0,1,0,0,0,0
功能描述：接收遥控固定参数注入块的地面站位置信息功能区数据,0,0,0,0,0,0,0,0,0,1,0
"功能描述：根据GNC控制量对动量轮、星敏防尘机构及推进线路盒进行控制。执行顺序要求：先对DM发送控制指令，后对上升器推进线路盒发送控制指令，最后对着陆器推进线路盒发送控制指令
序号|功能点编号|功能描述|说明
|FREQ3.5.1|动量轮|通过串口向DM发送动量轮的控制电压信号
|FREQ3.5.2|星敏防尘机构|通过串口向DM发送星敏防尘机构开关指令
|FREQ3.5.3|推力器|通过串口向推进线路盒发出姿控推力器控制脉宽，7500N变推力发动机及3000N发动机的控制指令
",0,0,0,0,0,0,0,1,0,0,0
"功能描述：发送和接收OBDH重要数据
处理：
OBDH重要数据有四块，大小共为256字节，AOCC不做任何改动保存在RAM中。",0,0,0,0,0,0,0,0,0,0,1
"需求名称|功能描述
部件数据有效性判断|对部件采样数据的有效性进行判断，并选择引入闭环控制系统的数据
陀螺数据有效性判断|判断定姿用陀螺数据的有效性，选择参与定姿的陀螺
模拟太阳敏感器数据有效性判断|确定ASS21，ASS22，ASS31，ASS32及帆板角度传感器，等的信号选取
红外地球敏感器数据有效性判断|判断红外地球敏感器有效性
星敏感器数据有效性判断|对星敏感器输出数据进行有效性判断，并选取定姿星敏组合
数字太阳敏感器数据有效性判断|对数字太阳敏感器输出数据进行有效性判断
部件故障诊断|对部件进行故障诊断
陀螺故障诊断|由平衡方程方法、星敏感器数据等对陀螺进行故障检测
CMG故障诊断|根据CMG输出数据和理论数据进行CMG故障检测
推进喷气异常检测|检测推力器微漏、过量喷气等，必要时作相应的主备份切换和禁止。
帆板故障诊断|帆板故障检测及处理
模式1的系统故障诊断|在模式1中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式2的系统故障诊断|在模式2中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式3的系统故障诊断|在模式3中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式4、6、7的系统故障诊断|在模式4、6、7中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式5的系统故障诊断|在模式5中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式8的系统故障诊断|在模式8中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式9的系统故障诊断|在模式9中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
RS422通讯故障诊断|进行RS422通讯故障诊断及处理
光纤陀螺通讯诊断及处理|进行光纤陀螺通讯故障诊断及处理
数字太阳通讯诊断及处理|进行数字太阳通讯故障诊断及处理
太阳模拟量通讯诊断及处理|进行太阳通讯故障诊断及处理
对地数传天线通讯诊断及处理|进行对地数传天线通讯故障诊断及处理
中继天线通讯诊断及处理|进行中继天线通讯故障诊断及处理
1553B内总线通讯故障诊断|进行1553B内总线通讯故障诊断及处理
红外通讯故障诊断|红外通讯故障诊断及处理
大量程陀螺通讯故障诊断|大量程通讯故障诊断及处理
CMG通讯故障诊断|CMG通讯故障诊断及处理
ACU通讯故障诊断|ACU通讯故障诊断及处理
帆板通讯故障诊断|帆板通讯故障诊断及处理
多头星敏通讯故障诊断|多头星敏通讯故障诊断及处理",0,0,0,0,0,0,1,0,0,0,0
功能描述：接收遥控固定参数注入块的系统轨控调姿及轨控姿态控制系数,0,0,0,0,0,0,0,0,0,1,0
"功能描述：估计各个加速度计零位漂移增量
",0,0,1,0,0,0,0,0,0,0,0
功能描述：CMG启动模式控制,0,0,0,1,0,0,0,0,0,0,0
"功能描述：根据动力学输入预估卫星惯性姿态。
",0,0,1,0,0,0,0,0,0,0,0
"软件需求名称：星时校正 
需求类别：其他 
软件需求描述：校正星上星时。
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：根据任务要求，应用软件进行LTU初始化、1553B初始化、变量的初始化
处理： 
进行LTU初始化
进行1553B初始化
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。变量初值见上行注入、用户需求、装订参数。对于上述文件中相同变量的初值，以装订参数文件为准。对于上行注入与用户需求中相同变量的初值，以用户需求的规定为准。复位后的状态恢复不区分单机复位和三机复位。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：复位模式初始化
处理：
- StarTime（星上时间）：0.0；
- 向星务分系统申请重要数据；",1,0,0,0,0,0,0,0,0,0,0
功能描述：使用GPS轨道版数据进行GPS定轨。,0,0,0,0,1,0,0,0,0,0,0
功能描述：把陀螺数据、、输入并变换到星体坐标系中的。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：与数字太阳通信，发送取数指令，获得部件数据。
处理：
在OBC每个控制周期中可能会通过串口向数太发送控制指令或者接收下传数据，见任务书时序图。
功能编号|功能|引用文档
FREQ62|初始化|小卫星统一化平台中心控制单元RS422通讯协议：数太协议
FREQ63|数太使用要求|任务书、数太协议
FREQ64|通信|任务书、数太协议
FREQ65|通信故障处理|任务书
FREQ66|数据解包与转换|数太协议
FREQ67|数太数据有效性判断、处理|任务书
FREQ68|数太模拟量采集、处理|预留
FREQ69|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：部件加电标志。与光纤陀螺通信功能。
处理：
见陀螺通信协议。
功能编号|功能|引用文档
FREQ45|初始化|陀螺协议
FREQ46|陀螺使用要求|任务书
FREQ47|通信|陀螺协议
FREQ48|通信故障处理|任务书
FREQ49|数据解包与转换|陀螺协议
FREQ50|陀螺数据有效性判断、处理|任务书
FREQ51|陀螺模拟量采集、处理|任务书
FREQ52|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,0,1,0,0
功能描述：利用星敏感器和陀螺输出计算卫星欧拉角和四元数。,0,0,1,0,0,0,0,0,0,0,0
功能描述：由平衡方程方法、星敏感器数据进行陀螺的故障检测,0,0,0,0,0,0,1,0,0,0,0
功能描述：通过注入轨道参数，计算轨道外推数据。,0,0,0,0,1,0,0,0,0,0,0
"功能：利用星敏感器A、C的测量，修正姿态四元数与姿态角速度。
调用条件：见用户需求5.2.6节。
周期：0.125秒
输入：WorkMode， ， 。
输出：，
处理
见用户需求5.2.6.11。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：输出喷气指令
处理：
（1）将喷气的喷管打开
（2）将喷气长度写入各自通道的定时器；",0,0,0,0,0,0,0,1,0,0,0
"功能描述：减小卫星的俯仰角。
输入：陀螺数据输出 ，
红外数据有效性标志F_IresValid（由有效性判据给出）
红外数据处理（全姿态捕获）的输出，
上周期姿态角估值，
",0,0,1,0,0,0,0,0,0,0,0
根据同步字的编码内容进行相应的处理：,0,0,0,0,0,0,0,0,0,1,0
"功能描述：发送控制计算机计算得出的星历数据
处理：将控制计算机计算得出的星历数据打包后放到星历数据地址空间中。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：根据陀螺输入，予估q及姿态角（在星测量回路中），等。。
处理：同用户需求的1.6。
STEP1:计算星敏预估角速度，。计算结果的限幅值是0.027。计算公式见1.6（1）。
STEP2:计算q,和，计算公式见1.6（2）。
STEP3:计算，。对于计算结果，当BZ1=8（侧摆机动）时，否则。对于计算结果，。对于计算结果，。计算公式见1.6（3）。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：以1s为采样周期，计算角速度。。
",0,0,1,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|星敏感器1数据的采集与处理|FREQ1.5.1|""星敏感器
1553B取数指令
""|星敏感器1的四元素、角速度和状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器1数据并处理成对应的四元素和角速度。
|星敏感器2数据的采集与处理|FREQ1.5.2|""星敏感器
1553B取数指令""|星敏感器2的四元素、角速度状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器2数据并处理成对应的四元素和角速度。
|星敏感器3数据的采集与处理|FREQ1.5.3|""星敏感器
1553B取数指令""|星敏感器3的四元素、角速度状态信息|在通讯允许的条件下（星敏感器的当班标志为1），每周期向星敏感器RT发取数指令，获得星敏感器3数据并处理成对应的四元素和角速度。
|星敏感器4数据的采集与处理|FREQ1.5.4|""星敏感器4
1553B取数指令""|星敏感器4的四元素、角速度状态信息|在通讯允许的条件下（星敏感器4的当班标志为1），每周期向星敏感器 RT发取数指令，获得星敏感器4数据并处理成对应的四元素和角速度。
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：利用星敏感器C、D的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：秒脉冲信号处理。,0,0,0,0,0,0,0,1,0,0,0
"功能描述：喷气控制，要求将CMG控至标称角动量，保持这个标称角动量。
输入：地面注入的CMG引入标志[i]（0切除；1引入）；各CMG的框架角度Sgang[i]（弧度）；三轴角动量偏差、、（Nms）；CMG有效标志Lcmg[i]（1代表有效，0代表无效）",0,1,0,0,0,0,0,0,0,0,0
"功能描述：发送实时遥测数据。
处理：应急线路实时帧数字量共一个数据包，共60字节，具体定义见遥测文件。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：在红外太阳定姿方式下计算四元数，在其余定姿方式下计算欧拉角。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：利用星敏感器数据进行卫星姿态捕获。
",0,0,1,0,0,0,0,0,0,0,0
"软件需求名称：姿态确定算法 
需求类别：其他 
软件需求描述：
表格工作项|软件需求标识|软件需求名称|
FREQ12.3-R4.4.1|陀螺姿态预估|《用户需求》4.4.1|
FREQ12.3-R4.4.2|星敏感器陀螺确定惯性姿态|《用户需求》4.4.2|
FREQ12.3-R4.4.3|中继跟踪目标姿态计算|《用户需求》4.4.3|
FREQ12.3-R4.4.4-K|太阳捕获及太阳定向|《用户需求》4.4.4|
FREQ12.3-R4.4.5|轨控目标姿态计算|《用户需求》4.4.5|
FREQ12.3-R4.4.6|误差四元数计算|《用户需求》4.4.6|
",0,0,1,0,0,0,0,0,0,0,0
功能描述：动量轮转速采集 ,0,0,0,0,0,0,0,0,1,0,0
功能描述：帆板未展开模式控制,0,0,0,1,0,0,0,0,0,0,0
"功能描述：计算磁卸载所需的磁矩与磁力矩器工作脉宽。
",0,1,0,0,0,0,0,0,0,0,0
"包括下表的功能点。
序号|功能描述|功能编号
|向ICU发送控制计算机重要数据|FREQ7.6.1
|向OBDH发送控制计算机重要数据|FREQ7.6.2

发送控制计算机重要数据的具体要求见重要数据文件。",0,0,0,0,0,0,0,0,0,0,1
"序|需求名称|编号|输入章节号|功能描述
|喷气开关逻辑相平面分区，喷气脉冲宽度计算|FREQ31|4.3.1.1|进行单轴相平面分区及控制规律计算
|三轴姿态喷气控制与推力器脉宽分配|FREQ32|4.3.1.3|为三轴姿态喷气控制选择推力器
|轨控发动机与其备份的使用|FREQ33|4.3.1.4|轨控模式时使用轨控发动机及其备份
|动量轮摩擦补偿计算|FREQ34|4.3.2.2|动量轮摩擦力矩的补偿电压计算
|动量轮角动量保持控制|FREQ35|4.3.2.3|计算将动量轮保持至标称角动量所需的电压
|动量轮的启动与保持|FREQ36|4.3.2.4|启动动量轮至标称角动量，并保持
|正常飞行模式动量轮分配电压计算|FREQ37|4.3.2.5|计算正常飞行模式轮控所需电压
|正常模式轮子保护与动量卸载|FREQ38|4.3.3.1|决定采用磁卸载还是喷气卸载方式，调用相应程序
|磁卸载计算|FREQ39|4.3.3.2|计算磁卸载所需的磁矩与磁力矩器工作电压
|结构滤波器计算|FREQ95|4.3.2.6|PID计算控制力矩经过结构滤波器后，改善姿态控制效果
|太阳定向主程序|FREQ40|4.4.3.3|搜索并捕获太阳，完成并保持帆板对太阳定向
|重捕地球与建立正常姿态（1）|FREQ41|4.4.4.1|在完成对日定向后，由地面指令转入重捕地球。在偏航捕获阶段，通过红外和太阳敏感器定姿，消除卫星的偏航角。在完成偏航捕获后，由红外地球敏感器测量信号进行计算得到俯仰角和滚动角，控制滚动、俯仰使其趋向于0
|捕获地球与建立正常姿态（2）|FREQ42|4.4.4.2|当红外敏感器故障时，在太阳定向完成后，利用数字太阳与星敏感器信息，进行全姿态捕获，并建立正常姿态。
|三轴等效角动量偏差|FREQ91|4.3.4.1|根据飞轮实测角动量和标称角动量计算三轴等效角动量偏差
|俯仰通道轮控算法|FREQ92|4.3.4.2|根据俯仰角和俯仰通道角动量偏差信息实现俯仰轴姿态控制
|磁进动、章动阻尼及俯仰轮卸载控制|FREQ93|4.3.4.3|通过磁力矩器，实现滚动-偏航轴的进动控制及章动阻尼，并对俯仰飞轮进行磁卸载
|三轴轮控算法|FREQ94|4.3.4.4|偏置动量轮处于力矩模式，根据红外地球敏感器测量信息计算得到的滚动角和俯仰角实现三轴姿态控制。滚动、俯仰轴采用角动量反馈方式控制，偏航轴采用耦合控制
|帆板捕获及跟踪控制|FREQ102|4.3.5|根据地面指令或自主使帆板跟踪太阳
|干扰补偿控制算法及动量轮分配电压计算|FREQ95|任务书的4.1.15|计算有效载荷干扰补偿控制电压，以及计算动量轮分配电压
|全姿态捕获动量轮控制方式主程序|FREQ40.5|4.4.5|全姿态捕获动量轮控制方式主程序
",0,1,0,0,0,0,0,0,0,0,0
功能描述：对弦宽、基准与给定的范围进行比较，确定红外故障。若两红外数据均有效，则还可根据本周期与上周期红外姿态角确定红外故障。,0,0,0,0,0,1,0,0,0,0,0
将接收GPS数据存储地址中内容解包成对应的UTC时间、位置和速度数据和定轨数据的数据格式。由于GPS数据中有数据有效性标志，所以其中的微秒部分不考虑大于1秒的情况，由GPS保证。,0,0,0,0,0,0,0,0,0,1,0
"功能描述：卫星绕x轴转动，使红外搜索地球。
输入：	陀螺数据处理的输出 ，
红外数据有效性标志F_IresValid（由有效性判据给出）
故障标志IRES_Flag，计时器TES
红外数据有效性输出 ，",0,0,1,0,0,0,0,0,0,0,0
"功能：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移。
输入：星敏感器B修正新息，四元数、陀螺常漂
输出：修正四元数、陀螺常漂
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：每4.192秒运行一次的主程序。
处理： 
STEP1：记录当前的星时、数字太阳敏感器输出、四元数和星敏数据、星敏姿态角及惯性角速度：
，
FSTAVD = FSTAVD05，FSTBVD = FSTBVD05，FSTCVD = FSTCVD05
t星A = t星A05，t星B = t星B05，t星C = t星C05
=，=，=，=，=，=
，；
STEP2：若指定星敏诊断陀螺故障，则：对工作陀螺，
STEP3：进行外推轨道计算和中继卫星轨道计算；
STEP4：重要数据打包，进行数据校正和红外故障检测及信号选取；
STEP5：当BZ1 为 1（Z轴对地控制模式）或9（侧摆角保持模式）时，如果没有喷气则进行光行差修正量计算及加速计零位估计；
STEP6：进行星敏感器数据处理；
STEP7：当BZ1为 1（Z轴对地控制模式）或9（侧摆角保持模式）时，进行下列操作：
当BZ1= 1（三轴稳定正常轨道运行姿态）且BZ2 = 1（已有遥控轨道数据注入）且BZ6 = 3（姿态确定用红外、陀螺和数字太阳）且C1 = 0000（轨控数据有效标志为无效）且ZT3≠F（用红外+单个斜装陀螺定姿，且接入控制回路）且ZT3≠A（星敏无陀螺定姿，且接入控制回路，整星零动量控制方式）时进行姿态太阳修正。
当C1 = CCCC（轨控关机后或偏航机动结束后）时令星敏修正时间；否则
进行S姿态的q修正及光轴方位计算（由四元素来修正姿态（星测量回路），等；计算星敏感器光轴方位）
当时令，=，=，=，=，
若C1=0，则根据FSTD（星敏参与定姿的标志）的取值进行相应的星敏修正并令
FSTD取值|处理
2|用A，B头测量修正q
3|用A，C头测量修正q
4|用B，C头测量修正q
5|用A头测量修正q
6|用B头测量修正q
7|用C头测量修正q

当满足ZT4  0（用磁力矩器）且BZ2  2（有遥控注入过）且ZT2  2（飞轮启动保持或零动量控制方式）时进行地磁场计算和飞轮磁卸载；否则令磁力矩器的输出电压为0；
STEP8：当BZ1 = 1或9或 { BZ1 = 3，FSA≥5 } 或 { BZ1 = B，}，则进行推进系统故障检测及切换；
STEP9：若BZ1 = 1或9或 { BZ1 = B，}，则：系统故障检测；否则系统故障检测中的连续时间计数；
STEP10：若ZT17≥4，ZT18≥7，则：帆板故障检测及切换；
STEP11：当ZT38 = F（0.524主程序中插入帆板未展开模式）时，进行帆板未展开模式处理；
STEP12：当BZ1  1，8，9（入轨段控制模式、偏航机动模式、全姿态捕获、重
捕地球、轨控模式、姿态无控模式、自旋模式）时，令不用星敏定姿；
STEP13：若BZ1  1，8，9，B，则：FSY = ；
STEP14：当ZT4 = 0（不用磁力矩器时）或BZ1  （1、9）时，令磁力矩器的电压为0；
STEP15：当ZT2  6时，令动量轮的电压为0；
STEP16：设置，；
STEP17：记录数据， ；
STEP18：进行中帧、慢帧的遥测数据和黑匣子数据的打包。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：复位模式处理
处理：
- 采集陀螺、红外、太阳敏感器数据；
- 继续与ALTU通讯（控制量都为0，无控制指令）；
- 响应除“重要数据保存”的所有星务遥控及遥测；
- 不查询应急加电标志，不保存APP_WorkMode1/2/3变量；
",1,0,0,0,0,0,0,0,0,0,0
功能描述：由平衡方程方法、星敏感器数据、红外/太阳数据，以及动力学输出对陀螺进行故障检测。,0,0,0,0,0,1,0,0,0,0,0
CTU复位后需要从AOCC恢复重要数据和星上时间。首先CTU发送“接收用于做时间差值的时间码”指令，将CTU目前的时间发送给AOCC。AOCC将星上时间和接收到的CTU时间做差值处理，将AOCC时间-CTU时间保存。CTU在1s后发送“发送时间差值”指令，AOCC将保存的时间差值发送给CTU。,0,0,0,0,0,0,0,0,0,0,1
"功能描述：启动动量轮至标称角动量，并保持
",0,1,0,0,0,0,0,0,0,0,0
"软件需求标识：FREQ15 
软件需求名称：光纤陀螺数据处理 
需求类别：其他 
软件需求描述：光纤陀螺数据处理。",0,0,0,0,0,0,0,0,1,0,0
功能描述：发送矢量字,0,0,0,0,0,0,0,0,0,0,1
"功能描述：星时计算
处理：控制周期中断服务程序，对星时加1",0,0,0,0,0,0,0,0,1,0,0
功能描述：三轴喷气姿态控制。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：接收数传天线状态数据
处理： 将接收数传天线状态存储地址中内容解包成数传天线状态的数据格式，根据不同的数传天线状态设置对应数传天线的加断电状态。",0,0,0,0,0,0,0,0,0,1,0
"软件需求名称：遥测 
需求类别：其他 
软件需求描述：遥测打包。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：选择通讯的陀螺LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）陀螺共有三个互为备份的LTU，通过每个LTU均可获得9个陀螺的数据；每个控制周期AOCC向陀螺LTU发送取数命令来获得数据，AOCC根据GROLTUSeltFlag来确定和哪个LTU进行通讯。
（2）向选择的陀螺LTU发送完取数指令，获得陀螺LTU返回的数据，将数据转换为控制计算所需的数据格式。",0,0,0,0,0,0,0,0,1,0,0
功能描述：实时计算卫星轨道参数及太阳方位、太阳敏感器理论输出。,0,0,0,0,1,0,0,0,0,0,0
将重要数据打包后放到AOCC重要数据内存地址空间中。AOCC共三块重要数据，每块重要数据均有校验和，校验和占4个字节。校验和的计算方法为：将60个字节按双字进行异或计算。,0,0,0,0,0,0,0,0,0,0,1
"序|需求名称|编号|功能及处理描述
|红外1数据的采集与处理|FREQ3.1|选择通讯的红外1LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
|红外2数据的采集与处理|FREQ3.2|选择通讯的红外2LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
",0,0,0,0,0,0,0,0,1,0,0
OBDH分系统每8分钟给AOCC校时一次。,0,0,0,0,0,0,0,0,0,1,0
"功能描述：利用星敏感器和陀螺输出计算姿态四元数。
",0,0,1,0,0,0,0,0,0,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|+Y帆板1553B取数指令（广播同步消息）
+Y帆板转角及状态信息|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。
-Y帆板数据的采集与处理|-Y帆板1553B取数指令|-Y帆板转角及状态信息|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|+Y帆板控制数据
+Y帆板控制指令消息输出|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|-Y帆板控制数据
-Y帆板控制指令消息输出|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|从OBDH收到的帆板需修改程序内容|帆板需修改程序内容|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|从OBDH收到的帆板内存下传设置指令|内存下传设置指令|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,0,0,0,1,0,0
功能描述：若3000秒（全姿态捕获除速率阻尼外1000秒，可注入修改）内，三轴中任一轴喷气总量（正负轴单独判断）超过范围（正常模式50s，粗定向和轮子启动、全姿态捕获100s，可注入修改），则根据自锁阀状态，开关自锁阀。全姿态模式下,0,0,0,0,0,1,0,0,0,0,0
"功能描述：根据飞轮角动量及地磁场强度决定并输出磁棒控制电压。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：，
输出：保持角动量所需电压，
      角动量偏差积分项：，",0,1,0,0,0,0,0,0,0,0,0
"功能描述：选择通讯的数传天线LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）数传天线有四个LTU，天线1和2各有两个互为备份。应用软件初始上电时不与数传天线通讯，与数传天线开始通讯的条件为：收到数传天线预指或复位总线指令和数传天线加电。停止与数传天线通讯的条件为：收到数传天线停止总线指令和数传天线断电。其中数传天线加断电状态由1553B的接收数传天线伺服控制器状态设置数据命令来确定。同时也根据这个命令确定参与通讯的LTU。初始为选择主份，收到主切备时切换到备份；在备份通讯时，收到备切主时切换到主份。
（2）向数传天线LTU发完取数命令后，获得数传天线LTU返回的数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式。",0,0,0,0,0,0,0,0,1,0,0
功能描述：对工作的飞轮进行电压补偿，并输出控制电压。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：利用A，C头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.8。
STEP1：计算，将下标B换成C；FM3更改：若，则：，FSTD=1；
STEP2：计算，。的各项乘以，的各项乘以。将下标B换成C；
STEP3：计算q；
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：决定采用磁卸载还是喷气卸载方式，调用相应程序。
输入：姿态角，姿态角速度，
实测飞轮角动量   =[，]T
标称角动量       =[，]T
      标志             UnLoadMode， F_WheelSaturation， F_AttrOutLmt
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：CMG奇异状态的判断及算法计算。
输入：采集得的各CMG的框架角Sgang[i]（弧度）；CMG有效性标志Lcmg[i]，Jacobi矩阵sgJ",0,1,0,0,0,0,0,0,0,0,0
"功能描述：自主对计算机进行切换。
处理：
AOCC的A机和B机满足一定的条件下，可以进行切换。",0,0,0,0,0,0,0,1,0,0,0
"软件需求名称：帆板使用及通信 
需求类别：其他 
软件需求描述：与帆板通信，控制帆板并获得帆板状态数据。
处理：
见通信协议。 
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
帆板初始化|FREQ46|帆板初始化|B|2
帆板数据采集|FREQ47|帆板数据采集|B|3
数据解包与转换|FREQ48|数据解包与转换|B|4
帆板数据有效性判断、处理|FREQ49|帆板数据有效性判断、处理|B|5
帆板控制量输出|FREQ50|帆板控制量输出|B|6
帆板故障重构|FREQ51|帆板故障重构|C|
",0,0,0,0,0,0,0,1,0,0,0
功能描述：主动段模式控制,0,0,0,1,0,0,0,0,0,0,0
"功能描述：滚动/俯仰姿态机动目标姿态确定。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：模式2切换方式。
处理：
FailureFlag=4且AutoInStopNum<2时，置WorkMode=8，SpeedControlTime＝0，AutoInStopNum=AutoInStopNum+1；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；",0,0,0,1,0,0,0,0,0,0,0
"软件需求名称：星历与轨道 
需求类别：其他 
软件需求描述：日月星轨道计算“计算太阳、月球、卫星位置矢量在地心J2000.0惯性系下的表示”；中继目标轨道计算“计算中继目标轨道”。 
表格工作项|软件需求标识|软件需求名称|
FREQ12.3-R4.3.1|日月星轨道计算|《用户需求》4.3.1|
FREQ12.3-R4.3.2|中继目标轨道计算|《用户需求》4.3.2|
",0,0,0,0,1,0,0,0,0,0,0
"软件需求标识：FREQ18 
软件需求名称：模拟太敏数据处理 
需求类别：其他 
软件需求描述：模拟太敏数据处理。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：处理地面遥控注入的固定地址参数
处理：
128-135：注入参数乘修正系数
515：全量校时处理：星时=全量校时星时
516：增量校时处理星时=星时+增量校时量
其它：更新注入的参数",0,0,0,0,0,0,0,0,0,1,0
"功能描述：计算偏置动量模式下滚动/偏航轴进动控制及章动阻尼所需的磁力矩器脉宽。                                                                                                                                                                                                                                                                                                                                                           输入：
Y轴角动量偏差    
滚动角，滚动角速度，偏航角，偏航角速度
地磁场强度（T） ，及标量B，星下点经纬度L,
输出：磁力矩器工作脉宽，",0,1,0,0,0,0,0,0,0,0,0
"功能描述：轨道数据解包及处理
处理：依据地面注入轨道种类，追踪器轨道平根数、目标器轨道平根数、追踪器J2000坐标系轨道参数、目标器J2000坐标系轨道参数，更新相应轨道数据。
说明：星务分系统向GNCC送数采用128字节(有效使用1字节)帧格式。注入数据格式见《卫星GNC分系统GN与星务分系统通讯协议》，注入内容见《卫星控制分系统注入参数及数据指令》",0,0,0,0,0,0,0,0,0,1,0
"功能描述：根据从SLTU接收的0.25秒或1秒内陀螺的角度增量，算出卫星在惯性空间的角速度。
输入：0.25秒或1秒内陀螺的角度增量 (量纲：弧度)
(i=1,2,3,…6，依次表示陀螺G1，G2，…，G6的输出)；
采样周期 (量纲：秒)；
陀螺数据有效性标志F_GyroValid(由陀螺有效性判据给出)。
陀螺系统在星体三轴方向等效的常值漂移估值 (量纲：弧度/小时)
星敏感器数据有效性标志：F_SAValid，F_SBValid，F_SCValid",0,0,1,0,0,0,0,0,0,0,0
功能描述：计算得到的控制电压输出给动量轮。,0,0,0,0,0,0,0,1,0,0,0
"功能描述：采集22路数字太阳粗码、监视码和全开码。
处理：
采集方法：连续采集28路（中间有细码信息，处理时略过），采集1路的操作步骤（以DSS1的粗码1为例）：
向选通地址输出偏移地址：0x1200 0000 = 00H；
等待至少100µs,启动A/D转换：0x1200 0020 = 0；
等待至少40µs后；
连续3次读取A/D数据总线上的数据：data1 = 0x1200 0020 (data2，data3类似)；
取data1、data2、data3三个数据的中间值，作为本路模拟量的最终采集结果。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：实现运行段姿态、帆板和天线的控制。
处理：
（1）Call  （飞轮控制）
（2）若ZT8  3，ZT9  3，ZT，ZT3  B ，{{BZ1 ≠ 8，{{FHU=A，ZT2=2，FWH ≠ 22}或ZT2≠ 2或FWH =22}}或{ BZ1 = 8，FRTS = 1}}，则：
Call  （运行段喷气姿态控制）
（若ZT3 = F，则每4秒Call  一次）（不调用喷气控制时确认电磁阀全关）
（3）若ZT7  8，则： 
Call  （运行段帆板控制）
若ZT7 = 0，则：发两翼帆板归零指令
若ZT7 = 3，则：发左翼为90度，右翼为 -90度指令
若ZT7 = 5，则：发左右皆为90度指令
若ZT7 = 7，则：发左右皆为180度指令
（4）Call  5.9（陀螺故障检测及选择）
（5）若BZ1 = 1或8或9，ZT40(4) = 1，则：
Call  1.7（数传天线捕获跟踪控制）",0,1,0,0,0,0,0,0,0,0,0
"功能描述：利用陀螺确定出卫星对目标的姿态四元数。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：输出磁力矩器控制电源。
处理：
功能编号|功能|引用文档
FREQ93|初始化|任务书
FREQ94|磁力矩器使用要求|任务书
FREQ95|通信(DA)|任务书
FREQ96|通信故障处理|预留
FREQ97|数据解包与转换|预留
FREQ98|磁力矩器数据有效性处理|预留
FREQ99|磁力矩器硬件采集、处理|任务书
FREQ100|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,1,0,0,0
功能描述：确定陀螺数据的有效性。,0,0,0,0,0,0,1,0,0,0,0
"功能描述：
  应急软件初始化功能在软件上电或复位时调用，完成应急软件相关变量的初始化工作和硬件初始化。
处理： 完成80C32E处理器初始化、软件变量初始化、ASIC芯片初始化、1553B初始化，初始化流程的前后顺序可适当调整。
（1）80C32E处理器初始化：
初始化项目|寄存器名|初始值|说明
中断使能寄存器|IE|0x00|关闭中断。
计时器控制寄存器|TCON|0x05|外部中断0、1触发方式设置为下降沿触发。
计时器模式寄存器|TMOD|0x61|定时器1工作模式为2：自动装入TL1计数（8位）;定时器0工作模式为1: 16位定时器
定时器1初值|""TH1
TL1""|""0x00
0x00""|计数器（定时器）1从0开始进行计数，计数到256时溢出，触发计数器1中断，从而得到128ms
中断优先级寄存器|IP|0x01|中断优先级设置:全帧遥测数据接口帧同步中断为高优先级, 其余低优先级
P1口|P1_4|1|选择主份TM
P1口|P1_0|1|清狗电平
内部RAM|0x00~0xFF|0x00|上电后将内部RAM初始化为0

（2）软件变量初始化
软件变量初始化时，先将32KB外部RAM初始化为0，之后将非零变量显示初始化。帆板初始状态为正向复位，部件状态为不加电，推力器采用A分支，部件故障诊断不允许。
（3）ASIC芯片初始化
按照任务书、以及硬件技术说明书对ASIC芯片进行初始化，主要涉及GPIO口、GC计数器、GT定时器，同步串口等。
（4）1553B初始化
详见5.2.9.1节 FReq-9。
初始化完成后，允许总中断、T1(128ms)定时器中断、外部中断0，并启动T1。",1,0,0,0,0,0,0,0,0,0,0
功能描述：利用红外、数字/太阳敏感器确定姿态。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据陀螺输出，预估卫星姿态和姿态角速度。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收同步控制
处理：根据同步字的编码内容进行相应的处理：",0,0,0,0,0,0,0,0,0,1,0
"根据不同的任务要求划分了各个模式，模式控制作为一个功能的集合体反映了任务的执行情况，是确认测试和系统实验验证的要的功能。
序|需求名称|编号|输入章节号|功能描述
|主动段模式控制|FREQ44.0|3.3.0|主动段模式调用流程
|入轨消初偏模式控制|FREQ44.1|3.3.1|入轨消初偏模式调用流程
|红外引入对地粗定向模式控制|FREQ44.2|3.3.2|红外引入对地粗定向模式调用流程
|动量轮启动模式控制|FREQ44.3|3.3.3|动量轮启动模式调用流程
|正常轨道运行模式控制|FREQ44.4|3.3.4|正常轨道运行模式调用流程
|轨控模式1模式控制|FREQ44.5|3.3.5|轨控模式1模式调用流程
|由正常姿态进行姿态机动模式控制|FREQ44.6|3.3.6|由正常姿态进行姿态机动模式调用流程
|轨控模式2模式控制|FREQ44.7|3.3.7|轨控模式2模式调用流程
|由轨控姿态机动回正常轨道运行模式控制|FREQ44.8|3.3.8|由轨控姿态机动回正常轨道运行模式调用流程
|全姿态捕获模式控制|FREQ44.9|3.3.9|全姿态捕获模式调用流程
|应急安全模式模式控制|FREQ44.10|3.3.10|应急安全模式模式调用流程
|停控模式控制|FREQ44.11|3.3.11|停控模式调用流程
|帆板未展开模式控制|FREQ44.12|3.3.12|帆板未展开模式调用流程
|偏置动量控制模式控制|FREQ44.13|3.3.13|偏置动量控制模式调用流程

主动段模式下并不进行姿态确定和控制的计算，其它各个模式控制中调用卫星轨道和星历计算、姿态确定、姿态和轨道控制及部件有效性和故障诊断以及模式初始化的内容具体见用户需求的3。",0,0,0,1,0,0,0,0,0,0,0
CCU控制周期为125ms，对于BC端每帧50ms通信同步服务，应用软件采用轮询方式查询帧序号，作为循环缓冲区子地址指针复位时判断使用。,0,0,0,0,0,0,0,0,0,1,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：动量轮启动的程控指令
      实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：， ，
",0,1,0,0,0,0,0,0,0,0,0
功能描述：根据陀螺输入，预估卫星惯性姿态四元数。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据GPS接收到的数据计算轨道平根数和GPS数据有效性。
处理：
STEP1：若ZT41[4]=0，则使用通道板数据计算GPS数据对应得星时及在惯性系中的位置速度，瞬根数；否则瞬根数用轨道板数据；
STEP2：计算平根数；
STEP3：GPS数据有效性判断。其中误差增加模PI限幅。",0,0,0,0,1,0,0,0,0,0,0
"功能描述：0.5秒中断采集各部件数据
输出：内存单元保存的各部件数据与状态。
处理：  
     处理流程如下图所示：
                      图11：数据采集处理流程",0,0,0,0,0,0,0,0,1,0,0
"功能描述：发送遥测数据
处理：
包括两个子地址，发送两条指令是连续的，共有76个字节。应用软件在收到发送遥测帧计数（低字节为实时遥测帧计数0~63，高字节为实时格式计数0~7）的低字节为62时，根据高字节实时格式计数根据延时遥测数据格式进行打包后放到发送延时遥测参数地址中，具体数据见延时遥测文件。",0,0,0,0,0,0,0,0,0,0,1
"通讯串口
04H|波特率寄存器|RW|""波特率寄存器低位：0x04（115200）
0x18（19200）""
08H|波特率寄存器|RW|波特率寄存器高位：0x00
CAN总线初始化
寄存器名称|初始化内容|初始化意义
""CAN_ADDR        
(CAN总线地址)""|无。|无说明。
""控制寄存器
(Control Register)
""|0x07|""D7D6D5：保留。
D4：超载（接收设备不能按数据发送速率接收数据而造成的数据丢失）中断使能。
高：开放。低：禁止
D3：错误中断使能。
高：开放。低：禁止
D2：发送中断使能。
高：开放。低：禁止
D1：接收中断使能。
高：开放。低：禁止
D0：复位模式。
在初始化的时候，复位模式位置1，才可以进行初始化设置。""
命令寄存器(Command register)|0x=00001100|""D7D6D5：保留。必须。
D4：进入睡眠状态。
高：睡眠 。低：睡眠唤醒。
D3：清除超载状态。不产生超载中断。
高：清除。低：无动作。
D2：释放接收缓冲器。（读接收缓存器内容后，释放缓存器，以便其他报文立即可用）。
高：释放。低：无动作。
D1：夭折发送。
D0：发送请求。
高：报文即将发送。低：无动作。""
""验收代码寄存器
(Acceptance 
Code Register)""|0xa7=10100111|""当通过验收测试的报文被接收，且若存在空的接收缓存器，则各自的描述符和数据场被顺序存贮在空的缓存器中，在不存在空的接收缓存器的情况下，数据超载位被置位高(超载)，当完整的报文被正确接收，将出现下列操作：
接收缓存器状态位被置为高(满)
若接收中断开放位被置为高(开放)，接收中断被置为高(置位)
验收码位(AC.7~AC.0)和报文标识符的最高8位(ID.10~ID.3)必须等于由验收屏蔽位必须满足""
""验收屏蔽寄存器
((Acceptance 
Mask Register))""|0xf8|最后三位相关。
总线时序寄存器0(Bus Timing Register 0)|0x00|""总线时序寄存器的内容决定波特率预分频器(BRP)和同步跳转宽度(SJW)的数值。

通过总线定时器的内容，将波特率预分频器设置为2，即将输入的系统时钟二分频，由于输入的系统时钟已经是将计算机晶体频率14.7456MHz二分频，即7.3728MHz。所以这个时候时钟为3.6864 MHz。""
总线时序寄存器1(Bus Timing Register 1)|0x18|""采样（SAM）=1总线采样1次。
TSEG1和TSEG2确定每位周期的时钟周期数目和采样点位置：

由于一位周期是由

而

波特率＝""
""时钟分频器
(Clock Divider
register)""|0x40|""D7:CAN模式。
0：基本模式。
D5:1(旁路输入比较器，仅在复位模式下起作用)。""
""OCR
(output Control)""|0x|

在完成上述初始化后，要再次初始化控制寄存器。将最低位初始化为0。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：为三轴姿态喷气控制选择推力器。                                                                                                                                                                                                                                                                                                                                                                                                                                                       输入：标志F_JetGroup，F_SatStage
姿态角与角速度：
正常模式星敏感器与陀螺定姿输出(F_NoGyro=0或2) 
，(量纲：弧度)
，(量纲：弧度/秒)
或：正常模式星敏感器定姿输出(F_NoGyro=1或3时)
(量纲：弧度)
(量纲：弧度/秒)
或：机动与轨控模式姿态输出(无量纲)，(量纲：弧度/秒)
或：其它情形相应程序的输出
，(量纲：弧度)
，(量纲：弧度/秒)
，(量纲：度)
输出：	喷气状态，
各推力器分配脉宽，
累计三轴姿控正向喷气时间：，
累计三轴姿控负向喷气时间：，
=[，]T(量纲：弧度/秒2)",0,1,0,0,0,0,0,0,0,0,0
"软件需求名称：星时获取 
需求类别：其他 
软件需求描述：计算星上星时。
处理：
应用软件通过软钟结合硬钟的方式获得星时。即在需要计算星时时，读取当前星时计数器，将上次与本次之差作为两次读入的时间差（增计数，当量1us），累计在星时变量上。 ",0,0,0,0,0,0,0,0,1,0,0
"功能描述：仅使用红外定姿时，计算正常飞行轮控所需电压。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：采集星上时钟的计数值，计算星时及作相应的处理
处理：包括CPU内部星时时钟和CPU外部星时时钟的星时采集计算与校时。
（1）CPU外部星时时钟的星时采集计算与校时
CPU外部星时时钟星时计算的输入为上一个周期对应的绝对星时t，和上个周期中控制周期星时锁存寄存器中读取的计数值为TOLD。在每个控制周期中处理过程如下：
STEP1：选取控制周期星时锁存通道，读取锁存的计算值，记为TNEW；
STEP2：计算TNEW减去TOLD的差值，记为DELTT（当量为1微秒）；
STEP3：本周期的绝对星时t=t+DELTT/1000000；
STEP4：保存本周期的计数值，即TOLD=TNEW。
CPU外部星时时钟星时校时包括OBDH校时和GPS高精度校时两种校时方式：
OBDH校时：当“OBDH星时校时开关”为允许的情况下，进行校时，要求“OBDH星时校时开关”为可内存修改的变量（默认为“OBDH星时校时开关”为“允许”），地面可通过内存修改的方式设置“OBDH星时校时开关”。也分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时；
 GPS高精度校时。
OBDH星时校时为系统默认使用的校时方式。GPS秒脉冲高精度时间是否引入系统由注入指令执行控制：若注入指令表示“使用GPS秒脉冲高精度校时时间”，则当满足GPS秒脉冲高精度校时条件时AOCC应用软件仅进行GPS秒脉冲高精度校时时间的计算，系统使用该时间。GPS秒脉冲高精度方式优先级高于OBDH星时校时，当GPS秒脉冲校时时不再进行OBDH星时校时。如果连续超过1分钟均不满足GPS秒脉冲高精度校时条件，则可进行OBDH星时校时。一旦再满足GPS秒脉冲高精度校时条件则继续采用GPS秒脉冲高精度校时。其中GPS秒脉冲高精度校时条件及校时计算具体见任务书中规定。
（2）CPU内部星时时钟的星时采集计算与校时
CPU内部星时时钟星时计算方法。同CPU外部星时时钟星时计算；CPU内部星时时钟星时校时只包括OBDH校时：分为两种情况：一种是OBDH周期性向AOCC发送卫星时间，发送周期为1分钟。另一种是当在上电和复位后，由应用软件主动发出校时申请，完成校时。
星时的选取
根据注入的姿控数据块2中的CPU星时时钟选用标志来实现内部星时时钟和外部星时时钟的切换，默认为CPU外部星时时钟
均匀校时
内部和外部时钟星时计算中在计算完本周期绝对星时后增加每周期修正量，并在计算前先将它限幅到1毫秒，每周期的修正量初始为0，通过内存修改来修改该修正量。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：数传天线数据处理
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：卫星正常运行模式之一，完成三周对地指向，包含辐射定标方式。
处理：控制分系统按照地面规划的指令在轨道A、B、C、D四个点进行姿态机动来完成日地、地日、地地之间的姿态转换。辐射标定模式下的姿态固定，由数据指令控制进入标定模式。
在该模式下，控制系统根据数据块指令提供的开始和结束时间，开始、停止对指定天线控制角度进行计算，并0.5秒向天线发送一次控制指令。
正常模式初始化需向引入的星敏发送TC_RATE_LIMIT指令，将星敏工作的最大转速设置为固定地址注入的ratelimitnormal值（高精度状态）。
每个控制周期顺序调用用户需求中的逻辑：
调用轨道与星历；
调用CMG数据采集及处理；
调用部件故障检测与信号选取；
调用陀螺的数据处理；
调用四元数陀螺预估；
调用星敏感器数据处理；
if(MoveSTSInSystemFlag=2且SSTCatchSuc＝0) 调用 星敏感器对日定向 的a项；
调用利用星敏感器的姿态确定；
调用中继天线捕获跟踪控制；
调用对地数传天线捕获跟踪控制；
调用目标姿态确定；
调用控制器输入量计算；
调用喷气卸载条件计算；
调用CMG奇异状态的判断及算法计算；
if((UnLoadMode =0  或 TimeStopC > 0.0) 
{调用CMG的控制；调用磁卸载控制；}
else {if(Flag_equation=0且TimeStopC<=0)调用相平面喷气脉宽；
调用CMG启动与保持；}
调用系统故障诊断；",0,0,0,1,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|三浮陀螺数据的采集与处理|FREQ1.2.1|""三浮陀螺1553B取数指令
""|陀螺1-6的速度增量|在通讯允许的条件下（每个三浮陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是角速率数据，通过任务书给出的公式计算
|光纤陀螺数据的采集与处理|FREQ1.2.2|""光纤陀螺LTU取数指令
""|陀螺79的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,0,0,0,1,0,0
功能描述：进行单轴相平面分区及控制规律计算。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：帆板故障检测，切换帆板LTU。
处理：
（1）帆板LTU切换的条件：
①若BZ1=3且连续650秒FSA=A太阳已捕获(帆板切换后重新开始计时)且帆板不在零位；
②若BZ1=3且FSA=A且帆板在机械零位且帆板控制信号不是取自帆板机械转角且此帆板上的模拟太阳连续5个周期不见太阳。
③如果35V帆板电压遥测变量在连续30次低于28V（28V要设计为可内存修改变量），此功能可通过注入数据块ZT38（4）启动或禁止该功能。若发生了切换，则星上自主禁止此功能，等待地面注入重新启动。
（2）帆板LTU切换后更改ZT17,连续3个0.524s周期发送帆板归零指令。     ",0,0,0,0,0,1,0,0,0,0,0
"功能描述：将陀螺有效输出数据，换算成卫星三轴角速度。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收数据指令注入块的自主诊断允许类指令,0,0,0,0,0,0,0,0,0,1,0
"功能描述：执行偏航机动及返调至运行姿态
处理过程：过程如下：
STEP1：当ZT F（不用红外+单个斜装陀螺定姿），进行姿态预估，得到姿态角和角速度。
STEP2：根据当前星时t的取值进行不同的处理：
STEP3：根据ZT7的取值，进行相应的帆板控制。
ZT7的值|处理
ZT7 = 9|发指令
ZT7 = A|发指令
ZT7 = B|发指令
",0,0,0,1,0,0,0,0,0,0,0
功能描述：三轴稳定模式下的帆板控制。,0,1,0,0,0,0,0,0,0,0,0
功能描述：确定ASS21，ASS22，ASS31，ASS32 及帆板转角的信号选取。,0,0,0,0,0,0,1,0,0,0,0
"功能描述：帆板驱动线路数据处理 
",0,0,0,0,0,0,0,0,1,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|甚高三浮陀螺数据的采集与处理|FREQ1.2.1|""甚高三浮陀螺1553B取数指令
""|陀螺1-6的速度增量|在通讯允许的条件下（每个甚高陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|甚高光纤陀螺数据的采集与处理|FREQ1.2.2|甚高光纤陀螺1553B取数指令|陀螺7-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：发送星敏陀螺数据给OBDH保存
处理：将星敏陀螺数据打包后放到星敏陀螺数据内存地址空间中。",0,0,0,0,0,0,0,0,0,0,1
功能描述：在CMG控制过程中判断CMG是否饱和而需喷气卸载；在喷气卸载过程中判断CMG是否卸载完毕。,0,1,0,0,0,0,0,0,0,0,0
功能描述：帆板未展开模式初始化,0,0,0,1,0,0,0,0,0,0,0
"功能描述：发送卫星应急控制字
处理：先将AOCC矢量字中“AOCS应急控制标志”位置1，将总线状态字服务请求位置1；OBDH检测到AOCC总线通讯状态字中的服务请求后，自动发送方式指令，从AOCC接收矢量字，判定矢量字中 “AOCS应急控制标志”位为1后，通过子地址19向AOCC发送“卫星应急控制确认字”；AOCC在接收到OBDH“卫星应急控制确认字”后，将状态字服务请求位清0，将矢量字“申请传送OBDH时间”位清0。",0,0,0,0,0,0,0,0,0,0,1
功能描述：各个模式的初始化设置。,0,0,0,1,0,0,0,0,0,0,0
功能描述：计算太阳星历、红外补偿量及光行差计算。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：根据星敏感器的输入，计算姿态偏差，角速度等。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收卫星安全控制确认字,0,0,0,0,0,0,0,0,0,1,0
功能描述：计算卫星偏流角，适用于地球椭球模型，星体姿态描述为转序。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：使用数字太阳敏感器修正姿态，估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"软件需求名称：太阳敏感器使用及通信 
需求类别：其他 
软件需求描述：与数字太阳通信，发送取数指令，获得部件数据。
处理：
在OBC每个控制周期中可能会通过串口向数太发送控制指令或者接收下传数据，见任务书时序图。 
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
太敏初始化|FREQ41|太敏初始化|B|2
太敏数据采集|FREQ42|太敏数据采集|A|3
数据解包与转换|FREQ43|数据解包与转换|A|4
太敏数据有效性判断|FREQ44|太敏数据有效性判断|A|5
太敏故障重构|FREQ45|太敏故障重构|C|
",0,0,0,0,0,0,0,0,1,0,0
"功能：利用星敏感器A、B的测量，修正姿态四元数与姿态角速度。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：完成遇有单翼帆板未展开时，抖动星体帮助帆板展开的功能。为了节省内存，将此模式的代码从PROM中去掉。若需要此模式，则通过在轨注入的方式，将此模式引入控制。
处理过程：过程如下：
STEP1：如果ZT1 = 5且ZT32 = A且C1 = A1则进行下列处理：
滚动通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP2：如果ZT1 = 5且ZT32 = A且C1 = A2则进行下列处理：
俯仰通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP3：如果ZT1 = 5且ZT32 = A且C1 = A3则进行下列处理：
偏航通道每个采样周期中发喷气脉冲（主备份同时发）。其脉冲宽度序列为+0.131，-0.262，+0.262，-0.262，… ，-0.262，+0.262，-0.131，共计120个脉冲。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。
STEP4：如果ZT1 = 5且ZT32 = A且C1 = FFFF则进行下列处理：
发四个轨控喷管同时工作的脉冲序列：脉冲宽度为0.262，0，0.262，0，… ，0.262，0，共计120个（包括宽度为0的脉冲）。。
发完上述120个脉冲以后，令ZT1 = 3，C1 = 0000。",0,0,0,1,0,0,0,0,0,0,0
功能描述：无控模式初始化,0,0,0,1,0,0,0,0,0,0,0
"功能描述：三轴稳定模式下的帆板控制。
",0,1,0,0,0,0,0,0,0,0,0
功能描述：计算CMG的框架角速度。                                                                                                                                                                                                                                                                                                                                                                                                                                                                           处理：修改奇异规避算法。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：使用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：利用估计的四元数转换姿态角，计算送给星敏感器的四元数。
",0,0,1,0,0,0,0,0,0,0,0
