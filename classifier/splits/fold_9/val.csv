Requirements Description,功能需求/初始化,功能需求/控制计算/姿态控制,功能需求/控制计算/姿态确定,功能需求/控制计算/模式管理,功能需求/控制计算/轨道计算,功能需求/控制计算/运行时保障/故障诊断和处理,功能需求/控制计算/运行时保障/数据有效性判断,功能需求/控制输出,功能需求/数据采集,功能需求/遥控,功能需求/遥测
"功能描述：0.5秒中断采集各部件数据
输出：内存单元保存的各部件数据与状态。
处理：  
     处理流程如下图所示：
                      图11：数据采集处理流程",0,0,0,0,0,0,0,0,1,0,0
"    各个模式切换的功能点列表如下：
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ5.1.0|4|主动段模式切换条件判断及转出设置
|入轨段控制模式切换|FREQ5.1.1|4.1|入轨段控制模式切换条件判断及转出设置
|正常对地运行模式切换|FREQ5.1.2|4.2|正常对地运行模式切换条件判断及转出设置
|点对点机动模式切换|FREQ5.1.3|4.3|点对点机动模式切换条件判断及转出设置
|姿态/角速度预置模式切换|FREQ5.1.4|4.4|姿态/角速度预置模式切换条件判断及转出设置
|偏置飞行模式切换|FREQ5.1.5|4.5|偏置飞行模式切换条件判断及转出设置
|匀地速跟踪模式切换|FREQ5.1.6|4.6|匀地速跟踪模式切换条件判断及转出设置
|匀角速度匀积分时间跟踪模式切换|FREQ5.1.7|4.7|一般轨迹跟踪模式切换条件判断及转出设置
|轨控模式切换|FREQ5.1.8|4.9|轨控模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ5.1.9|4.10|全姿态捕获模式切换条件判断及转出设置
|无控模式切换|FREQ5.1.10|4.11|无控模式切换条件判断及转出设置
|凝视姿态跟踪模式切换|FREQ5.1.11|4.12|凝视姿态跟踪模式切换条件判断及转出设置
|测试与标定模式切换|FREQ5.1.12|4.8|测试与标定模式切换条件判断及转出设置
|惯性定向模式切换|FREQ5.1.13|4.13|惯性定向模式切换条件判断及转出设置

切换条件具体见用户需求4。CCU切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
功能描述：由GPS得到轨道外推的16根数。,0,0,0,0,1,0,0,0,0,0,0
功能描述：GPS定轨程序。,0,0,0,0,1,0,0,0,0,0,0
"功能：利用双矢量姿态输出修正姿态估值、估计陀螺漂移及红外常值误差。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：绕本体俯仰轴转动，进行俯仰捕获。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：与星敏感器通信，获得星敏感器数据。
处理：
见星敏通信协议、任务书。
功能编号|功能|引用文档
FREQ57|初始化|星敏协议
FREQ58|星敏使用要求|任务书
FREQ59|通信|星敏协议
FREQ60|通信故障处理|任务书
FREQ61|数据解包与转换|星敏协议
FREQ62|星敏数据有效性判断、处理|任务书
FREQ63|星敏模拟量采集、处理|任务书
FREQ64|部件在轨转发（在轨修改）|任务书

3）GPS高精度校时与星敏感器数据的使用
功能描述：根据GPS秒脉冲，秒脉冲广播，进行GPS高精度校时和星敏感器时标处理。",0,0,0,0,0,0,0,0,1,0,0
CTU复位后需要从AOCC恢复重要数据和星上时间。首先CTU发送“接收用于做时间差值的时间码”指令，将CTU目前的时间发送给AOCC。AOCC将星上时间和接收到的CTU时间做差值处理，将AOCC时间-CTU时间保存。CTU在1s后发送“发送时间差值”指令，AOCC将保存的时间差值发送给CTU。,0,0,0,0,0,0,0,0,0,0,1
"功能描述：仅利用星敏感器A的测量，修正姿态四元数与姿态角速度移。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的系统轨控调姿及轨控姿态控制系数,0,0,0,0,0,0,0,0,0,1,0
"功能描述：利用C头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.12。
STEP1：计算，将下标A换成C；FM3更改：若，则：，FSTD=1；
STEP2：计算。的各项乘以，的各项乘以。将下标A换成C；
STEP3：计算q；
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：实时计算卫星轨道参数及太阳方位，太阳敏感器理论输出。
处理：同用户需求的4.2。为防止t-t0过大导致系统切机，在轨道计算中增加时间超差不调用轨道计算，仅外推轨道幅角；太阳星历的计算仍然调用。
STEP1：计算卫星轨道根数。计算公式见4.2(1)；
STEP2：计算太阳轨道和太阳敏感器理论输出，其中岁差补偿公式有更改，Cbo的计算公式改用红外定姿姿态。计算公式见4.2(2)；
STEP3：若FlagIresOrbSun=0，则FHSL=FHSR=1左右红外都不见太阳。FlagIresOrbSun是注入内存修改变量，若注入修改令FlagIresOrbSun=1，则引入红外软件见太阳保护。
STEP4：若计算的轨道半径r和相差以上，或计算的轨道角速度和0.001108rad/s相差0.00008以上，则判定轨道计算偏差太大，置BZ2=4，同时置r=6871，=0.001108，。",0,0,0,0,1,0,0,0,0,0,0
"功能描述：CAN通信上行/下行数据的组帧和解包。
调用条件：每个控制任务模式计算完成后；
输入：计算结果。
输出：按照协议组帧数据。
处理：主要完成下列数据组帧、解包功能：星务接收、星务发送、快帧遥测1打包、快帧遥测2打包、快帧遥测3打包、快帧遥测4打包、快帧遥测5打包、姿态广播、星敏广播、陀螺广播、重要数据打包、上行:数据指令响应处理、上行:固定地址注入解包、上行:可变地址注入解包、上行:轨道注入解包、上行:程序注入、上行:内存下卸指令注入、上行:任务块、上行:地面站、重要数据返回解包、GPS定位广播解包、整星广播对时解包、GPS高精度秒脉冲对时广播解包、CAN总线使用要求",0,0,0,0,0,0,0,0,0,0,1
"功能描述：对目标轨迹进行初始化，供姿态机动使用
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：由模拟太阳A/B码、监视码得到模拟太阳角、见太阳标志。
处理：
以0.25~0.30太阳常数作为门槛值，2路监视码电压信号均高于门槛值时，设置该模拟太阳输出信号有效。在模拟太阳敏感器输出有效前提下，按下面定出的计算公式，对采集的2路A/B码信号进行处理，最终获得模拟太阳敏感器的输出。
测量角，最小码当量0.
上式中XA，XB分别对应2路A/B码中A码和B码的信号输出。
当监视码输出有效且测量角绝对值大于19.6875时，需要进行饱和处理，输出19.6875，极性不变。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：置卫星姿态无控，处于自由飞行状态。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：执行偏航机动及返调至运行姿态
处理过程：过程如下：
STEP1：当ZT F（不用红外+单个斜装陀螺定姿），进行姿态预估，得到姿态角和角速度。
STEP2：根据当前星时t的取值进行不同的处理：
STEP3：根据ZT7的取值，进行相应的帆板控制。
ZT7的值|处理
ZT7 = 9|发指令
ZT7 = A|发指令
ZT7 = B|发指令
",0,0,0,1,0,0,0,0,0,0,0
"|需求名称|编号|输入章节号|功能描述
|卫星轨道参数外推计算|FREQ2.0|5.1.1|实时计算卫星轨道参数。
|轨道外推根数获取与星历计算|FREQ2.1|5.1.2|岁差章动计算、GPS 轨道数据判断、太阳星历、地面站位置、地磁场强度计算
|GPS轨道数据有效性判断|FREQ2.2|5.1.2.2|对GPS轨道数据的有效性进行判断
|GPS 通道版和轨道版轨道计算|FREQ2.3|5.1.2.2.1和5.1.2.2.2|利用GPS 通道版和轨道版数据进行GPS 定轨程序
| 系的卫星位置及速度计算|FREQ2.4|5.1.2.5|将J2000 系的卫星位置与速度转换为WGS84 系的位置和速度
|近圆中低轨卫星轨道根数外推算法产品规范|FREQ2.5|/|规范化算法：
|近圆中低轨卫星GPS轨道计算算法产品规范|FREQ2.6|/|规范化算法：
|岁差章动矩阵计算算法产品规范|FREQ2.7|/|规范化算法：
|4阶星上地磁场计算方法算法产品规范|FREQ2.8|/|规范化算法：
|光行差计算算法产品规范|FREQ2.9|/|规范化算法：
|自主轨控计算及发送请求|FREQ2.10.0|5.1.2.6|根据实际与标称轨道参数计算轨控参数，并进行轨控申请
|自主轨控计算初始化|FREQ2.10.1|5.1.2.6.1|进行自主轨控远地点选取和轨控时间计算
|发送自主轨控请求|FREQ2.10.2|5.1.2.6.2|发送轨控加温请求，判断是否可以进行自主轨控
",0,0,0,0,1,0,0,0,0,0,0
"功能描述：在轮控机动模式下，轮控滚动/俯仰机动过程中规划目标姿态确定，确定机动力矩和轮子组合。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据陀螺输入，预估卫星对地姿态。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：搜索地球，直到红外有地球信息。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收遥控注入数据块1、2、3、4、5、6、7
处理：将接收AOCC系统注入参数存储地址中内容解包成对应的参数和变量的数据格式。如果128＜遥控注入数据块长度≤256字节，将数据不足256字节部分以AA16填充，按照“遥控注入数据块结构分为遥控注入数据块1～4，按照子地址（1～4）顺序向AOCC连续发送；如果64＜遥控注入数据块长度≤128字节，将数据不足128字节部分以AA16填充，按照“遥控注入数据块结构分为遥控注入数据块5、6，按照子地址（5、6）顺序向AOCC连续发送；如果遥控注入数据块长度≤64字节，将不足64字节部分以AA16填充，按照“遥控注入数据块结构通过子地址11将数据发送给AOCC；各个上行注入块的格式如表 44所示：
表 44：各个上行注入块的格式
块类型识别字|块类型名称|块长度（字节）|指令
1B H|AOCC程序块|256N|接收遥控注入数据块1、2、3、4
EB H|AOCC轨道数据块|128|接收遥控注入数据块5、6
27 H|AOCC姿控数据块|64|接收遥控注入数据块7
28 H|AOCC系数数据块|64|接收遥控注入数据块7
41 H|AOCC轨控命令块|64|接收遥控注入数据块7
4E H|AOCC太阳翼命令块|256|接收遥控注入数据块1、2、3、4
7D H|AOCC内存修改块|64|接收遥控注入数据块7
BEH|AOCC中继星轨道数据块|128|接收遥控注入数据块5、6
69H|AOCC结构滤波器系数数据块|128|接收遥控注入数据块5、6
C3H|AOCC中继天线安装修订系数块|64|接收遥控注入数据块7

根据上行注入块的大小，可以把上行注入块分成三种，分别为256字节，128字节和64字节。相应AOCC接收遥控注入的处理程序也分为三种，分别对应256字节，128字节和64字节的处理程序。
接收64字节遥控注入处理程序流程如下图所示
图17: 接收64字节遥控注入处理程序流程
2）接收128字节遥控注入处理程序流程如下图所示
图18: 接收128字节遥控注入处理程序流程
3）接收256字节遥控注入处理程序流程如下图所示
图19: 接收256字节遥控注入处理程序流程
若ZT8≠0，则BZ7=ZT8。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：利用A头的测量数据修正与估计陀螺漂移。
处理：同用户需求的4.10
STEP1：计算；FM3更改：若，则：，FSTD=1；
STEP2：计算，。的各项乘以，的各项乘以。
STEP3：计算q；
STEP4：将32位定点数转换成24位浮点数；
STEP5：计算。",0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据注入轨道参数计算地磁场强度。
处理：
由星时和外推轨道数据星上实时计算地磁场强度。",0,0,0,0,1,0,0,0,0,0,0
"功能描述：为三轴姿态喷气控制选择推力器。                                                                                                                                                                                                                                                                                                                                                                                                                                                       输入：标志F_JetGroup，F_SatStage
姿态角与角速度：
正常模式星敏感器与陀螺定姿输出(F_NoGyro=0或2) 
，(量纲：弧度)
，(量纲：弧度/秒)
或：正常模式星敏感器定姿输出(F_NoGyro=1或3时)
(量纲：弧度)
(量纲：弧度/秒)
或：机动与轨控模式姿态输出(无量纲)，(量纲：弧度/秒)
或：其它情形相应程序的输出
，(量纲：弧度)
，(量纲：弧度/秒)
，(量纲：度)
输出：	喷气状态，
各推力器分配脉宽，
累计三轴姿控正向喷气时间：，
累计三轴姿控负向喷气时间：，
=[，]T(量纲：弧度/秒2)",0,1,0,0,0,0,0,0,0,0,0
"各个模式切换的功能点列表如下：
序号|功能编号|功能
|FREQ51|主动段模式切换
|FREQ51.1|入轨段控制模式切换
|FREQ51.2|巡天观测模式切换
|FREQ51.3|定点观测模式切换
|FREQ51.4|小天区扫描模式切换
|FREQ51.5|姿态机动切换
|FREQ51.6|轨控模式切换
|FREQ51.7|捕获太阳并对日定姿模式切换
|FREQ51.8|帆板未展开切换
|FREQ51.9|无控模式切换
|FREQ51.10|应急模式模式切换
|FREQ51.0|主动段模式初始化
|FREQ51.1.0|入轨段控制模式初始化
|FREQ51.2.0|巡天观测模式初始化
|FREQ51.3.0|定点观测模式初始化
|FREQ51.4.0|小天区扫描模式初始化
|FREQ51.5.0|姿态机动初始化
|FREQ51.6.0|轨控模式初始化
|FREQ51.7.0|捕获太阳并对日定姿模式初始化
|FREQ51.8.0|帆板未展开初始化
|FREQ51.9.0|无控模式初始化
|FREQ51.10.0|应急模式模式初始化

工作模式的转换条件及对应的模式初始化内容具体见用户需求4。
AOCC切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
功能描述：接收同步字,0,0,0,0,0,0,0,0,0,1,0
"功能描述：减小卫星的俯仰角。
输入：陀螺数据输出 ，
红外数据有效性标志F_IresValid（由有效性判据给出）
红外数据处理（全姿态捕获）的输出，
上周期姿态角估值，
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：无陀螺时用红外估计滚动、俯仰姿态角及角速度信息。
输入：前两个周期、上个周期得到的，
红外处理数据，
红外常值偏差估值，（量纲：弧度）
红外数据有效性标志F_IresValid(由有效性判据给出)
红外工作周期（=0.75s）
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收GPS数据
处理：将接收GPS数据存储地址中内容解包成对应的UTC时间、位置和速度数据、定轨数据和GPS秒脉冲对应的整秒时刻的数据格式。由于GPS数据中有数据有效性标志，所以其中的微秒部分不考虑大于1秒的情况，由GPS保证。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：模式2切换方式。
处理：
FailureFlag=4且AutoInStopNum<2时，置WorkMode=8，SpeedControlTime＝0，AutoInStopNum=AutoInStopNum+1；
满足进入应急模式的条件则进入应急安全模式，置WorkMode=9；",0,0,0,1,0,0,0,0,0,0,0
"功能描述：滚动/俯仰姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉角，以及轨迹的加速、匀速和减速等特征时间点。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：检测工作中的动量轮的故障并切换。,0,0,0,0,0,1,0,0,0,0,0
OBDH分系统每8分钟给AOCC校时一次。,0,0,0,0,0,0,0,0,0,1,0
功能描述：计算磁卸载所需的磁矩与磁力矩器工作电压,0,1,0,0,0,0,0,0,0,0,0
"功能描述：根据天线安装定义和地面站坐标，实时计算天线和地面站的夹角。
",0,0,1,0,0,0,0,0,0,0,0
"软件需求标识：FREQ19 
软件需求名称：星敏数据处理 
需求类别：其他 
软件需求描述：星敏数据处理。",0,0,0,0,0,0,0,0,1,0,0
"太阳捕获控制的流程如下：
  if(WacFlag=2) 调用太阳搜索；
  else if(WacFlag=3) 调用对太阳定向；
  else if(WacFlag=4) 
{if (SSTCatchSuc＝0) 调用星敏感器对日定向；
else {  调用四元数陀螺预估；
调用、利用星敏感器的姿态确定；}
}
  else 调用速率阻尼。",0,1,0,0,0,0,0,0,0,0,0
"功能描述：与发动机通信，输出本周期喷气脉宽。
处理：
功能编号|功能|引用文档|备注
FREQ52|UPS初始化|任务书|B
FREQ53|化学推进数据采集|任务书|B
FREQ54|推力器脉冲输出|任务书|B
FREQ55|推力器健康字设置|任务书|B
FREQ56|部件操作（程控490N点火，故障重构）|任务书|B
",0,0,0,0,0,0,0,1,0,0,0
"功能描述：实时计算卫星轨道参数及太阳方位、太阳敏感器理论输出。
处理：其中除的精确计算算法外为可复用需求，可使用软件中心的构件库中的软件代码。",0,0,0,0,1,0,0,0,0,0,0
"功能描述：星上自主检测推进系统故障。
",0,0,0,0,0,1,0,0,0,0,0
功能描述：发送控制对中继天线的控制角度。,0,0,0,0,0,0,0,1,0,0,0
"功能描述：发送姿态数据包1
",0,0,0,0,0,0,0,0,0,0,1
"功能：利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收内存设置命令
处理：将内存设置命令存储地址中内容的解包成需下传的内存首地址和长度。此处理在中断中进行。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：发送姿态数据
处理：
AOCC每个控制周期（250ms）组织28个字节姿态数据，OBDH每500ms取1次姿态数据（56个字节）。每个数据包中的2个姿态的时标需按照时间顺序排列。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：CMG数据处理
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：部件加电标志。与光纤陀螺通信功能。
处理：
见陀螺通信协议、任务书附录1时序。
功能编号|功能|引用文档|备注
FREQ33|陀螺接口初始化|陀螺协议|B
FREQ34|陀螺数据采集|陀螺协议|A
FREQ35|数据解包与转换|陀螺协议|A
FREQ36|陀螺数据有效性判断、处理|任务书|A
FREQ37|陀螺故障重构|任务书|C
",0,0,0,0,0,0,0,0,1,0,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ3.1|5.2.1|把陀螺数据、、、变换到星体系中的、、
|陀螺预估惯性姿态|FREQ3.2|5.2.2|根据陀螺输入，预估卫星惯性姿态
|陀螺预估惯性四元数|FREQ3.4|5.2.4|根据陀螺测量输出，一步预估卫星惯性姿态
|动力学预估惯性四元数|FREQ3.5|5.2.5|根据动力学模型，预估卫星惯性姿态
|星敏感器与陀螺姿态修正|FREQ3.7|5.2.7|利用星敏感器和陀螺的输出或仅利用陀螺预估输出计算卫星欧拉角和四元数
|单星敏感器的姿态修正|FREQ3.7.1|5.2.7.1|利用单个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|双星敏感器的姿态修正|FREQ3.7.2|5.2.7.2|利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|对地姿态修正|FREQ3.7.3|5.2.7.3|利用估计的四元数转换姿态角
|星敏感器与动力学姿态修正|FREQ3.8|5.2.8|利用星敏感器的输出计算卫星欧拉角和四元数
|仅单星敏感器的姿态修正|FREQ3.8.1|5.2.8.1|仅利用单个星敏感器的测量，修正姿态四元数与姿态角速度
|仅双星敏感器的姿态修正|FREQ3.8.2|5.2.8.2|仅利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|无陀螺对地姿态修正|FREQ3.8.3|5.2.8.3|利用估计的四元数转换姿态角，送给星敏感器的四元数
|星敏感器相对基准标定|FREQ3.10|5.2.11|对星敏的相对基准进行标定，修正星敏安装矩阵
|星敏感器双矢量姿态确定|FREQ3.11.1|5.2.14.1|利用星敏的测量，确定单点的卫星姿态四元数。
|星敏姿态四元数重置|FREQ3.11.2|5.2.14.2|进行卫星姿态四元数的重置
|姿态四元数预估算法产品规范|FREQ3.1.2|/|规范化算法：
|重力梯度力矩计算算法产品规范|FREQ3.1.3|/|规范化算法：
|基于单星敏感器测量矢量叉乘信息的滤波修正算法算法产品规范|FREQ3.1.5|/|规范化算法：
|基于双星敏感器测量矢量叉乘信息的滤波修正算法产品规范|FREQ3.1.6|/|规范化算法：
|星敏感器相对基准的在轨标定算法产品规范|FREQ3.1.8|/|规范化算法：
|目标姿态计算流程|FREQ3.12|5.3.2|""计算模式的目标姿态
""
|对地定向目标姿态计算|FREQ3.12.0|5.3.2.1|对地定向目标姿态计算
|点对点机动目标姿态计算|FREQ3.12.1|5.3.2.2|点对点机动目标姿态计算
|姿态预置过程目标姿态计算|FREQ3.12.3|5.3.2.3|姿态预置过程目标姿态计算
|非沿迹跟踪阶段目标姿态计算|FREQ3.12.4|5.3.2.4|角速度建立过程目标姿态计算
|轨控目标姿态计算|FREQ3.12.5|5.3.2.5|轨控目标姿态计算
|凝视过程目标姿态计算|FREQ3.12.6|5.3.2.6|凝视过程中计算三轴目标姿态
|正常对日巡航目标姿态计算|FREQ3.12.7|5.3.2.7|正常对日巡航目标姿态计算
|姿态机动初始化|FREQ3.13.1|5.3.1.1|三轴姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉轴/角，以及轨迹的加速，匀速和减速等特征时间点。
|非沿迹跟踪轨迹初始化|FREQ3.13.2|5.3.1.2|匀地速、匀角速度、匀积分时间非沿迹跟踪初始化，计算地心张角和方向矢量等
|轨控姿态机动轨迹初始化|FREQ3.13.4|5.3.1.4|轨控模式目标姿态计算初始化
|计算多项式轨迹系数|FREQ3.13.5|5.3.3.1|根据轨迹规划时间，初始姿态/姿态角速度和目标姿态/姿态角速度计算基于多项式轨迹规划的轨迹系数
|姿态预置机动目标姿态确定|FREQ3.13.6|5.3.3.2|基于多项式曲线的轨迹规划，计算目标姿态
|非沿迹目标姿态角计算|FREQ3.13.8|5.3.4|根据所指定的扫描起始经纬度和末端点经纬度
|偏流角计算|FREQ3.13.9|5.3.5|适用于地球椭球模型，星体姿态描述为转序，计算基于星体光轴(与星本体＋Z轴平行)下的偏流角
|轨道角速度建立目标姿态计算|FREQ3.13.10|5.3.6|在惯性定向与轨道系姿态保持之间切换时，进行轨道角速度的建立或削除
|姿态控制量计算|FREQ3.19|5.2.12|根据姿态确定结果和目标姿态计算结果计算误差姿态角和误差姿态角速度
|引入系统闭环姿态确定|FREQ3.20|5.2.13|根据定姿标志确定引入系统的闭环姿态
|正弦轨迹规划算法算法产品规范|FREQ3.12.7|/|规范化算法：
|基于加速度导数为正弦函数的轨迹规划算法算法产品规范|FREQ3.12.8|/|规范化算法：
",0,0,1,0,0,0,0,0,0,0,0
功能描述：发送红外太阳敏感器数据包,0,0,0,0,0,0,0,0,0,0,1
"功能描述：将注入到SRAM中的程序搬家至相应EEPROM区
处理：
- 将解包得到的目的地址、注入长度、源地址分别赋给变量E2_StartAddress, E2_Length, SourceAddress；
- 调用系统软件提供的函数E2prom_Prog(unsigned int E2_StartAddress, unsigned int E2_Length, unsigned int SourceAddress)
说明：应用软件需要考虑跨页操作，地面保证发送“启动EEPROM修改”指令后，10ms内不对EEPROM进行操作。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：接收数据指令注入块的部件使用选择类指令
处理：
序号37使用四个陀螺定姿和序号38使用三个陀螺定姿初值更改，改为默认使用3个陀螺。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：根据红外输出，估计卫星姿态与陀螺漂移。
输入： 姿态估计值
红外测量的新息
陀螺漂移估值
标志F_IresUsed",0,0,1,0,0,0,0,0,0,0,0
"功能描述：输出磁力矩器控制电源。
处理：
功能编号|功能|引用文档
FREQ98|初始化|任务书
FREQ99|磁力矩器使用要求|任务书
FREQ100|通信(DA)|任务书
FREQ101|通信故障处理|预留
FREQ102|数据解包与转换|预留
FREQ103|磁力矩器数据有效性处理|预留
FREQ104|磁力矩器硬件采集、处理|任务书
FREQ105|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,1,0,0,0
功能描述：根据太阳矢量在帆板2法平面内投影与帆板法线之间的夹角，通过帆板驱动机构2控制帆板2，使帆板2能捕获及跟踪太阳。,0,1,0,0,0,0,0,0,0,0,0
"需求名称|功能描述
部件数据有效性判断|对部件采样数据的有效性进行判断，并选择引入闭环控制系统的数据
陀螺数据有效性判断|判断定姿用陀螺数据的有效性，选择参与定姿的陀螺
星敏感器数据有效性判断|对星敏感器输出数据进行有效性判断，并选取定姿星敏组合
数字太阳敏感器数据有效性判断|对数字太阳敏感器输出数据进行有效性判断
RS422通讯故障诊断|进行RS422通讯故障诊断及处理
平台陀螺通讯诊断及处理|进行平台陀螺通讯故障诊断及处理
数字太阳通讯诊断及处理|进行数字太阳通讯故障诊断及处理
太阳模拟量通讯诊断及处理|进行太阳通讯故障诊断及处理
对地数传天线通讯诊断及处理|进行对地数传天线通讯故障诊断及处理
1553B内总线通讯故障诊断|进行1553B内总线通讯故障诊断及处理
多头星敏通讯故障诊断|多头星敏通讯故障诊断及处理
1553B内总线总线监视及处理要求|CCU作为内1553B总线的BC，在与各RT通讯时需要进行总线状态监视
SpaceWire内总线通讯故障诊断|进行SpaceWire内总线通讯故障诊断
SpaceWire外总线通讯故障诊断|进行SpaceWire外总线通讯故障诊断
CAN总线通讯故障诊断|进行CAN总线通讯故障诊断
同步串口通讯故障诊断|进行同步串口通讯故障诊断
CMG通讯诊断及处理|进行CMG通讯故障诊断及处理
部件故障诊断|对部件进行故障诊断
陀螺故障诊断|由平衡方程方法、星敏感器数据、以及动力学输出对陀螺进行故障检测
CMG故障诊断|根据CMG输出数据和理论数据进行CMG故障检测
推进喷气异常检测|检测推力器微漏、过量喷气等，必要时作相应的主备份切换和禁止
系统故障检测|根据姿态角和姿态角速度偏差数据进行系统故障的检测",0,0,0,0,0,0,1,0,0,0,0
"功能：利用星敏感器B 、C的测量，修正姿态四元数与估计角速度。
",0,0,1,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|姿态控制算法|FREQ4.0|5.4|选择控制方式，并计算控制输出
|喷气控制|FREQ4.1|5.4.1|为三轴姿态喷气控制选择喷管；并记录喷气时间等
|轮控说明|FREQ4.2|5.4.2.1|计算动量轮安装阵及电压分配阵，标称角动量
|轮系摩擦补偿电压计算|FREQ4.3|5.4.2.2|""轮系摩擦力矩的补偿电压计算
""
|动量轮启动与保持|FREQ4.4|5.4.2.3|启动动量轮至标称角动量，并保持
|正常飞行动量轮分配电压计算|FREQ4.5|5.4.2.4|计算正常飞行轮控所需电压
|偏置动量轮分配电压计算|FREQ4.6|5.4.2.5|""计算偏置动量控制时候所需的轮控电压
""
|大力矩飞轮启动与保持|FREQ4.7|""5.4.3.1
""|启动飞轮至标称角动量或角动量维持
|大力矩飞轮控制电压计算|FREQ4.8|""5.4.3.2
""|计算机动或正常模式下保持时的大力矩飞轮控制电压
|喷气卸载条件计算|FREQ4.9|5.4.4|喷气卸载进入和退出条件计算
|磁卸载控制|FREQ4.10|5.4.5|根据合成角动量及地磁场强度决定并输出磁棒控制电压
|地面站位置计算|FREQ4.11|5.6.1|地面站赤经赤纬计算
|运行段帆板控制|FREQ4.12|5.5.1|三轴稳定模式下的帆板控制
|太阳帆板自主跟踪控制|FREQ4.13|5.5.2|根据帆板角误差、控制帆板跟踪太阳
|数传天线指向控制|FREQ4.14|5.6.1.1|根据指令完成数传天线的指向控制
|中继轨道计算|FREQ4.22|5.7.1|中继卫星轨道确定。
|中继天线指向控制|FREQ4.23|5.7|根据指令完成中继天线的指向控制
|动量轮转速保持算法产品规范|FREQ4.15|/|规范化算法：
|直线型相平面喷气姿态控制算法产品规范|FREQ4.16|/|规范化算法：
|""基于零空间的N个动量轮的角动量自调整算法产品规范
""|FREQ4.17|/|规范化算法：
|四阶结构滤波器算法产品规范|FREQ4.18|/|规范化算法：
|连续电压式磁卸载算法产品规范|FREQ4.19|/|规范化算法：
|地面目标矢量计算算法产品规范|FREQ4.20|/|规范化算法：
|""基于三轴角动量反馈的偏置动量控制方法产品规范
""|FREQ4.21|/|规范化算法：
|双脉冲变轨|FREQ4.22|""任务书的
4.2.3""|根据地面注入的指令可实现两次轨控的功能
|数传天线指向目标角计算|FREQ4.14.2|5.6.2|根据指定跟踪数传天线与其被指定跟踪站的方位，计算其跟踪转角
|数传天线指向目标角平滑处理|FREQ4.14.3|5.6.3|由设定加速度与角速度极限约束，对目标转角平滑处理
|数传运动扰动力矩计算|FREQ4.14.4|5.6.4|根据天线运动信息计算对星体质心扰动力矩
|数传角速度控制指令计算|FREQ4.14.5|5.6.5|计算以角速度指令跟踪控制量
|中继天线指令转角计算|FREQ4.23.2|5.7.2|根据指令完成中继天线的捕获跟踪控制
|中继天线扫描指令计算|FREQ4.23.3|5.7.3|根据指令完成中继天线的捕获跟踪控制
|中继天线指向目标角平滑处理|FREQ4.23.4|5.7.4|由设定加速度与角速度极限约束，对目标转角平滑处理
|中继运动扰动力矩计算|FREQ4.23.5|5.7.5|根据天线运动信息计算对星体质心扰动力矩
|中继角速度控制指令计算|FREQ4.23.6|5.7.6|计算以角速度指令跟踪控制量
|外扰力矩估计|FREQ4.24|5.4.2.6|星体扰动力矩实时估计
|姿态机动时的动量轮角动量自调整|FREQ4.25|5.4.2.7|对星体进行姿态机动时的动量轮角动量进行调整
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：，
输出：保持角动量所需电压，
      角动量偏差积分项：，",0,1,0,0,0,0,0,0,0,0,0
"功能描述：发送星敏陀螺数据给OBDH保存
处理：将星敏陀螺数据打包后放到星敏陀螺数据内存地址空间中。
星敏陀螺数据组帧时，对本周期未取到星敏数据、陀螺数据的处理，以及校验和的计算方法与《 卫星控制分系统AOCC与数传分系统数据处理器通讯协议》文件中向数传分系统发送的星敏陀螺数据要求一致。",0,0,0,0,0,0,0,0,0,0,1
功能：利用星敏感器A、C的测量，修正姿态四元数与估计陀螺漂移。,0,0,1,0,0,0,0,0,0,0,0
功能描述：接收数据指令注入块的自主诊断允许类指令,0,0,0,0,0,0,0,0,0,1,0
"    各个模式切换的功能点列表如下： 
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ43.0|3.3.0|主动段模式切换条件判断及转出设置
|入轨消初偏模式切换|FREQ43.1|3.3.1|入轨消初偏模式切换条件判断及转出设置
|红外引入对地粗定向模式切换|FREQ43.2|3.3.2|红外引入对地粗定向模式切换条件判断及转出设置
|动量轮启动模式切换|FREQ43.3|3.3.3|动量轮启动模式切换条件判断及转出设置
|正常轨道运行模式切换|FREQ43.4|3.3.4|正常轨道运行模式切换条件判断及转出设置
|轨控模式1模式切换|FREQ43.5|3.3.5|轨控模式1模式切换条件判断及转出设置
|由正常姿态进行姿态机动模式切换|FREQ43.6|3.3.6|由正常姿态进行姿态机动模式切换条件判断及转出设置
|轨控模式2模式切换|FREQ43.7|3.3.7|轨控模式2模式切换条件判断及转出设置
|由轨控姿态机动回正常轨道运行模式切换|FREQ43.8|3.3.8|由轨控姿态机动回正常轨道运行模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ43.9|3.3.9|全姿态捕获模式切换条件判断及转出设置
|应急安全模式模式切换|FREQ43.10|3.3.10|应急安全模式模式切换条件判断及转出设置
|停控模式切换|FREQ43.11|3.3.11|停控模式切换条件判断及转出设置
|帆板未展开模式切换|FREQ43.12|3.3.12|帆板未展开模式切换条件判断及转出设置
|偏置动量控制模式切换|FREQ43.13|3.3.13|偏置动量控制模式切换条件判断及转出设置

切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
"软件需求名称：应用软件初始化 
需求类别：其他 
软件需求描述：初始化函数为void AppInit(void )。在上电/复位时，系统软件调用此函数来完成应用软件的初始化。见“任务书”4.1.2.1“初始化函数”。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：采集0-1太阳的数据，并处理成需要的数据格式。
处理：从I/O口数据采集0-1太阳敏感器的信号",0,0,0,0,0,0,0,0,1,0,0
"功能描述：当AOCC出现故障时，转入应急线路进行卫星姿态应急控制。
处理
在应急安全模式下，姿态控制工作交由M完成。
应用软件判断进入应急安全模式后，进行下列状态设置：
进入应急模式后，主备份ALTU被M断电，5个CMG的高速断电，低速框架当前位置保持；
	设置控制模式为“应急安全模式”；
	继续进行控制分系统星时计算；
	敏感器信息采集，继续进行轨道和姿态计算；
	磁力矩器和喷气控制量输出均为0，CMG输出全0无效指令，AOCC继续根据当班标志与ALTU 进行通信，并遥测每个控制周期通信状态，对通信失败次数进行循环累计，但不进行通讯故障诊断切换；
	停止对天线控制计算，通信；
	继续响应星务分系统的通信要求。
应用软件退出应急安全模式时，进行下列状态设置：
	发数据遥控指令“太阳捕获模式”，使AOCC退出应急安全模式，进入太阳捕获模式。
	确定ALTU通讯正常后，发星务直接遥控指令给断电；AOCC查询加电标志（地址见表3-3），进行3取2判断，若连续16个控制周期为断电状态且允许退出应急模式，AOCC退出应急安全模式，进入太阳捕获模式",0,0,0,1,0,0,0,0,0,0,0
"功能描述：完成重新捕获地球，转对地三轴稳定的功能
处理过程：过程如下：
STEP1：进行红外数据采集及处理并将磁力矩器的输出电压设置为0。
STEP2：根据地球捕获的标志FEA的取值进行不同的处理：
FEA的取值|处理
FEA = A|""进行姿态预估，得到姿态角和角速度
令，
，
进行运行段喷气姿态控制	""
FEA = 5或0|""若ZT36=F，则进行星敏感器全姿态捕获
否则进行偏航捕获及转对地定向""

STEP3：根据ZT7的取值，进行相应的帆板控制。
根据ZT36的取值有两种捕获方式（星敏感器全姿态捕获和偏航捕获及转对地定向）：若ZT36=F，则进行星敏感器全姿态捕获，否则进行偏航捕获及转对地定向。FEA有三种状态0、5、A，两种捕获方式下，FEA的状态转换图如图13和图14所示：
图 13：星敏感器全姿态捕获中FEA的状态转移图
图 14：偏航捕获及转对地定向中FEA的状态转移图
其中FPA置A的条件是且",0,0,0,1,0,0,0,0,0,0,0
"功能描述：仅利用星敏感器B的测量，修正姿态四元数与姿态角速度移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：确定ASS21，ASS22，ASS31，ASS32及帆板角度传感器，等的信号的选取。
处理：同用户需求的5.1。
——5.1（2）；;",0,0,1,0,0,0,0,0,0,0,0
"功能描述：校正星上星时。
输入：星上星时变量、均匀校时间隔、均匀校时时间、全量校时时间、增量校时时间、星务校时时间、相关数据指令。
输出：校正后的星上当前星时变量。
",0,0,0,0,0,0,0,0,1,0,0
功能描述：根据CMG所对应的期望角动量与CMG产生的实际角动量之差，自主诊断CMG的工作状态。,0,0,0,0,0,1,0,0,0,0,0
功能描述：发送模拟量遥测数据包2,0,0,0,0,0,0,0,0,0,0,1
功能描述：偏置动量轮处于力矩模式，根据红外或星敏测量信息计算得到的滚动角和俯仰角实现三轴姿态控制。滚动、俯仰轴采用角动量反馈方式控制，偏航轴采用耦合控制。,0,1,0,0,0,0,0,0,0,0,0
功能描述：进行部件通讯与选用、数据采集与处理、自检与校时。,0,0,0,0,0,0,0,0,1,0,0
"功能描述：接收GPS轨道板定位数据
处理：保存GPS轨道板定位数据，35V帆板电压遥测用于帆板故障检测。",0,0,0,0,0,0,0,0,0,1,0
"序|需求名称|编号|输入章节号|功能描述
|卫星轨道参数外推计算|FREQ2.0|5.1.1|实时计算卫星轨道参数。
|轨道外推根数获取与星历计算|FREQ2.1|5.1.2|岁差章动计算、GPS 轨道数据判断、太阳星历、地面站位置、地磁场强度计算
|GPS轨道数据有效性判断|FREQ2.2|5.1.2.2|对GPS轨道数据的有效性进行判断
|GPS 通道版和轨道版轨道计算|FREQ2.3|5.1.2.2.1和5.1.2.2.2|利用GPS 通道版和轨道版数据进行GPS 定轨程序
| 系的卫星位置及速度计算|FREQ2.4|5.1.2.5|将J2000 系的卫星位置与速度转换为WGS84 系的位置和速度
|近圆中低轨卫星轨道根数外推算法产品规范|FREQ2.5|/|规范化算法：
|近圆中低轨卫星GPS轨道计算算法产品规范|FREQ2.6|/|规范化算法：
|岁差章动矩阵计算算法产品规范|FREQ2.7|/|规范化算法：
|4阶星上地磁场计算方法算法产品规范|FREQ2.8|/|规范化算法：
|光行差计算算法产品规范|FREQ2.9|/|规范化算法：
|自主轨控计算及发送请求|FREQ2.10.0|5.1.2.6|根据实际与标称轨道参数计算轨控参数，并进行轨控申请
|自主轨控计算初始化|FREQ2.10.1|5.1.2.6.1|进行自主轨控远地点选取和轨控时间计算
|发送自主轨控请求|FREQ2.10.2|5.1.2.6.2|发送轨控加温请求，判断是否可以进行自主轨控
|牛顿插值法|FREQ2.1.2|6.1.25|根据一组已知时刻函数值，推断任意时刻函数值
",0,0,0,0,1,0,0,0,0,0,0
"序|需求名称|编号|功能及处理描述
|加电状态的采集与处理|FREQ7.1|从SDC获取部件供电状态信息
|切换指令的处理|FREQ7.2|发送SDC指令。
",0,0,0,0,0,0,0,0,1,0,0
功能描述： CMG数据处理。,0,1,0,0,0,0,0,0,0,0,0
功能描述：由数字太阳粗码得到数字太阳角、全开码、见太阳标志。,0,0,0,0,0,0,0,0,1,0,0
"软件需求名称：动量轮使用及通信（5m不配置） 
需求类别：其他 
软件需求描述：与动量轮通信，输出本周期电压。采集动量轮电源状态、转速、模拟量等信息。
处理：
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
动量轮初始化|FREQ57|动量轮初始化|B|2
动量轮数据采集|FREQ58|动量轮数据采集|B|3
通信(DA输出、脉冲输入)|FREQ59|通信(DA输出、脉冲输入)|B|4
数据解包与转换|FREQ60|数据解包与转换|B|
",0,0,0,0,0,0,0,1,0,0,0
功能描述：释放CMG群积累的角动量。,0,1,0,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|给VIPPCU发送轮询和校时包|FREQ1.8.1|""无
""|校时等数据|在每个控制周期与VIPPCU通讯时，在“轮询与校时包”中发送本周期的控制UTC时间
|VIPPCU加电状态状态数据的采集与处理|FREQ1.8.2|""加电状态
""||CCU通过采集来自VIPPCU的 “VIPPCU A机加电状态”、“VIPPCU B机加电状态”两个0～5V模拟量，来确定VIPPCU的A、B机加电状态。
|给VIPPCU发送的下平台控制数据|FREQ1.8.3|无|控制数据|CCU给VIPPCU发送的下平台控制数据。
|给VIPPCU发送CCU的重要数据|FREQ1.8.5|无|CCU的重要数据|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
|给VIPPCU发送VIPPCU的重要数据|FREQ1.8.6|无|VIPPCU的重要数据|给VIPPCU发送VIPPCU的重要数据
|转发VIPPCU上注指令参数块|FREQ1.8.7|无|VIPPCU上注指令参数块|需要时，转发VIPPCU上注指令参数块
|接收VIPPCU遥测数据|FREQ1.8.8|VIPPCU遥测数据|无|每个控制周期，接收VIPPCU遥测数据，解包成需要的数据
|接收CCU重要数据返回包|FREQ1.8.9|CCU重要数据|指令|上电/复位后应用软件首先从VIPPC恢复重要数据。
",0,0,0,0,0,0,0,0,1,0,0
功能描述：PID计算控制力矩经过结构滤波器后，改善姿态控制效果。,0,1,0,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的红外陀螺数据有效性及系统故障诊断修正系数,0,0,0,0,0,0,0,0,0,1,0
"功能描述：选择相平面参数、角加速度
处理：根据工作模式设置相平面参数；根据推力器分支及追踪器构型设置角加速度。
说明：10种构型，2种分支共计20组角加速度（每组包括正负三轴共6个）；",0,1,0,0,0,0,0,0,0,0,0
"功能描述：部件加电标志。与光纤陀螺通信功能。
处理：
见陀螺通信协议。
功能编号|功能|引用文档
FREQ45|初始化|陀螺协议
FREQ46|陀螺使用要求|任务书
FREQ47|通信|陀螺协议
FREQ48|通信故障处理|任务书
FREQ49|数据解包与转换|陀螺协议
FREQ50|陀螺数据有效性判断、处理|任务书
FREQ51|陀螺模拟量采集、处理|任务书
FREQ52|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：推力器喷气状态清零
",0,1,0,0,0,0,0,0,0,0,0
"需求名称|功能及处理描述
对地数传天线1数据的采集与处理|对地数传天线1 LTU控制指令
对地数传天线1的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
对地数传天线2数据的采集与处理|对地数传天线2
LTU控制指令|对地数传天线2的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
中继天线数据的采集与处理|中继天线LTU控制指令|中继天线的角度和角度偏差|在总线指令要求通讯允许的条件下，每500ms向中继天线 LTU发控制指令，获得中继天线数据并处理成对应的角度等信息。",0,0,0,0,0,0,0,0,1,0,0
功能：利用星敏感器A的测量，修正姿态四元数与估计角速度。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：在红外太阳定姿方式下计算四元数，在其余定姿方式下计算欧拉角。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：发送星敏感器数据
处理：OBDH在每个遥测格式的第0帧，从AOCC接收8字节星敏感器数据。其处理过程如下：
STEP1：AOCC应用程序每0.524秒查询一次有无OBDH发送数据请求，如果有则转入第二步，否则退出；
STEP2：判别是否此时星上正在取新的星图，如果是则此次发送8字节固定数4444444444444444，否则转第三步；
STEP3：判别8颗星图（每个星图32字节）数据是否取完，如果没取完，则将取星图数据计数器加1，从规定的星图数据缓存区中取8个字节的数据放入OBDH规定的内存中；否则转第四步。
STEP4：将取星图数据计数器清0，星上开始取新的星图数据 。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：接收同步控制
处理：根据同步字的编码内容进行相应的处理：
编码|相应的处理
28H|发送内存的数据区指针复位
",0,0,0,0,0,0,0,0,0,1,0
"功能描述：若本周期角动量与上一周期角动量之差（绝对值）大于0.15Nms，则用上一周期角动量作为本周期输入，角动量变化取0。若连续大于三次或本周期与上一周期角动量之差（绝对值）小于0.15Nms，则以本周期角动量为真值，角动量变化取
输入：实测飞轮角动量，
      上周期角动量数据，
      剔野判断计数器N_WheelPick_i (i=x,y,z,s)",0,0,0,0,0,0,1,0,0,0,0
功能描述：启动动量轮至标称角动量，并保持。,0,1,0,0,0,0,0,0,0,0,0
功能描述：利用陀螺确定出卫星对目标的姿态四元数。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：将动量轮保持至标称角动量所需的电压。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：定义AOCC初始上电至星箭分离为主动段工作模式。
处理：
定义星箭分离前为主动段工作模式，应用软件在控制周期任务函数中进行下列工作：
	星时计算。
	采集部件（太阳敏感器、陀螺、星敏、CMG）信息。
	采集部件、线路遥测模拟量。
	响应主动段测试指令和“运行初始速率阻尼模式”指令。
	对ALTU当班状态判断，并与当班ALTU通讯。
	响应星务分系统轮询、数据遥控指令、数据注入、程序注入、秒脉冲校时等，并进行相应处理。
	星箭分离的确认依据为：一个控制周期内对星箭分离状态位读5次，若连续3次以上读入为“1”，则认为本周期查到星箭已分离，每次读的时间间隔要求大于1ms。如果在连续3个周期内每个周期都查到星箭已分离，则可确认为星箭已分离，进入初始速率阻尼模式。
	此外，通过地面遥控指令进行以下起飞前设置：
5个CMG加电，并将框架角均转到0度保持、锁定；
6个陀螺加电。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：为三轴姿态喷气控制选择喷管；并记录喷气时间等。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：发送控制计算机指定内存内容
处理： 
（1）接收内存读出的地址和长度
（2）将对应地址和长度的内存数据放入发送内存读出数据的存储空间内",0,0,0,0,0,0,0,0,0,0,1
"功能：利用星敏感器A、C的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"    各个模式切换的功能点列表如下：
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ5.1.0|4|主动段模式切换条件判断及转出设置
|入轨段控制模式切换|FREQ5.1.1|4.1|入轨段控制模式切换条件判断及转出设置
|正常对地运行模式切换|FREQ5.1.2|4.2|正常对地运行模式切换条件判断及转出设置
|点对点机动模式切换|FREQ5.1.3|4.3|点对点机动模式切换条件判断及转出设置
|偏置飞行模式切换|FREQ5.1.5|4.4|偏置飞行模式切换条件判断及转出设置
|轨控模式切换|FREQ5.1.8|4.5|轨控模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ5.1.9|4.10|全姿态捕获模式切换条件判断及转出设置
|无控模式切换|FREQ5.1.10|4.11|无控模式切换条件判断及转出设置
|陀螺标定模式切换|FREQ5.1.11|4.8|陀螺标定模式切换条件判断及转出设置
|惯性定向模式切换|FREQ5.1.12|4.6|陀螺标定模式切换条件判断及转出设置

切换条件具体见用户需求4。CCU切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：利用数字太阳信息，进行太阳捕获，对太阳定向。
输入：5.2.17.2的输出 ， 
计时器TShadow，
数字太阳敏感器状态F_Ds1Valid，F_Ds2Valid（由数据有效性判据给出），
数字太阳敏感器输出,（量纲：弧度）
上周期姿态角估值，",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的系统功能参数设置区数据,0,0,0,0,0,0,0,0,0,1,0
"功能描述：俯仰通道喷气中断处理程序。
处理：将推力器1-8关掉",0,0,0,0,0,0,0,1,0,0,0
功能描述：星敏感器数据处理,0,0,0,0,0,0,0,0,1,0,0
"需求名称|功能及处理描述
ACU模拟量数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发模拟量数据采集指令，获得ACU数据并处理成对应的模拟量信息。
ACU状态数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发各种状态数据采集指令，获得ACU数据并处理成对应的状态信息。
ACU中控制指令的输出处理|根据通讯协议，将计算得到的控制数据转换为消息需要的格式并输出。
MW数据的采集与处理|在通讯允许的条件下，每周期向ACU RT发MW数据采集指令，获得ACU数据并处理成对应的MW的角动量。
部件加断电指令的处理|根据通讯协议，将需要发送的加断电指令转换为消息需要的格式并输出
ACU保存CCU的重要数据|AOCC每三个控制周期将重要数据发送给ACU（驱动控制单元）
从ACU恢复CCU的重要数据|上电/复位后应用软件首先从ACU恢复重要数据
ACU的程序注入修改|将从OBDH收到的ACU需修改程序内容，按内总线的格式发送给ACU RT需修改的程序内容
ACU的内存下传|地面注入ACU内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至ACU RT。
自锁阀操作|根据任务书的要求通过1553B向ACU输出自锁阀开关控制指令",0,0,0,0,0,0,0,0,1,0,0
功能描述：偏置动量处于力矩模式，根据滚动红外敏感器弦宽测量计算得到的滚动角，俯仰角的信息实现三轴姿态控制滚动、俯仰轴采用角动量反馈方式控制，偏航轴采用耦合控制。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：，
输出：保持角动量所需电压，
      角动量偏差积分项：，
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：利用太阳敏感器信息，进行太阳捕获，对太阳定向
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：判断陀螺的使用范围。
处理
对陀螺数据进行有效性判断。若某个陀螺故障或某个陀螺为新上电，则不进行有效性判断（陀螺不引入）。其中陀螺新加电有三种情况1、判断出陀螺故障且允许自主加电情况下，应用软件自主加电。2、数据指令加电。3、脉冲遥控指令加电。对于新加电陀螺，则在该陀螺加电时间小于20分钟（全姿态捕获模式为10分钟）时，将其引入标志置为0；当该陀螺加电时间大于等于20分钟（全姿态捕获模式为10分钟）时，将其引入标志置为1。
若SLTU陀螺不加电或该陀螺故障，不引入。当“允许使用电源状态诊断陀螺”时，应用软件根据与SLTU通讯得到的陀螺电源状态确定陀螺加断电状态；当“不允许使用电源状态诊断陀螺”时，应用软件只根据数据指令确定陀螺加断电状态。若SLTU得到的六个电源状态均断电，则不根据电源状态判断陀螺是否加电。",0,0,0,0,0,0,1,0,0,0,0
"功能描述：采集8路模拟太阳A\B码、监视码。
处理：
采集方法：连续采集8路，采集1路的操作步骤（以ASS1的电流1为例）：
向选通地址输出偏移地址：0x1200 0000 = 30H；
等待至少100µs,启动A/D转换：0x1200 0020 = 0；
等待至少40µs后；
连续3次读取A/D数据总线上的数据：data1 = 0x1200 0020 (data2，data3类似)；
取data1、data2、data3三个数据的中间值，作为本路模拟量的最终采集结果；",0,0,0,0,0,0,0,0,1,0,0
"功能描述：修正光行差量的计算。
处理：同用户需求的4.13。
STEP1：计算",0,0,1,0,0,0,0,0,0,0,0
"功能描述：发送AOCC重要数据包
处理： AOCC在接收注入的重要数据快的同时将其存放在OBDH规定的内存中，AOCC不再进行单独处理。",0,0,0,0,0,0,0,0,0,0,1
功能描述：利用陀螺、红外、数字太阳、星敏感器诊断陀螺,0,0,0,0,0,1,0,0,0,0,0
"功能：利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序。
输入：姿态预估周期 (量纲：秒)
有效性判据给出的星敏感器A数据可用标志F_SAUsed(1:可用，0:不可用)
有效性判据给出的星敏感器B数据可用标志F_SBUsed(1:可用，0:不可用)
本周期采样到的星敏感器A的有效输出 (设有nA个，即)，以及它们测量时刻相应的星时 (量纲：秒)
本周期采样到的星敏感器B的有效输出(设有nB个，即)，以及它们测量时刻相应的星时(量纲：秒)
使用陀螺数据时：
本周期计算的与前Num_q-1个周期的，以及符号标志F_Qsgn
不使用陀螺数据时：
本周期计算的与前Num_q-1个周期的，以及符号标志F_Qsgn_ng
修正参数 
本周期轨道计算采用的星时 (量纲：秒)
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：卫星处于应急状态
处理：
STEP1：进行姿态预估，得到姿态角和角速度
STEP2：令动量轮和磁力矩器的控制电压为0",0,0,0,1,0,0,0,0,0,0,0
"功能描述：检测动量轮的故障。
",0,0,0,0,0,1,0,0,0,0,0
"功能描述：轨控模式控制
",0,0,0,1,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|三浮陀螺数据的采集与处理|FREQ1.2.1|""三浮陀螺1553B取数指令
""|陀螺1-3的速度增量|在通讯允许的条件下（每个三浮陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是角速率数据，通过任务书给出的公式计算
|光纤陀螺数据的采集与处理|FREQ1.2.2|""光纤陀螺LTU取数指令
""|陀螺4-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：计算偏置动量模式下滚动/偏航轴进动控制及章动阻尼所需的磁力矩器脉宽。                                                                                                                                                                                                                                                                                                                                                           输入：
Y轴角动量偏差    
滚动角，滚动角速度，偏航角，偏航角速度
地磁场强度（T） ，及标量B，星下点经纬度L,
输出：磁力矩器工作脉宽，",0,1,0,0,0,0,0,0,0,0,0
"功能描述：轨控姿态机动模式控制
",0,0,0,1,0,0,0,0,0,0,0
"功能描述：接收OBDH时间
处理：按接收OBDH时间命令存储地址中内容的数据格式处理成星时的数据格式。此处理在中断中进行。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：将陀螺有效输出数据，换算成卫星三轴角速度。
",0,0,1,0,0,0,0,0,0,0,0
"软件需求标识：FREQ15 
软件需求名称：光纤陀螺数据处理 
需求类别：其他 
软件需求描述：光纤陀螺数据处理。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：根据姿态估值与数字太阳输出，计算量测的一步预测与新息。
",0,0,1,0,0,0,0,0,0,0,0
"序|需求名称|编号|功能及处理描述
|-Y帆板数据的采集与处理|FREQ7.3|选择通讯的-Y帆板LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
|+Y帆板数据的采集与处理|FREQ7.4|选择通讯的+Y帆板LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
|-Y帆板控制指令的输出处理|FREQ7.5|选择通讯的帆板-Y LTU，发送的控制指令。
|+Y帆板控制指令的输出处理|FREQ7.6|选择通讯的+Y帆板LTU，发送的控制指令。
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：为星敏感器定姿提供初始的相对惯性的姿态四元数。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收同步控制。
处理：根据应急线路同步字的编码内容进行相应的处理：
编码|相应的处理
28H|发送内存的数据区指针复位
",0,0,0,0,0,0,0,0,0,1,0
"功能描述：根据任务要求，应用软件1553B初始化、变量的初始化
处理：
进行1553B初始化，处理过程见的OBDH初始化功能
把模式字初始化为零
上电时，将在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff；复位时，若在轨维护程序区未发生双错，则应用软件从三取二区恢复在轨注入模块地址映射表JumpSlot、继续运行在轨维护程序；若在轨维护程序区发生双错，则应用软件不恢复在轨注入模块地址映射表JumpSlot，同时在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff，运行原PROM区的函数模块
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：发送遥测数据
处理：
包括两个子地址，发送两条指令是连续的，共有76个字节。应用软件在收到发送遥测帧计数（低字节为实时遥测帧计数0~63，高字节为实时格式计数0~7）的低字节为62时，根据高字节实时格式计数根据延时遥测数据格式进行打包后放到发送延时遥测参数地址中，具体数据见延时遥测文件。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：发送矢量字
处理：将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：发动机关机中断信号处理                                                                                                                                                                                                                                                                                                                                                                                                                                                                           处理：
应用软件处理发动机关机中断信号，信号源为3路伽玛关机信号，应用软件查到关机后，立触地关机标志有效，发7500N关机指令。",0,0,0,0,0,0,0,1,0,0,0
"需求名称|功能及处理描述
+Y帆板数据的采集与处理|每周期无条件的向+Y帆板RT发取数指令，获得+Y帆板数据并处理成对应的角度。CCU应用软件取数消息与同步消息的发送时间间隔不小于2ms。
-Y帆板数据的采集与处理|每周期无条件的向-Y帆板RT发取数指令，获得-Y帆板数据并处理成对应的角度。
+Y帆板控制指令的输出处理|根据协议将+Y帆板的控制数据转换为相应的控制指令消息并输出
-Y帆板控制指令的输出处理|根据协议将-Y帆板的控制数据转换为相应的控制指令消息并输出
帆板的程序注入修改|将从OBDH收到的帆板需修改程序内容，按内总线的格式发送给帆板RT需修改的程序内容
帆板的内存下传|地面注入帆板内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至帆板 RT。",0,0,0,0,0,0,0,0,1,0,0
功能描述：接收遥控固定参数注入块的轨控参数,0,0,0,0,0,0,0,0,0,1,0
功能描述：将动量轮保持至标称角动量所需的电压。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：接收遥控固定参数注入块的陀螺脉冲当量系数
处理：
调整陀螺1~3的脉冲当量的初装值。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：计算小天区扫描模式下的目标姿态，并给出当前的扫描阶段：行扫中，转弯等。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：使用星敏感器B的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|甚高三浮陀螺数据的采集与处理|FREQ1.2.1|""甚高三浮陀螺1553B取数指令
""|陀螺1-6的速度增量|在通讯允许的条件下（每个甚高陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|甚高光纤陀螺数据的采集与处理|FREQ1.2.2|甚高光纤陀螺1553B取数指令|陀螺7-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,0,0,0,1,0,0
功能描述：若某个模拟太阳故障，则模拟太阳数据无效。若某个模拟太阳不见太阳标志，则该模拟太阳无效。,0,0,0,0,0,0,1,0,0,0,0
"需求名称|功能描述
部件数据有效性判断|对部件采样数据的有效性进行判断，并选择引入闭环控制系统的数据
陀螺数据有效性判断|判断定姿用陀螺数据的有效性，选择参与定姿的陀螺
模拟太阳敏感器数据有效性判断|确定ASS21，ASS22，ASS31，ASS32及帆板角度传感器，等的信号选取
红外地球敏感器数据有效性判断|判断红外地球敏感器有效性
星敏感器数据有效性判断|对星敏感器输出数据进行有效性判断，并选取定姿星敏组合
数字太阳敏感器数据有效性判断|对数字太阳敏感器输出数据进行有效性判断
部件故障诊断|对部件进行故障诊断
陀螺故障诊断|由平衡方程方法、星敏感器数据等对陀螺进行故障检测
CMG故障诊断|根据CMG输出数据和理论数据进行CMG故障检测
推进喷气异常检测|检测推力器微漏、过量喷气等，必要时作相应的主备份切换和禁止。
帆板故障诊断|帆板故障检测及处理
模式1的系统故障诊断|在模式1中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式2的系统故障诊断|在模式2中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式3的系统故障诊断|在模式3中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式4、6、7的系统故障诊断|在模式4、6、7中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式5的系统故障诊断|在模式5中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式8的系统故障诊断|在模式8中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式9的系统故障诊断|在模式9中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
RS422通讯故障诊断|进行RS422通讯故障诊断及处理
光纤陀螺通讯诊断及处理|进行光纤陀螺通讯故障诊断及处理
数字太阳通讯诊断及处理|进行数字太阳通讯故障诊断及处理
太阳模拟量通讯诊断及处理|进行太阳通讯故障诊断及处理
对地数传天线通讯诊断及处理|进行对地数传天线通讯故障诊断及处理
中继天线通讯诊断及处理|进行中继天线通讯故障诊断及处理
1553B内总线通讯故障诊断|进行1553B内总线通讯故障诊断及处理
红外通讯故障诊断|红外通讯故障诊断及处理
大量程陀螺通讯故障诊断|大量程通讯故障诊断及处理
CMG通讯故障诊断|CMG通讯故障诊断及处理
ACU通讯故障诊断|ACU通讯故障诊断及处理
帆板通讯故障诊断|帆板通讯故障诊断及处理
多头星敏通讯故障诊断|多头星敏通讯故障诊断及处理",0,0,0,0,0,0,1,0,0,0,0
功能描述：星上实时计算太阳轨道、方位与其它参数,0,0,0,0,1,0,0,0,0,0,0
"功能描述：使用星敏感器C的测量，修正姿态四元数与姿态角速度。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：根据CMG输出数据和理论数据进行CMG故障检测及处理。,0,0,0,0,0,1,0,0,0,0,0
"序|需求名称|编号|功能及处理描述
|动量轮角动量的采集与处理|FREQ5.1|采集动量轮的转速方向和脉冲计量，计算动量轮的角动量
|动量轮控制电压的处理|FREQ5.2|将动量轮控制电压通过D/A输出
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：由模拟太阳信号码、监视码得到模拟太阳角、见太阳标志。
",0,0,0,0,0,0,0,0,1,0,0
功能描述：对数传天线控制指令的处理 ,0,0,0,0,0,0,0,1,0,0,0
"功能描述：根据任务要求，应用软件进行LTU初始化、1553B初始化、变量的初始化
处理： 
进行LTU初始化
进行1553B初始化
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。变量初值见上行注入、用户需求、装订参数。对于上述文件中相同变量的初值，以装订参数文件为准。对于上行注入与用户需求中相同变量的初值，以用户需求的规定为准。复位后的状态恢复不区分单机复位和三机复位。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：根据陀螺输入，予估卫星对地姿态。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：帆板故障检测，切换帆板LTU。,0,0,0,0,0,1,0,0,0,0,0
"功能描述：系统软件上电复位后，调用应用软件AppInit函数，并根据初始化内容，启动任务
处理：
OBC上电/复位后，由系统软件引导应用软件运行。首先进行初始化，包括系统软件初始化和系统软件调用应用软件提供的初始化函数（AppInit）。启动任务并开始进行任务调度管理。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：发送矢量字
处理：将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。应用软件中对应各个请求编码的条件如下表所示（十六进制）：
服务编码|发送的条件
58H|上电/复位时发送，一次成功则不再发送第二次，如果一次不成功，则再发第二次；同样若第二次也不成功，则再发最后一次。
38H|每隔1分钟或模式改变时发送
96H|待定
69H|进入全姿态捕获模式后发送，收到确认字后停止发送
8CH|进入无控模式后发送，收到确认字后停止发送
C8H|BAPTA异常跟踪后发送，收到确认字后停止发送
",0,0,0,0,0,0,0,0,0,0,1
功能描述：卫星绕y轴转动，使红外搜索地球。,0,0,1,0,0,0,0,0,0,0,0
功能描述：决定磁卸载或喷气卸载方式,0,1,0,0,0,0,0,0,0,0,0
功能描述：发送姿态控制数据包1,0,0,0,0,0,0,0,0,0,0,1
"序|需求名称|编号|输入|输出|功能及处理描述
|CMG 1数据的采集与处理|FREQ1.9.1|""CMG 1
1553B取数指令
""|CMG 1的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 1的当班标志为1），每周期向CMG 1RT发取数指令，获得CMG 1数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG 2数据的采集与处理|FREQ1.9.2|""CMG 2
1553B取数指令
""|CMG 2的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 2的当班标志为1），每周期向CMG 2RT发取数指令，获得CMG 2数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG 3数据的采集与处理|FREQ1.3.3|""CMG 3
1553B取数指令
""|CMG 3的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 3的当班标志为1），每周期向CMG 3RT发取数指令，获得CMG 3数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG 4数据的采集与处理|FREQ1.9.4|""CMG 4
1553B取数指令
""|CMG 4的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 4的当班标志为1），每周期向CMG 4RT发取数指令，获得CMG 4数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG 5数据的采集与处理|FREQ1.9.5|""CMG 5
1553B取数指令
""|CMG 5的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 5的当班标志为1），每周期向CMG 5RT发取数指令，获得CMG 5数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG 控制指令的输出处理|FREQ1.9.6|计算得到CMG的控制数据|CMG的控制指令输出消息指令|根据控制方式发送相应的控制指令，具体见内总线通讯协议
|CMG 6数据的采集与处理|FREQ1.9.7|""CMG 6
1553B取数指令
""|CMG 6的高速角动量、低速框架角度和角速度及状态信息|在通讯允许的条件下（CMG 6的当班标志为1），每周期向CMG 6 RT发取数指令，获得CMG 6数据并处理成对应的高速角动量、低速框架角度和角速度。
|CMG的程序注入修改|FREQ1.9.8|从OBDH收到的CMG需修改程序内容|CMG需修改程序内容|将从OBDH收到的CMG需修改程序内容，按内总线的格式发送给CMG RT需修改的程序内容
|CMG的内存下传|FREQ1.9.9|从OBDH收到的CMG内存下传设置指令|内存下传设置指令|地面注入CMG内存下传设置指令，应用软件进行判断后转发“内存下传设置指令”至CMG RT。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：选择通讯的星敏LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输入：ZT6、inAPSLTUSeltFlag、星敏LTU返回的数据。
输出：星敏输出的四元数、相对时间和数据有效性标志。
处理：
（1）星敏共有两个LTU，AOCC每个控制周期向注入文件中的ZT6和inAPSLTUSeltFlag的最大组合中的星敏LTU发送取数指令。
（2）向选择的星敏LTU发送完取数指令后，获得星敏LTU返回的数据，将数据转换为所需的数据格式。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：紧急撤离模式下，计算视速度增量关机时间长度
",0,1,0,0,0,0,0,0,0,0,0
功能：利用星敏感器和陀螺或者仅利用星敏感器的输出计算卫星欧拉角和四元数。,0,0,1,0,0,0,0,0,0,0,0
功能描述：帆板未展开模式控制,0,0,0,1,0,0,0,0,0,0,0
"功能描述：三轴喷气姿态控制。
",0,1,0,0,0,0,0,0,0,0,0
功能描述：接收GPS秒脉冲整秒时间,0,0,0,0,0,0,0,0,0,1,0
"功能：利用红外、数字太阳敏感器确定姿态。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：根据注入轨道参数计算太阳轨道、方位与其他参数。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：若AOCC与星敏感器通讯不成功，则记录星敏感器故障一次。若连续240次不成功，判断该星敏感器故障。若星敏感器连续1000次数据无效，需重新启动星敏感器。
",0,0,0,0,0,1,0,0,0,0,0
功能描述：太阳全姿态捕获模式初始化,0,0,0,1,0,0,0,0,0,0,0
"功能描述：完成陀螺判断和处理功能（功能编号：FReq-14）。
处理：陀螺故障判断与处理逻辑，进行陀螺饱和故障、陀螺输出常值故障诊断、陀螺跳数故障、控制量与角速度增量不匹配的故障诊断。其中陀螺常值故障诊断由以前的角速度前后周期绝对值之差累计，变更为：角速度前后周期之差累计。并且陀螺平衡方程满足时，增加清相关计数器的可靠性操作。具体处理逻辑详见任务书 中的5.4.5.8.1节。",0,0,0,0,0,1,0,0,0,0,0
"软件需求名称：推进系统操作 
需求类别：其他 
软件需求描述：对自锁阀、推力器进行操作。",0,0,0,0,0,0,0,1,0,0,0
"模式字定义如下，装订值为0：
模式字|工作模式描述
0|主动段
1|正常对地运行
2|偏航机动
3|全姿态捕获
4|对地捕获
5|帆板未展开
6|轨控
7|无控
8|侧摆机动
9| 侧摆保持
11|入轨段控制
12|自旋模式
13|应急模式
14|星敏全姿态捕获模式

工作模式的转换可分为以下二种情况：
按地面上行注入进行转换：通过注入姿控数据块中的模式字进行转换；
按应用软件用户需求给定的条件判别，由软件自主控制转换：自主转换分两种：一种为正常运行转换；一种为故障时转换。下面分别进行说明
正常转换图为：
正常运行自主转换如下表所示：条件标识原则：ZCCX—Y，其中ZCC表示正常自主转换条件，X为转出的模式字，Y为转入的模式字。
标识|具体条件
ZCC0—B|星箭分离
ZCCB—1|Tin >4800 
ZCC1—2|
ZCC1—6|
ZCC1—8|且且且
ZCC2—1|
ZCC2—6|
ZCC4—1|FEA=A
ZCC6—1|
ZCC6—2|)且
ZCC8—1|""满足下列条件之一：
若动量轮侧摆且目标侧摆角为0，当姿态角误差小于0.5度，角速度误差小于0.01度/s连续次
若喷气侧摆且目标侧摆角为0，当姿态角误差小于1度，角速度误差小于0.015度/s连续次
若星时大于侧摆机动时间＋600秒且侧摆目标角为0""
ZCC8—9|""满足下列条件之一：
若动量轮侧摆且目标侧摆角不为0，当姿态角误差小于0.5度，角速度误差小于0.01度/s连续次
若喷气侧摆且目标侧摆角不为0，当姿态角误差小于1度，角速度误差小于0.015度/s连续次
若星时大于侧摆机动时间＋600秒且侧摆目标角不为0""
ZCC9—8|""满足下列条件之一：
且
""

故障自主转换如下表所示：条件标识原则：GCX—Y，其中GCC表示正常自主转换条件，X为转出的模式字，Y为转入的模式字。其中进入应急模式的条件为读到应急线路加电，记为GCC-D。其余的自主故障切换如下图所示：
故障条件定义如下：
标识|具体条件
GCC1—3|FailureFlag=1并且WacqSunFlag =0并且ZT7属于[1，4]区间内
GCC1—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCC1—E|FailureFlag=1并且WacqSunFlag=1并且ZT7属于[1，4]区间内
GCC3—7|FailureFlag＝4且AutoInStopNum<2
GCC3—E|SMODE＝3且TSMODE>8000（若ZT11=4则取值为32000）
GCC4—1|FEA=A
GCC4—3|WacqUseIresOrSTSFlag=1且TCOUNT>24000
GCC5—3|脉冲发完后
GCC6—1|FailureFlag＝2且无机动要求
GCC6—2|FailureFlag＝2且无机动要求
GCC7—3|>6900 且AutoInStopNum<2且WacqSunFlag =0
GCC7—E|>6900 且AutoInStopNum<2且WacqSunFlag =1
GCC8—1|FailureFlag=3
GCC9—3|FailureFlag=1并且WacqSunFlag=1并且ZT7属于[1，4]区间内
GCC9—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCC9—E|FailureFlag=1并且WacqSunFlag=0并且ZT7属于[1，4]区间内
GCCB—3|FailureFlag=1并且ZT7属于[1，4]区间内
GCCB—7|FailureFlag=1并且ZT7不属于[1，4]区间内
GCCE—1|StarCatchFlag=1且(1-()<0.000685)且norm()<0.000875
GCCE—7|TCOUNT>31200或（FailureFlag＝4且AutoInStopNum<2）

AOCC切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
"功能描述、输入、输出、计算公式见《用户需求》4.6.1~4.6.3。
序号|功能点编号|功能描述|说明
|FREQ3.4.8.1|喷气控制|《用户需求》4.6.1
|FREQ3.4.8.1.1|相平面姿控算法|《用户需求》4.6.1.1
|FREQ3.4.8.1.2|相平面法喷管选择|《用户需求》4.6.1.2
|FREQ3.4.8.1.3|脉冲调宽姿控算法|《用户需求》4.6.1.3
|FREQ3.4.8.1.4|脉冲调宽法喷管选择|《用户需求》4.6.1.4
|FREQ3.4.8.2|动量轮控制|《用户需求》4.6.2
|FREQ3.4.8.2.1|动量轮安装矩阵和电压分配矩阵|《用户需求》4.6.2.1
|FREQ3.4.8.2.2|动量轮摩擦补偿计算|《用户需求》4.6.2.2
|FREQ3.4.8.2.3|动量轮角动量保持的PI控制|《用户需求》4.6.2.3
|FREQ3.4.8.2.4|动量轮启动与保持|《用户需求》4.6.2.4
|FREQ3.4.8.2.5|正常飞行动量轮分配电压计算|《用户需求》4.6.2.5
|FREQ3.4.8.3|喷气卸载计算|《用户需求》4.6.3
|FREQ3.4.8.4|喷气动量轮联合控制|《用户需求》4.6.4
",0,1,0,0,0,0,0,0,0,0,0
功能描述：由平衡方程方法、星敏感器数据进行陀螺的故障检测,0,0,0,0,0,0,1,0,0,0,0
"功能描述：采集动量轮的转速方向和脉冲计量，计算动量轮的角动量
处理：处理如下：
（1）读每路动量轮计算器的值，将读到的计数器的值减去上一个周期的计数器的值，得到差值；
（2）根据转换公式将脉冲数转换为角动量。
（3）令（i = 1，2，… ，6）。为上一次轮子角动量值。",0,0,0,0,0,0,0,0,1,0,0
功能描述：根据指令完成数传天线的指向控制。,0,1,0,0,0,0,0,0,0,0,0
"通讯串口
04H|波特率寄存器|RW|""波特率寄存器低位：0x04（115200）
0x18（19200）""
08H|波特率寄存器|RW|波特率寄存器高位：0x00
CAN总线初始化
寄存器名称|初始化内容|初始化意义
""CAN_ADDR        
(CAN总线地址)""|无。|无说明。
""控制寄存器
(Control Register)
""|0x07|""D7D6D5：保留。
D4：超载（接收设备不能按数据发送速率接收数据而造成的数据丢失）中断使能。
高：开放。低：禁止
D3：错误中断使能。
高：开放。低：禁止
D2：发送中断使能。
高：开放。低：禁止
D1：接收中断使能。
高：开放。低：禁止
D0：复位模式。
在初始化的时候，复位模式位置1，才可以进行初始化设置。""
命令寄存器(Command register)|0x=00001100|""D7D6D5：保留。必须。
D4：进入睡眠状态。
高：睡眠 。低：睡眠唤醒。
D3：清除超载状态。不产生超载中断。
高：清除。低：无动作。
D2：释放接收缓冲器。（读接收缓存器内容后，释放缓存器，以便其他报文立即可用）。
高：释放。低：无动作。
D1：夭折发送。
D0：发送请求。
高：报文即将发送。低：无动作。""
""验收代码寄存器
(Acceptance 
Code Register)""|0xa7=10100111|""当通过验收测试的报文被接收，且若存在空的接收缓存器，则各自的描述符和数据场被顺序存贮在空的缓存器中，在不存在空的接收缓存器的情况下，数据超载位被置位高(超载)，当完整的报文被正确接收，将出现下列操作：
接收缓存器状态位被置为高(满)
若接收中断开放位被置为高(开放)，接收中断被置为高(置位)
验收码位(AC.7~AC.0)和报文标识符的最高8位(ID.10~ID.3)必须等于由验收屏蔽位必须满足""
""验收屏蔽寄存器
((Acceptance 
Mask Register))""|0xf8|最后三位相关。
总线时序寄存器0(Bus Timing Register 0)|0x00|""总线时序寄存器的内容决定波特率预分频器(BRP)和同步跳转宽度(SJW)的数值。

通过总线定时器的内容，将波特率预分频器设置为2，即将输入的系统时钟二分频，由于输入的系统时钟已经是将计算机晶体频率14.7456MHz二分频，即7.3728MHz。所以这个时候时钟为3.6864 MHz。""
总线时序寄存器1(Bus Timing Register 1)|0x18|""采样（SAM）=1总线采样1次。
TSEG1和TSEG2确定每位周期的时钟周期数目和采样点位置：

由于一位周期是由

而

波特率＝""
""时钟分频器
(Clock Divider
register)""|0x40|""D7:CAN模式。
0：基本模式。
D5:1(旁路输入比较器，仅在复位模式下起作用)。""
""OCR
(output Control)""|0x|

在完成上述初始化后，要再次初始化控制寄存器。将最低位初始化为0。",1,0,0,0,0,0,0,0,0,0,0
