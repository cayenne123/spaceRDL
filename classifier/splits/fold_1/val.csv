Requirements Description,功能需求/初始化,功能需求/控制计算/姿态控制,功能需求/控制计算/姿态确定,功能需求/控制计算/模式管理,功能需求/控制计算/轨道计算,功能需求/控制计算/运行时保障/故障诊断和处理,功能需求/控制计算/运行时保障/数据有效性判断,功能需求/控制输出,功能需求/数据采集,功能需求/遥控,功能需求/遥测
"功能描述：利用加速度计数据诊断加速度计部件状态
",0,0,0,0,0,1,0,0,0,0,0
功能描述：计算机应急模式控制,0,0,0,1,0,0,0,0,0,0,0
功能描述：外推轨道计算主程序。,0,0,0,0,1,0,0,0,0,0,0
"此章节01星为“发送AOCC中继事件数据”，现删除，替换为“发送AOCC数据段黑匣子数据”
功能描述：发送AOCC数据段黑匣子数据",0,0,0,0,0,0,0,0,0,0,1
功能描述：由模拟太阳A/B码、监视码得到模拟太阳角、见太阳标志。,0,0,0,0,0,0,0,0,1,0,0
"功能描述：接收遥控固定参数注入块的结构滤波器系数
处理：
调整各系数的初装值。",0,0,0,0,0,0,0,0,0,1,0
功能描述：帆板故障检测，切换帆板LTU。,0,0,0,0,0,1,0,0,0,0,0
功能描述：根据星敏感器故障标志、星敏感器有效数据判断标志（由星敏感器数据包给出，（包括状态字b27、同步脉冲计数值、数据产生相对时间、姿态四元数信息等）），判断星敏感器数据有效性。,0,0,0,0,0,0,1,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|星时计算|FREQ1.4.1|上周期绝对星时；上周期锁存的星时计数器的值|本周期的绝对星时|""每周期无条件的进行星时的计算。处理要求见任务书。
""
|OBDH星时校时|FREQ1.4.2|""OBDH校时指令中的绝对星时;
及对应锁存的对应时间的星时计数器的值""|上周期绝对星时；上周期锁存的星时计数器的值|采用OBDH校时方式时，每秒有OBDH校时指令时进行校时。处理见任务书。
|GPS秒脉冲高精度校时|FREQ1.4.3|""GPS秒脉冲校时指令中的绝对星时;
及对应锁存的对应时间的星时计数器的值""|上周期绝对星时；上周期锁存的星时计数器的值|采用GPS秒脉冲方式时，每秒有GPS秒脉冲指令时进行校时。处理要求见任务书。
|两种校时方式的切换|FREQ1.4.4||校时方式标志|OBDH星时校时、GPS秒脉冲高精度校时是否引入系统由注入指令控制，OBDH星时校时为系统默认使用的校时方式。具体见任务书要求
|均匀校时|FREQ1.4.5|""本周期的绝对星时；
均匀校时补偿量""|""本周期的绝对星时；
""|应用软件每次进行星时计算时，将计算后的绝对星时加上均匀校时补偿量作为本周期的补偿后的绝对星时。。具体见任务书要求
|星敏感器数据星时时标处理|FREQ1.4.6|同步标志；本周期的绝对星时；本周期锁存星时计数值；锁存的星敏同步计数值|星敏感器测量数据对应的星时|具体处理要求见任务书。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：根据指令完成数传天线的指向控制。
",0,1,0,0,0,0,0,0,0,0,0
功能描述：在完成对日定向后，由地面指令转入地球捕获。当两个地球红外敏感器同时故障时，使用数字太阳敏感器和星敏感器定姿建立正常姿态。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据从SLTU接收的0.25秒或1秒内陀螺的角度增量，算出卫星在惯性空间的角速度。
输入：0.25秒或1秒内陀螺的角度增量 (量纲：弧度)
(i=1,2,3,…6，依次表示陀螺G1，G2，…，G6的输出)；
采样周期 (量纲：秒)；
陀螺数据有效性标志F_GyroValid(由陀螺有效性判据给出)。
陀螺系统在星体三轴方向等效的常值漂移估值 (量纲：弧度/小时)
星敏感器数据有效性标志：F_SAValid，F_SBValid，F_SCValid
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收数据指令注入块的部件开关类指令
",0,0,0,0,0,0,0,0,0,1,0
"上电/复位后，系统软件进行相应的初始化工作，之后调用应用软件的AInit()函数进行应用软件的初始化。应用软件初始化工作主要包括硬件初始化、变量初始化、星箭分离查询、确定部件加断电状态状态。
硬件初始化的内容如下表所示：
表5-2 上电/复位后硬件初始化表
内  容|状  态
串口初始化|按前面要求进行设置
CANA、B总线初始化|按通讯协议要求进行设置

硬件初始化完成后应用软件需对初始值不为0的变量初始化（系统软件已对B段变量清零），相应变量的初始化值见《卫星控制分系统控制计算机应用软件用户需求》和《卫星控制分系统注入参数及数据指令的用户需求》。应用软件需读取一次星时计数器值。
硬件和变量初始化完成后，应用软件连续进行5次星箭分离查询，每次间隔大于1ms。若连续3次查到星箭分离，则认为星箭已分离，置当前控制模式为“复位进入模式”，设置星时为0.75秒；否则认为星箭未分离，进行主动段初始化工作。",1,0,0,0,0,0,0,0,0,0,0
"软件需求标识：FREQ5 
软件需求名称：星时校正 
软件需求描述：星时校时。
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：滚动机动目标姿态确定。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：利用陀螺、红外、数字太阳、星敏感器诊断陀螺,0,0,0,0,0,1,0,0,0,0,0
"功能描述：接收发送OBDH重要数据
处理：数据不需要应用软件处理。",0,0,0,0,0,0,0,0,0,1,0
轨道计算包括卫星轨道和太阳方位计算、中继卫星轨道计算；GPS计算包括GPS数据转换为轨道平根数计算、GPS平根数数据转换为外推轨道数据计算；地磁场计算为通过轨道外推数据计算地磁场矢量分量。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：CAN通信上行/下行数据的组帧和解包。
调用条件：每个控制任务模式计算完成后；
输入：计算结果。
输出：按照协议组帧数据。
处理：主要完成下列数据组帧、解包功能：星务发送、快帧遥测1打包、快帧遥测2打包、快帧遥测3打包、快帧遥测4打包、快帧遥测5打包、慢帧遥测打包、姿态广播、星敏广播、陀螺广播、其他广播(行周期广播)、重要数据打包、上行:数据指令响应处理、上行:固定地址注入解包、上行:可变地址注入解包、上行:轨道注入解包、上行:程序注入、上行:内存下卸指令注入、上行:任务块、上行:地面站、重要数据返回解包、GPS定位广播解包、整星广播对时解包、GPS高精度秒脉冲对时广播解包、CAN总线使用要求",0,0,0,0,0,0,0,0,0,0,1
功能：利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移,0,0,1,0,0,0,0,0,0,0,0
"功能描述：发送AOCC指定内存内容
处理： 
（1）接收内存读出的地址和长度
（2）将对应地址和长度的内存数据放入发送内存读出数据的存储空间内
    AOCC应用软件应对内存下卸的地址区域进行保护：当内存下卸指令中的首地址、末地址均在PROM硬件地址范围、RAM硬件地址范围、1553B总线接口芯片的RAM地址范围内，则应用软件按照内存下卸指令的要求下卸目标区域的数据；若内存下卸指令中的地址超出上述3个区域的地址范围，则应用软件不更新1553B总线接口芯片中内存下卸内容子地址中对应数据。",0,0,0,0,0,0,0,0,0,0,1
功能描述：喷气卸载进入和退出条件计算。,0,1,0,0,0,0,0,0,0,0,0
CTU复位后需要从AOCC恢复重要数据和星上时间。首先CTU发送“接收用于做时间差值的时间码”指令，将CTU目前的时间发送给AOCC。AOCC将星上时间和接收到的CTU时间做差值处理，将AOCC时间-CTU时间保存。CTU在1s后发送“发送时间差值”指令，AOCC将保存的时间差值发送给CTU。,0,0,0,0,0,0,0,0,0,0,1
"软件需求名称：星历与轨道 
需求类别：其他 
软件需求描述：日月星轨道计算“计算太阳、月球、卫星位置矢量在地心J2000.0惯性系下的表示”；中继目标轨道计算“计算中继目标轨道”。 
表格工作项|软件需求标识|软件需求名称|
FREQ12.3-R4.3.1|日月星轨道计算|《用户需求》4.3.1|
FREQ12.3-R4.3.2|中继目标轨道计算|《用户需求》4.3.2|
",0,0,0,0,1,0,0,0,0,0,0
"功能描述：与动量轮通信，输出本周期电压。采集动量轮电源状态、转速、模拟量等信息。
处理：
功能编号|功能|引用文档|备注
FREQ57|动量轮初始化|任务书|B
FREQ58|动量轮数据采集|任务书|B
FREQ59|通信(DA输出、脉冲输入)|任务书|B
FREQ60|数据解包与转换|任务书|B
",0,0,0,0,0,0,0,1,0,0,0
"功能描述：与数字太阳通信，发送取数指令，获得部件数据。
处理：
在AOCC每个控制周期中可能会通过串口向数太发送控制指令或者接收下传数据，见任务书时序图。
功能编号|功能|引用文档
FREQ61|初始化|与一体化太阳通信协议
FREQ62|数太使用要求|任务书、数太协议
FREQ63|通信|任务书、数太协议
FREQ64|通信故障处理|任务书
FREQ65|数据解包与转换|数太协议
FREQ66|数太数据有效性判断、处理|任务书
FREQ67|数太模拟量采集、处理|预留
FREQ68|部件在轨转发（在轨修改）|预留
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：与发动机通信，输出本周期喷气脉宽。
处理：
功能编号|功能|引用文档|备注
FREQ52|UPS初始化|任务书|B
FREQ53|化学推进数据采集|任务书|B
FREQ54|推力器脉冲输出|任务书|B
FREQ55|推力器健康字设置|任务书|B
FREQ56|部件操作（程控490N点火，故障重构）|任务书|B
",0,0,0,0,0,0,0,1,0,0,0
"功能描述：选择通讯的天线LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
  （1）加电状态的判断：OBDH在给捕跟分系统发送加电命令的同时，将该命令发送给AOCC。AOCC根据命令字的内容，记录加电状态和工作的主备状态。当第一次得到加电指令时，如果没有主备命令，默认工作在主份；当没有加电，但是发送了主备切换命令，切换有效。中继捕跟分系统断电，再加电后，保留中继上次加电工作状态；当AOCC发生复位、NMI和切机时，保留中继上次加电工作状态。
（2）数据通讯：当接收到中继快扫命令，并且AOCC判断中继捕获跟踪分系统加电状态下，AOCC每个0.524秒控制周期，向GDA发送一次天线驱动机构双轴指向数据。并接收GDA传回的X、Y轴测量角度信号和两轴的偏差角度（X轴框架角、Y轴框架角、X轴偏差角、Y轴偏差角、X轴框架角速度、Y轴框架角速度）。当接收到中继停止命令或判断中继不加电，则停止通讯。",0,0,0,0,0,0,0,0,1,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|甚高三浮陀螺数据的采集与处理|FREQ1.2.1|""甚高三浮陀螺1553B取数指令
""|陀螺1-6的速度增量|在通讯允许的条件下（每个甚高陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。
|甚高光纤陀螺数据的采集与处理|FREQ1.2.2|甚高光纤陀螺1553B取数指令|陀螺7-9的速度增量|在通讯允许的条件下（每个光纤陀螺的当班标志为1），每周期向对应的陀螺RT发取数指令，获得陀螺数据并处理成对应的速度增量。获的是即为速度增量数据，直接乘当量就可以得到需要的结果；
",0,0,0,0,0,0,0,0,1,0,0
"“复位进入模式”中应用软件进行如下初始化工作：
置星时为2100秒；
置“向星务分系统申请重要数据”标志。
在“复位进入模式”中AO进行如下工作：
控制量输出均为0。部件开关设置为“不进行任何操作”。
响应星务分系统遥测轮询、数据遥控指令、数据注入、程序注入并进行相应处理，但不响应星务重要数据的轮询。
在“复位进入模式”中AO不进行控制律计算。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：动量轮启动的程控指令
      实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：， ，",0,1,0,0,0,0,0,0,0,0,0
"功能描述：选择三轴控制力
处理：根据推力器分支设置控制力。
说明：3种分支共计3组控制力（每组包括正负X轴，Y轴，Z轴共4个）",0,1,0,0,0,0,0,0,0,0,0
"功能描述：发送矢量字
处理：将包括服务请求编码的矢量字放到发送矢量字指定存储的地址空间即可。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：根据轨道数据计算偏流角。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：为三轴姿态喷气控制选择推力器。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：发送和接收OBDH重要数据1、2、3
处理：软件初始化后不用做处理，应用软件只需在初始化时为它指定存储的地址空间即可。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：使用星敏感器A、C的测量，修正姿态四元数与姿态角速度。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：模拟量遥测 
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：进行模式初始化。
处理：
（1）置帆板归零； 
（2）置 ===0；=0;= 0；",0,0,0,1,0,0,0,0,0,0,0
"功能描述：使用星敏感器C的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据陀螺输入，予估卫星对地姿态。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：将GPS轨道参数转换成16个轨道参数,0,0,0,0,1,0,0,0,0,0,0
功能描述：星上实时计算中继星的轨道。,0,0,0,0,1,0,0,0,0,0,0
功能描述：动量轮喷气卸载进入和退出条件计算。,0,1,0,0,0,0,0,0,0,0,0
"功能描述、输入、输出、计算公式见《用户需求》4.8.1~4.8.8。
序号|功能点编号|功能描述|说明
|FREQ3.4.10.1|陀螺故障检测及选择|《用户需求》4.8.1
|FREQ3.4.10.2|加速度计故障检测及选择|《用户需求》4.8.2
|FREQ3.4.10.3|星敏感器故障检测及选择|《用户需求》4.8.3
|FREQ3.4.10.4|系统故障检测及选择|《用户需求》4.8.4
|FREQ3.4.10.5|加计通讯故障处理|《用户需求》4.8.5
|FREQ3.4.10.6|陀螺通讯故障处理|《用户需求》4.8.6
|FREQ3.4.10.7|测速波束有效性检测及选择|《用户需求》4.8.7
|FREQ3.4.10.8.1|单机类故障诊断_陀螺|《用户需求》4.8.8 
|FREQ3.4.10.8.2|单机类故障诊断_加计|《用户需求》4.8.8
|FREQ3.4.10.8.3|单机类故障诊断_星敏|《用户需求》4.8.8
|FREQ3.4.10.8.4|单机类故障诊断_微波测距测速|《用户需求》4.8.8
|FREQ3.4.10.8.5|单机类故障诊断_激光测距|《用户需求》4.8.8
|FREQ3.4.10.8.6|单机类故障诊断_激光测速|《用户需求》4.8.8
|FREQ3.4.10.8.7|自主启动IMU数据存储|《用户需求》4.8.8
",0,0,0,0,0,1,0,0,0,0,0
"需求名称|功能描述
部件数据有效性判断|对部件采样数据的有效性进行判断，并选择引入闭环控制系统的数据
陀螺数据有效性判断|判断定姿用陀螺数据的有效性，选择参与定姿的陀螺
模拟太阳敏感器数据有效性判断|确定ASS21，ASS22，ASS31，ASS32及帆板角度传感器，等的信号选取
红外地球敏感器数据有效性判断|判断红外地球敏感器有效性
星敏感器数据有效性判断|对星敏感器输出数据进行有效性判断，并选取定姿星敏组合
数字太阳敏感器数据有效性判断|对数字太阳敏感器输出数据进行有效性判断
RS422通讯故障诊断|进行RS422通讯故障诊断及处理
光纤陀螺通讯诊断及处理|进行光纤陀螺通讯故障诊断及处理
数字太阳通讯诊断及处理|进行数字太阳通讯故障诊断及处理
太阳模拟量通讯诊断及处理|进行太阳通讯故障诊断及处理
对地数传天线通讯诊断及处理|进行对地数传天线通讯故障诊断及处理
中继天线通讯诊断及处理|进行中继天线通讯故障诊断及处理
1553B内总线通讯故障诊断|进行1553B内总线通讯故障诊断及处理
红外通讯故障诊断|红外通讯故障诊断及处理
甚高陀螺通讯故障诊断|大量程通讯故障诊断及处理
ACU通讯故障诊断|ACU通讯故障诊断及处理
帆板通讯故障诊断|帆板通讯故障诊断及处理
多头星敏通讯故障诊断|多头星敏通讯故障诊断及处理
1553B内总线总线监视及处理要求|CCU作为内1553B总线的BC，在与各RT通讯时需要进行总线状态监视
部件故障诊断与处理|确定各敏感器和执行机构故障诊断及处理
动量轮故障检测|检测工作中的大力矩飞轮的故障
推进喷气异常检测|检测推力器微漏、过量喷气等，必要时作相应的主备份切换和禁止
帆板故障诊断|帆板故障检测及处理
模式1的系统故障诊断|在模式1中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式2的系统故障诊断|在模式2中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式3的系统故障诊断|在模式3中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式5的系统故障诊断|在模式5中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式7的系统故障诊断|在模式7中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式8的系统故障诊断|在模式8中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
模式9的系统故障诊断|在模式9中，根据姿态角和姿态角速度偏差等数据进行系统故障的检测
磁力矩器数模一致性诊断|磁力矩器数模一致性诊断
DSS输出一致性诊断|DSS输出一致性诊断
ASS1输出一致性诊断|ASS1输出一致性诊断
ACU 1553B接收故障诊断及处理|由于卫星的执行机构控制均需通过ACU进行，当ACU接收控制指令内存区异常将导致卫星失去控制能力，因此有必要对ACU接收执行机构控制指令的正确性进行判断。在检测到执行机构控制指令接收校验和异常后CCU需要自主进行处理",0,0,0,0,0,0,1,0,0,0,0
功能描述：计算在整星角动量偏置下，CMG控制时的框架角速率指令。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：对星敏感器输出数据进行有效性判断。
输入：STSFailureDiagPermFlag, ZT6，星敏1 输出四元数，
星敏2输出四元数，星敏3输出四元数，预估四元数
t， t星A，t星B ，t星C ,  tmdts ,ZAR , ZBO Z , ZCR Z ,  ms ,  ms1 ,  ms2 ， ms3。
输出：ZA，XA，ZB，XB，ZC，XC，
星敏感器参与定姿标志FSTA，FSTB，FSTC，FSTD 。",0,0,0,0,0,0,1,0,0,0,0
"功能描述：用整星广播时间校正星上时间
处理：解包广播校时数据，
- 若为星务UTC校时，计算星务星箭分离星时；
- 若当前星时与星务星箭分离星时相差绝对值小于dt，则实施校时；否则不校时。
- 校时成功后，更新星敏、CCD、微波测距仪、可见光相机的同步信号基准时刻。
说明：上电/复位时，dt = 200秒；成功校时后，dt = 10秒",0,0,0,0,0,0,0,0,0,1,0
"功能描述：0.262秒的中断服务主程序。
处理： 
STEP1：若ZT36=5,则进入自旋模式；
STEP2：
STEP3：若BZ8=5,则进行STEP4，否则返回；
STEP4：陀螺数据输入及转换
STEP5：若BZ1 = 3，FSA = 0，则进行姿态预估器（4）和Z轴捕获太阳；
STEP6：若BZ1 = 6，则：
调用姿态预估器（2）；
，
STEP7：进行轨控开关机，轨控段喷气姿态控制，飞轮动量保持控制及飞轮启动；
STEP8：若BZ1 = 5，则：
帆板未展开模式。",0,0,0,1,0,0,0,0,0,0,0
功能描述：根据飞轮实测角动量和标称角动量计算三轴等效角动量偏差。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：姿态机动过程目的姿态确定。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据红外信息，作姿态滤波修正。
",0,0,1,0,0,0,0,0,0,0,0
"功能：利用星敏感器A、B的测量，修正姿态四元数与估计角速度。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：根据红外、太阳、星敏感器的输出数据判断陀螺故障。,0,0,0,0,0,1,0,0,0,0,0
"    各个模式切换的功能点列表如下：
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ5.1.0|4|主动段模式切换条件判断及转出设置
|入轨段控制模式切换|FREQ5.1.1|4.1|入轨段控制模式切换条件判断及转出设置
|正常对地运行模式切换|FREQ5.1.2|4.2|正常对地运行模式切换条件判断及转出设置
|点对点机动模式切换|FREQ5.1.3|4.3|点对点机动模式切换条件判断及转出设置
|姿态/角速度预置模式切换|FREQ5.1.4|4.4|姿态/角速度预置模式切换条件判断及转出设置
|偏置飞行模式切换|FREQ5.1.5|4.5|偏置飞行模式切换条件判断及转出设置
|匀地速跟踪模式切换|FREQ5.1.6|4.6|匀地速跟踪模式切换条件判断及转出设置
|角速度跟踪模式切换|FREQ5.1.7|4.7|角速度跟踪模式切换条件判断及转出设置
|轨控模式切换|FREQ5.1.8|4.9|轨控模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ5.1.9|4.10|全姿态捕获模式切换条件判断及转出设置
|无控模式切换|FREQ5.1.10|4.11|无控模式切换条件判断及转出设置
|测试与标定模式切换|FREQ5.1.11|4.8|测试与标定模式切换条件判断及转出设置

切换条件具体见用户需求4。CCU切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
功能：利用红外、数字太阳敏感器确定姿态。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据从SLTU接收的0.25秒或1秒内陀螺的角度增量，算出卫星在惯性空间的角速度。
输入：0.25秒或1秒内陀螺的角度增量 (量纲：弧度)
(i=1,2,3,…6，依次表示陀螺G1，G2，…，G6的输出)；
采样周期 (量纲：秒)；
陀螺数据有效性标志F_GyroValid(由陀螺有效性判据给出)。
陀螺系统在星体三轴方向等效的常值漂移估值 (量纲：弧度/小时)
星敏感器数据有效性标志：F_SAValid，F_SBValid，F_SCValid",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收GPS秒脉冲整秒时间,0,0,0,0,0,0,0,0,0,1,0
"功能描述：选择通讯的帆板LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）帆板共有四个LTU，各有两个互为备份的LTU，通过每个LTU均可获得对应的帆板转角和零位信息；每个控制周期根据BAPTALTUSeltFlag确定进行通讯的帆板LTU，发送取数指令。
（2）向帆板LTU发完取数命令后，获得LTU返回数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式。在控制周期任务后根据帆板控制算法算出需要发送的帆板控制指令。
（3）帆板LTU数据采集过程中的故障处理见任务书中规定。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：接收GPS数据、接收积分时间、AOCC姿态数据、相机测温参数
处理：将接收GPS数据存储地址中内容解包成对应的UTC时间、位置和速度数据和轨道数据的数据格式。由于GPS数据中有数据有效性标志，所以其中的微秒部分不考虑大于1秒的情况，由GPS保证。",0,0,0,0,0,0,0,0,0,1,0
功能：利用星敏感器B、C的测量，修正姿态四元数与估计陀螺漂移。,0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控中继星轨道注入块,0,0,0,0,0,0,0,0,0,1,0
"AppInit中星箭分离的查询
硬件初始化后，按5取3的方式查星箭分离状态位(对星箭分离状态位读5次，有连续3次或3次以上读入为“1”，则认为查到星箭已分离，每次读的时间间隔要求大于1ms)。
AppInit中星箭未分离的初始化
如果星箭未分离，对应用软件相关变量、硬件初始化。进入主动段工作模式。在主动段工作模式下，每个控制周期按5取3的方式查星箭分离状态位，如果连续3个周期内都查到星箭已分离，则可确认为星箭已分离。进入初始速率阻尼模式，并置星时0.375s。
AppInit中星箭已分离的初始化
对应用软件相关变量、硬件初始化，星时清0，进入复位模式。
在复位模式下，与星务分系统通讯，取回保存在星务分系统的重要数据，具体见《卫星姿轨控分系统AOCC与星务通讯协议》。如果取数成功，根据控制模式字进入初始化。若连续5秒从星务分系统取重要数据失败则认为申请失败。取重要数据不成功，设置工作模式为“太阳捕获模式”，星时为2100秒，发送CMG1~5“复位及高速断电”指令。ALTU当班状态根据前面章节的内容进行复位后设置；切除6个陀螺，发送“陀螺1~5开”指令，新加电陀螺等10分钟后引入，并置状态分为120，10分钟内系统不引入，不进行速率阻尼。",1,0,0,0,0,0,0,0,0,0,0
功能描述：计算磁卸载所需的磁矩与磁力矩器工作电压,0,1,0,0,0,0,0,0,0,0,0
OBDH分系统每8分钟给AOCC校时一次。,0,0,0,0,0,0,0,0,0,1,0
功能描述：数传天线数据处理,0,0,0,0,0,0,0,0,1,0,0
功能描述：计算CMG群的合成角动量标称值。,0,1,0,0,0,0,0,0,0,0,0
"软件需求标识：FREQ16 
软件需求名称：加速度计数据处理 
需求类别：其他 
软件需求描述：加速度计数据处理。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：启动动量轮至标称角动量，并保持。
",0,1,0,0,0,0,0,0,0,0,0
功能描述：卫星丢失姿态后，利用红外地球敏感器直接捕获地球，建立正常对地姿态。,0,0,1,0,0,0,0,0,0,0,0
"功能：利用估计的四元数转换姿态角，送给星敏感器的四元数。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：姿态角速度与姿态四元数的预估，包括使用陀螺数据和不使用陀螺数据的姿态四元数预估。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：根据任务要求，应用软件进行LTU初始化、1553B初始化、调用系统软件的StartStarTimer、变量的初始化
处理：
进行1553B初始化，处理过程见4.3.2的OBDH初始化功能
GPS秒脉冲信号接口寄存器初始化
设置3个星敏的 RTS信号为无效
把模式字初始化为零
上电时，将在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff；复位时，若在轨维护程序区未发生双错，则应用软件从三取二区恢复在轨注入模块地址映射表JumpSlot、继续运行在轨维护程序；若在轨维护程序区发生双错，则应用软件不恢复在轨注入模块地址映射表JumpSlot，同时在轨注入模块地址映射表中的模块ID的三区都置为0，把和注入模块的地址三区都置为0Xffffffff，运行原PROM区的函数模块
为变量赋初值，因为上电或复位时，系统软件都先把变量区清零，应用软件只需将不为零的变量赋值即可。",1,0,0,0,0,0,0,0,0,0,0
"功能描述：实时计算卫星轨道参数及太阳方位、太阳敏感器理论输出。
处理：其中除的精确计算算法外为可复用需求，可使用软件中心的构件库中的软件代码。",0,0,0,0,1,0,0,0,0,0,0
"功能描述：姿态角、角速度与姿态四元数预估。
",0,0,1,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ3.1|5.2.1|把陀螺数据、、、变换到星体系中的、、
|陀螺预估惯性姿态|FREQ3.2|5.2.2|根据陀螺输入，预估卫星惯性姿态
|陀螺预估对地姿态|FREQ3.3|5.2.3|根据陀螺测量输出，一步预估卫星姿态
|陀螺预估惯性四元数|FREQ3.4|5.2.4|根据陀螺测量输出，一步预估卫星惯性姿态
|动力学预估惯性四元数|FREQ3.5|5.2.5|根据动力学模型，预估卫星惯性姿态
|基于红外滤波的卫星姿态确定|FREQ3.6|5.2.6|根据陀螺预估结果和红外(和数字太阳)输出，确定卫星姿态
|星敏感器与陀螺姿态修正|FREQ3.7|5.2.7|利用星敏感器和陀螺的输出或仅利用陀螺预估输出计算卫星欧拉角和四元数
|单星敏感器的姿态修正|FREQ3.7.1|5.2.7.1|利用单个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|双星敏感器的姿态修正|FREQ3.7.2|5.2.7.2|利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|对地姿态修正|FREQ3.7.3|5.2.7.3|利用估计的四元数转换姿态角
|星敏感器与动力学姿态修正|FREQ3.8|5.2.8|利用星敏感器的输出计算卫星欧拉角和四元数
|仅单星敏感器的姿态修正|FREQ3.8.1|5.2.8.1|仅利用单个星敏感器的测量，修正姿态四元数与姿态角速度
|仅双星敏感器的姿态修正|FREQ3.8.2|5.2.8.2|仅利用两个星敏感器的测量，修正姿态四元数与估计陀螺漂移
|无陀螺对地姿态修正|FREQ3.8.3|5.2.8.3|利用估计的四元数转换姿态角，送给星敏感器的四元数
|红外与太阳双矢量定姿|FREQ3.9|5.2.9|利用红外、数字太阳敏感器确定姿态
|星敏感器相对基准标定|FREQ3.10|5.2.10|对星敏的相对基准进行标定，修正星敏安装矩阵
|星敏感器双矢量姿态确定|FREQ3.11.1|5.2.11.1|利用星敏的测量，确定单点的卫星姿态四元数。
|星敏姿态四元数重置|FREQ3.11.2|5.2.11.2|进行卫星姿态四元数的重置
|三轴欧拉姿态角预估算法产品规范|FREQ3.1.1|/|规范化算法：
|姿态四元数预估算法产品规范|FREQ3.1.2|/|规范化算法：
|重力梯度力矩计算算法产品规范|FREQ3.1.3|/|规范化算法：
|基于红外测量的红外滤波修正算法产品规范|FREQ3.1.4|/|规范化算法：
|基于单星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.5|/|规范化算法：
|基于双星敏感器测量矢量点乘信息的滤波修正算法产品规范|FREQ3.1.6|/|规范化算法：
|基于红外与太阳矢量的双矢量定姿算法产品规范|FREQ3.1.7|/|规范化算法：
|星敏感器相对基准的在轨标定算法产品规范|FREQ3.1.8|/|规范化算法：
|目标姿态计算流程|FREQ3.12|5.3.1|""计算模式的目标姿态
""
|点对点机动目标姿态计算|FREQ3.12.1|5.3.1.1|点对点机动目标姿态计算
|轨控目标姿态计算|FREQ3.12.2|5.3.1.2|轨控目标姿态计算
|姿态机动初始化|FREQ3.12.3|5.3.2|三轴姿态机动目标姿态确定的初始化。根据目标角和星体机动前姿态求出欧拉轴/角，以及轨迹的加速，匀速和减速等特征时间点。
|""理论偏流角计算
""|FREQ3.12.4.1|5.3.3.1|""适用于地球椭球模型，基于星体姿态描述为1-2-3 转序计算基于星体+Z 轴或基于指定基准轴（该轴应在XOZ 平面内）情况下的偏流角。
""
|偏流角平滑及偏流角速度计算|FREQ3.12.4.2|5.3.3.2|对偏流角修正启动与停止过程中的偏流角进行平滑处理，并计算偏流角速度。
|太阳高度角计算|FREQ3.12.4.3|5.3.3.3|根据偏流角修正基准计算太阳高度角
|姿态控制量计算|FREQ3.19|5.2.12|根据姿态确定结果和目标姿态计算结果计算误差姿态角和误差姿态角速度
|引入系统闭环姿态确定|FREQ3.20|5.2.13|根据定姿标志确定引入系统的闭环姿态
|陀螺标定过程目标姿态计算|FREQ3.25.0|5.11.1|陀螺标定全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角
|目标姿态计算初始化|FREQ3.25.1|5.11.1.1|对陀螺标定过程中涉及到的两次机动过程进行机动姿态计算的初始化
|惯性姿态点对点机动轨迹规划|FREQ3.25.2|5.11.1.2|对陀螺标定过程所涉及到的两次点对点机动进行轨迹规划
|角速度起速保持与减速过程轨迹规划|FREQ3.25.3|5.11.1.3|对陀螺标定过程中的速度运行进行轨迹规划
|惯性定向时转阶段处理|FREQ3.25.5|5.11.1.5|陀螺标定在第1段中完成惯性定向，并在此期间标定陀螺真实常漂。在惯性定向转速度运行结束时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等。
|速度运行时转阶段处理|FREQ3.25.6|5.11.1.6|SubMode= 2~9，陀螺按照规定的角速度完成起速、恒速运行、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化，并记录陀螺的等效常漂，星体的惯性角速度估计等
|速度曲线规划|FREQ3.25.7|5.11.1.7|根据所选择的机动轨迹，规划出角速度变化曲线
|陀螺标定算法|FREQ3.26.0|5.11.2|在标定过程中，对各个阶段的陀螺等效常漂进行估计
|陀螺常漂修正标志确定|FREQ3.26.1|5.11.2.1|对陀螺标定过程中，陀螺常漂的修正标志进行确定。当星体达到了规定的惯性角速度时，开始进行陀螺常漂估计
|基于星敏陀螺滤波的等效常漂估计|FREQ3.26.2|5.11.2.2|采用星敏陀螺滤波的方法对陀螺等效常漂进行估计
|星敏陀螺滤波的陀螺等效常漂记录|FREQ3.26.3|5.11.2.3|对陀螺等效常漂，选取稳态时的一段数据进行平均，得到各个角速度下的等效常漂和星体真实角速度的估计值
|小角速度时的陀螺安装误差和刻度因子误差估计|FREQ3.26.4|5.11.2.4|经过N次速度机动后，对陀螺的测量模型进行标定，给出标定结果
|陀螺在轨标定时的控制量计算|FREQ3.27|5.11.3|对标定过程中的控制量进行计算
|陀螺安装误差标校结果引入|FREQ3.28|5.11.4|对陀螺完成标定后，待地面确认标定结果无误后，将陀螺的标定结果进行赋值。当地面注入FP__MountingCmp时执行本程序一次
|惯性姿态预处理初始化|FREQ3.29.1.1|5.12.1.1|计算惯性定向及扫描的机动参数
|相机扫描速度建立参数计算|FREQ3.29.1.2|5.12.1.2|计算由建立扫描速度初始姿态到建立恒定速度的时间，以及扫描结束后星体静止后的惯性姿态。
|星体阻尼结束至惯性定向姿态建立参数计算|FREQ3.29.1.3|5.12.1.3|计算星体阻尼结束后的姿态调整到凝视标定的惯性定向姿态，或天区扫描速度建立前所需初始惯性姿态
|惯性目标姿态计算|FREQ3.29.2.0|5.12.2|全过程的目标姿态计算，包括目标惯性角速度和目标四元数，并在回轨道对地零姿态过程中计算目标欧拉角。
|惯性定向轨迹规划|FREQ3.29.2.1|5.12.2.1|对惯性再定向过程进行轨迹规划
|惯性定向转阶段处理|FREQ3.29.2.2|5.12.2.2|惯性再定向转换处理
|惯性空间扫描轨迹规划|FREQ3.29.2.3|5.12.2.3|对惯性空间扫描过程进行轨迹规划
|惯性扫描转阶段处理|FREQ3.29.2.4|5.12.2.4|SubMode = 2，按照规定的角速度完成角速度的建立、恒速扫描、减速和惯性定向四个步骤后，在转入下一个阶段时，对各变量进行初始化
|目标姿态计算初始化|FREQ3.29.2.5|5.12.2.5|对SubMode=1/10子模式进行机动姿态计算的初始化
|惯性定向姿态控制量计算|FREQ3.29.3|5.12.3|对惯性定向过程中的控制量进行计算
|星敏感器的粗姿态计算|FREQ3.30|5.2.14|计算提供给星敏感器的粗姿态
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：进行单轴相平面分区及控制规律计算。由、、决定是否要喷气；喷气的脉冲宽度；确定本时刻的。
",0,1,0,0,0,0,0,0,0,0,0
"根据不同的任务要求划分了各个模式，模式控制作为一个功能的集合体反映了任务的执行情况，是确认测试和系统实验验证的要的功能。
序|需求名称|编号|输入章节号|功能描述
|主动段模式控制|FREQ44.0|3.3.0|主动段模式调用流程
|入轨消初偏模式控制|FREQ44.1|3.3.1|入轨消初偏模式调用流程
|红外引入对地粗定向模式控制|FREQ44.2|3.3.2|红外引入对地粗定向模式调用流程
|动量轮启动模式控制|FREQ44.3|3.3.3|动量轮启动模式调用流程
|正常轨道运行模式控制|FREQ44.4|3.3.4|正常轨道运行模式调用流程
|轨控模式1模式控制|FREQ44.5|3.3.5|轨控模式1模式调用流程
|由正常姿态进行姿态机动模式控制|FREQ44.6|3.3.6|由正常姿态进行姿态机动模式调用流程
|轨控模式2模式控制|FREQ44.7|3.3.7|轨控模式2模式调用流程
|由轨控姿态机动回正常轨道运行模式控制|FREQ44.8|3.3.8|由轨控姿态机动回正常轨道运行模式调用流程
|全姿态捕获模式控制|FREQ44.9|3.3.9|全姿态捕获模式调用流程
|应急安全模式模式控制|FREQ44.10|3.3.10|应急安全模式模式调用流程
|停控模式控制|FREQ44.11|3.3.11|停控模式调用流程
|帆板未展开模式控制|FREQ44.12|3.3.12|帆板未展开模式调用流程
|偏置动量控制模式控制|FREQ44.13|3.3.13|偏置动量控制模式调用流程

主动段模式下并不进行姿态确定和控制的计算，其它各个模式控制中调用卫星轨道和星历计算、姿态确定、姿态和轨道控制及部件有效性和故障诊断以及模式初始化的内容具体见用户需求的3。",0,0,0,1,0,0,0,0,0,0,0
功能描述：对帆板驱动装置进行控制和诊断。,0,0,0,0,0,1,0,0,0,0,0
"功能描述：接收AOCC系统注入参数
处理：
当收到接收遥控注入结束标识消息后，将接收AOCC系统注入参数存储地址中内容解包成对应的参数和变量的数据格式。只有当某个块类型的所有数据都收到，且每块数据的校验和都正确时，才能使用此种类型的注入数据。注入的数据具体见上行注入文件。需要注意的是：地面注入ZT9时：若ZT9中为1的个数小于3个，则不改变星上ZT9的取值；应用软件不响应ZT1=2、ZT1=6、ZT1=8的注入指令。",0,0,0,0,0,0,0,0,0,1,0
功能描述：检测红外HL、HR 的故障，并选取正确的红外信号。,0,0,0,0,0,0,1,0,0,0,0
"功能描述：卫星丢失姿态后，使用红外地球敏感器直接捕获地球，建立正常对地姿态。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：在CMG控制期间按照一定算法对磁力矩器施加控制电压，所产生磁矩与实际地磁场相互作用产生磁控力矩对CMG进行卸载。,0,1,0,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|星时计算|FREQ1.4.1|上周期绝对星时；上周期锁存的星时计数器的值|本周期的绝对星时|""每周期无条件的进行星时的计算。处理要求见任务书。
""
|OBDH星时校时|FREQ1.4.2|""OBDH校时指令中的绝对星时;
及对应锁存的对应时间的星时计数器的值""|上周期绝对星时；上周期锁存的星时计数器的值|采用OBDH校时方式时，每秒有OBDH校时指令时进行校时。处理见任务书。
|GPS秒脉冲高精度校时|FREQ1.4.3|""GPS秒脉冲校时指令中的绝对星时;
及对应锁存的对应时间的星时计数器的值""|上周期绝对星时；上周期锁存的星时计数器的值|采用GPS秒脉冲方式时，每秒有GPS秒脉冲指令时进行校时。处理要求见任务书。
|两种校时方式的切换|FREQ1.4.4||校时方式标志|OBDH星时校时、GPS秒脉冲高精度校时是否引入系统由注入指令控制，OBDH星时校时为系统默认使用的校时方式。具体见任务书要求
|星敏感器数据星时时标处理|FREQ1.4.6|同步标志；本周期的绝对星时；本周期锁存星时计数值；锁存的星敏同步计数值|星敏感器测量数据对应的星时|具体处理要求见任务书。
",0,0,0,0,0,0,0,0,1,0,0
"序|需求名称|编号|功能及处理描述
|加电状态的采集与处理|FREQ7.1|从SDC获取部件供电状态信息
|切换指令的处理|FREQ7.2|发送SDC指令。
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：与星敏感器通信，获得星敏感器数据。
处理：
见星敏通信协议、任务书附录1时序。
功能编号|功能|引用文档|备注
FREQ34|星敏初始化|星敏协议|B
FREQ35|星敏数据采集|任务书|A
FREQ36|数据解包与转换|星敏协议|A
FREQ37|星敏数据有效性判断|任务书|
FREQ38|星敏数据曝光时刻计算|任务书|
FREQ39|星敏数据有效性判断、处理|任务书|A
FREQ40|星敏故障重构|任务书|A
",0,0,0,0,0,0,0,0,1,0,0
功能：在不使用陀螺数据时，对姿态角、角速度与姿态四元数预估。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：使用星敏感器B、C的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：采集并处理四个动量轮加电状态，三路伽马关机敏感器关机信号，四路触地开关信号                                                                                                                                                                                                                                                                                                                                          处理：
序号|功能点编号|功能描述
1|FREQ3.3.1|动量轮加电状态
2|FREQ3.3.2|三路伽马关机敏感器关机信号
3|FREQ3.3.3|四路触地开关信号
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：转换动量轮脉冲得到轮子角动量。
处理：
控制系统配置4Nms平台动量轮4个（X、Y、Z、S）。平台动量轮每转18个脉冲，转/分钟对应4Nms。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：帆板驱动线路数据处理 
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：机动姿态保持模式控制
",0,0,0,1,0,0,0,0,0,0,0
功能描述：正常对地运行模式初始化,0,0,0,1,0,0,0,0,0,0,0
功能描述：计算地磁场矢量分量。,0,0,0,0,1,0,0,0,0,0,0
"软件需求名称：CMG使用及通信 
需求类别：其他 
软件需求描述：输出CMG控制指令。
处理： 
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
CMG初始化|FREQ61|CMG初始化|B|2
CMG数据采集|FREQ62|CMG数据采集|B|3
CMG数据解包与转换|FREQ63|CMG数据解包与转换|B|4
CMG指令输出|FREQ64|CMG指令输出|B|
",0,0,0,0,0,0,0,1,0,0,0
"软件需求名称：帆板使用及通信 
需求类别：其他 
软件需求描述：与帆板通信，控制帆板并获得帆板状态数据。
处理：
见通信协议。 
表格工作项|软件需求名称|软件需求标识|软件需求描述|1
帆板初始化|FREQ46|帆板初始化|B|2
帆板数据采集|FREQ47|帆板数据采集|B|3
数据解包与转换|FREQ48|数据解包与转换|B|4
帆板数据有效性判断、处理|FREQ49|帆板数据有效性判断、处理|B|5
帆板控制量输出|FREQ50|帆板控制量输出|B|6
帆板故障重构|FREQ51|帆板故障重构|C|
",0,0,0,0,0,0,0,1,0,0,0
功能描述：主动段模式控制,0,0,0,1,0,0,0,0,0,0,0
功能描述：将动量轮保持至标称角动量所需的电压。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：为机动过程姿态确定提供初始姿态。
",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的红外陀螺数据有效性及系统故障诊断修正系数,0,0,0,0,0,0,0,0,0,1,0
"软件需求标识：FREQ20 
软件需求名称：动量轮数据处理 
需求类别：其他 
软件需求描述：动量轮数据处理。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：主动段模式初始化
处理：
- WorkMode（工作模式）：0（主动段）；
- StarTime（星上时间）：0.0；
- 俯仰磁力矩器线路主份工作；
- 星务校时：禁止星务校时；
- 均匀校时：禁止均匀校时；",1,0,0,0,0,0,0,0,0,0,0
"序|需求名称|编号|输入|输出|功能及处理描述
|数字太阳数据的采集与处理|FREQ1.1.1|""数字太阳LTU取数指令
""|数字太阳角度和视场码DSS1输出滚动方向角度，DSS2输出俯仰方向角度|在通讯允许的条件下（当班标志为1），每周期向数字太阳LTU发取数指令，获得数字太阳数据并处理成滚动方向和俯仰方向角度以及相应的视场码。
|模拟太阳数据的采集与处理|FREQ1.1.2|""模拟太阳LTU取数指令
""|模拟太阳角度和视场码|每周期无条件的向模拟太阳LTU发取数指令，获得模拟太阳数据并处理成对应的角度。 
",0,0,0,0,0,0,0,0,1,0,0
"功能描述：发送AOCC时间
处理：
CTU加电或复位后通过子地址12（T/R＝0）向AOCC发送“接收记录AOCC时间数据”消息，消息内容为5555H。AOCC收到该消息后应在0.1s内准备好AOCC 时间数据，然后OBDH通过子地址12（T/R＝1）取走AOCC时间数据。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：由四元素来修正姿态（星测量回路），等；计算星敏感器光轴方位。
处理：更动：去掉星敏粗姿态计算。",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的系统功能参数设置区数据,0,0,0,0,0,0,0,0,0,1,0
"功能描述：处理地面遥控注入的固定地址参数
处理：
128-135：注入参数乘修正系数
515：全量校时处理：星时=全量校时星时
516：增量校时处理星时=星时+增量校时量
其它：更新注入的参数",0,0,0,0,0,0,0,0,0,1,0
"功能描述：利用估计的四元数转换姿态角，送给星敏感器的四元数。

",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收AOCC重要数据
处理：将接收AOCC重要数据地址中内容解包成重要数据的数据格式。
在AOCC上电/复位或者切机时，AOCC通过方式代码的服务申请，请求OBDH发送星上时间和AOCC重要数据。若连续60个控制周期申请AOCC重要数据失败（重要数据第一块的第一个字不是A090H或者校验和错误或者未收到重要数据），则应用软件按照重要数据的初始值运行。",0,0,0,0,0,0,0,0,0,1,0
"功能描述：星上自主检测陀螺故障。
",0,0,0,0,0,1,0,0,0,0,0
功能描述：根据从0.25秒/1秒内陀螺的角度增量，算出卫星在惯性空间的角速度。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：检测推力器的微漏，必要时作相应的主备份切换。
",0,0,0,0,0,1,0,0,0,0,0
"功能描述：决定利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：与CAN通讯获得上行/下行数据。
调用条件：AOCC被动接收/发送数据；
输入：上行数据。
输出：下行数据。
处理：通过CAN总线与星务分系统通讯，交换数据，以实现星地联系和对卫星的人工干预。主要完成下列功能：
AOCC向星务分系统发送数据（中断接收星务分系统命令，依据命令发送各类遥测参数）；
发送快帧遥测；
发送慢帧遥测；
将AOCC为星务保存的重要数据发送给星务分系统；
发送星敏感器和姿态辅助数据；
有内存下卸要求时，发送AOCC指定内存内容；
AOCC接收星务分系统数据（中断方式）包括接收固定地址参数注入；接收可变地址参数注入；接收轨道参数数据；接收程序注入；接收数据指令；接收重要数据返回；接收整星对时广播数据；接收GPS高精度秒脉冲对时广播；接收GPS导航数据等。
如果应用软件4s收不到星务分系统信息或连续100秒未收到符合通信协议的正确数据，对CAN总线控制器重新初始化。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：动量轮启动的程控指令
      实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：， ，
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：估计各个加速度计零位漂移增量
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：发送和接收时间差值
调用条件：有发送和接收时间差值命令字时
周期：CTU复位时
输入：星时，计数值
输出：时间差值
处理：具体处理要求见与外总线通讯协议。",0,0,0,0,0,0,0,0,0,0,1
"序号|功能描述|功能编号
|姿态数据包|FREQ60.1
|星敏感器数据包1|FREQ60.2
|星敏感器数据包2|FREQ60.3
|红外太阳修正数据包|FREQ60.4
|星敏感器修正数据包|FREQ60.5
|姿态控制数据包1|FREQ60.6
|姿态控制数据包2|FREQ60.7
|轨道数据包1|FREQ60.8
|轨道数据包2|FREQ60.9
|AOCC状态数据包|FREQ60.10
|LTU自检数据包|FREQ60.11
|星敏感器自检数据包|FREQ60.12
|变轨数据包|FREQ60.13
|正常模式和发射模式延时遥测数据|FREQ60.14
|应急模式延时遥测数据|FREQ60.15
|全姿态捕获模式延时遥测数据|FREQ60.16
|变轨模式延时遥测数据|FREQ60.17

具体格式和定义见遥测文件。",0,0,0,0,0,0,0,0,0,0,1
功能描述：AOCC收到CTU发来的“记录AOCC时间数据”消息后应在900ms内准备好AOCC 时间数据。CTU发出“记录AOCC时间数据”1s后读取该数据。,0,0,0,0,0,0,0,0,0,0,1
"    各个模式切换的功能点列表如下： 
序|需求名称|编号|输入章节号|功能描述
|主动段模式切换|FREQ43.0|3.3.0|主动段模式切换条件判断及转出设置
|入轨消初偏模式切换|FREQ43.1|3.3.1|入轨消初偏模式切换条件判断及转出设置
|红外引入对地粗定向模式切换|FREQ43.2|3.3.2|红外引入对地粗定向模式切换条件判断及转出设置
|动量轮启动模式切换|FREQ43.3|3.3.3|动量轮启动模式切换条件判断及转出设置
|正常轨道运行模式切换|FREQ43.4|3.3.4|正常轨道运行模式切换条件判断及转出设置
|轨控模式1模式切换|FREQ43.5|3.3.5|轨控模式1模式切换条件判断及转出设置
|由正常姿态进行姿态机动模式切换|FREQ43.6|3.3.6|由正常姿态进行姿态机动模式切换条件判断及转出设置
|轨控模式2模式切换|FREQ43.7|3.3.7|轨控模式2模式切换条件判断及转出设置
|由轨控姿态机动回正常轨道运行模式切换|FREQ43.8|3.3.8|由轨控姿态机动回正常轨道运行模式切换条件判断及转出设置
|全姿态捕获模式切换|FREQ43.9|3.3.9|全姿态捕获模式切换条件判断及转出设置
|应急安全模式模式切换|FREQ43.10|3.3.10|应急安全模式模式切换条件判断及转出设置
|停控模式切换|FREQ43.11|3.3.11|停控模式切换条件判断及转出设置
|帆板未展开模式切换|FREQ43.12|3.3.12|帆板未展开模式切换条件判断及转出设置
|偏置动量控制模式切换|FREQ43.13|3.3.13|偏置动量控制模式切换条件判断及转出设置

切机或复位后通过OBDH恢复重要数据来恢复模式，具体见重要数据文件要求。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：动量轮摩擦力矩的补偿电压计算。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：选择通讯的太阳LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
输出：数字太阳敏感器输出；模拟太阳敏感器输出；模拟式太阳敏感器视场码；0-1式太阳敏感器的信号（0或1）；数字太阳敏感器视场码。
处理：
（1）太阳共有两个互为备份的LTU，通过每个LTU均可获得数字太阳、模拟太阳、0-1太阳数据；每个控制周期根据DSSLTUSeltFlag确定进行通讯的太阳LTU，发送取数指令，具体如下表所示：
DSSLTUSeltFlag |进行通讯的太阳LTU|发送的取数指令
01H|太阳LTU1|43H
02H|太阳LTU2|43H
其它|根据LTU故障诊断的结果决定太阳LTU的选取。初始状态为太阳LTU1|43H

（2）向太阳LTU发完取数命令后，获得太阳LTU返回的个字节数据，将数据根据LTU通讯协议转换为控制计算所需的数据格式，具体参见LTU通讯协议件。
（3）太阳LTU数据采集过程中的故障处理见任务书中规定。",0,0,0,0,0,0,0,0,1,0,0
功能描述：由数字太阳粗码得到数字太阳角、全开码、见太阳标志。,0,0,0,0,0,0,0,0,1,0,0
"功能描述：采集陀螺的数据，并处理成需要的数据格式。
处理：
（1）从A/D输入采集陀螺的数据，转换为角速度
（2）乘以控制周期得到速度增量",0,0,0,0,0,0,0,0,1,0,0
"功能描述：发送高精度姿态数据
处理：每个控制周期查询一次是否需要进行数据打包，若需要，则进行数据打包。",0,0,0,0,0,0,0,0,0,0,1
"序|需求名称|编号|输入章节号|功能描述
|陀螺数据处理|FREQ12|4.2.1|将陀螺有效输出数据，换算成卫星三轴角度增量
|欧拉角姿态预估|FREQ13|4.2.2|根据陀螺输出，预估卫星姿态和姿态角速度
|红外输出的数据处理|FREQ14|4.2.3.1|根据红外输入，计算姿态偏差、弦宽误差估计与量测新息
|太阳输出的数据处理|FREQ15|4.2.3.2|根据姿态估值与数字太阳输出，计算量测的一步预测与新息
|红外的姿态修正|FREQ16|4.2.4.1|根据红外输出，估计卫星姿态与陀螺漂移
|红外与数字太阳双矢量滤波姿态修正|FREQ17|4.2.4.2|利用双矢量姿态输出修正姿态估值、估计陀螺漂移及红外常值误差
|正常模式姿态四元数预估|FREQ18|4.2.5.1|姿态角速度与姿态四元数的预估，包括使用陀螺数据和不使用陀螺数据的姿态四元数预估
|星敏感器数据预处理与姿态修正|FREQ19|4.2.5.2|利用星敏感器A、B单独或组合定姿的方式，调用相应姿态修正程序
|星敏感器A、B姿态修正|FREQ20|4.2.5.3|利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移
|星敏感器A姿态修正|FREQ21|4.2.5.4|利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移
|星敏感器B姿态修正|FREQ22|4.2.5.5|利用星敏感器B的测量，修正姿态四元数与估计陀螺漂移
|正常飞行模式的姿态角估计|FREQ23|4.2.5.9|利用估计的四元数转换姿态角
|由正常模式机动起始时刻的姿态四元数|FREQ24|4.2.6.1|为机动过程姿态确定提供初始姿态
|从偏置机动回正常模式时机动起始时刻的姿态四元数|FREQ25|4.2.6.2|为该机动过程姿态确定提供初始姿态
|机动过程与轨控模式的姿态确定|FREQ26|4.2.6.3|利用陀螺确定出卫星对目标的姿态四元数
|从偏置飞行机动回正常模式后的初始姿态换算|FREQ27|4.2.6.4|为正常模式姿态确定提供初始姿态
|计算星敏感器定姿需要的初始姿态|FREQ28|4.2.7|为星敏感器定姿提供初始的相对惯性的姿态四元数。
|红外与数字太阳双矢量定姿|FREQ29|4.2.8|利用红外、数字/太阳敏感器确定姿态
|星敏感器双矢量定姿|FREQ30|4.2.9|利用星敏感器A、B的测量，估计姿态
|不使用陀螺数据的星敏感器A、B姿态修正|FREQ87|4.2.5.6|利用星敏感器A、B的测量，修正姿态四元数
|不使用陀螺数据的星敏感器A姿态修正|FREQ88|4.2.5.7|利用星敏感器A的测量，修正姿态四元数
|不使用陀螺数据的星敏感器B姿态修正|FREQ89|4.2.5.8|利用星敏感器B的测量，修正姿态四元数
|红外差分姿态确定算法|FREQ90|4.2.10|无陀螺时用红外估计滚动、俯仰姿态角及角速度信息
|卫星跟踪姿态及对地表定向目标角计算|FREQ90.1|""4.2.13
4.2.13.1""|计算卫星正常对地跟踪姿态及对地表定向目标角
|偏航目标角计算|FREQ90.2|4.2.13.2|计算偏航跟踪目标姿态，实现帆板对日定向
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：发送遥测数据块
处理： 处理过程如下：
OBDH每个实时遥测帧周期（0.8秒）从AOCC获取并下发60字节DS量遥测数据。每个遥测格式分64帧，以F0---F63标记，每帧所要求AOCC传送的内容各不相同，按数据更新情况分为快速数据（DF），中速数据（MF），慢速数据（SF）。每种数据在不同的卫星的姿态控制方式下，所要求传送的DS遥测量是不同的，可分为三轴稳定模式与非三轴稳定模式；三轴稳定模式下又可分为星敏感器是否参加定姿两种情况。遥测数据DF，MF，SF含义为：
快速数据，每帧传送数据相同，即每帧一循环；
中速数据，每16帧一循环；
慢速数据，每32帧一循环。
遥测输出数据格式及定义见文件R/JBK-10/0.RX1：
星上应用程序每0.524秒在定时中断响应主程序中装载快速遥测数据，在4秒主程序中装载中速和慢速数据，并根据当前控制系统模式装载不同的数据到规定遥测数据区中。为了能根据正确遥测相应的遥测数据，星上应用程序需要分别定义快帧遥测缓存区42字节，中帧遥测缓存区6×16字节和慢帧遥测缓存区12*32字节来存放星上的数据。同时应用程序每个周期都要根据OBDH的帧号从相应的遥测缓存区中找出正确的遥测数据进行打包。以下就快速遥测、中速遥测和慢速遥测的处理过程分别进行说明：
1）快速遥测
STEP1：根据星上控制模式，确定数据装载模式；
STEP2：根据不同的数据装载模式，确定装载数据；
STEP3：在0.524秒控制周期内将确定的装载数据转换为遥测要求的数据格式，并放入规定的缓存区；
STEP4：将规定缓存区的内容放入OBDH定义的内存中；
2）中速遥测
STEP1：根据星上控制模式，确定数据装载模式；
STEP2：根据不同的数据装载模式，确定装载数据；
STEP3：在4秒主程序内将确定的装载数据转换为遥测要求的数据格式，并放入规定的缓存区；
STEP4：根据遥测帧号从规定的缓存区中挑出遥测的数据并放入OBDH定义的内存中；
3）慢速遥测
STEP1：在4秒主程序内将确定的装载数据转换为遥测要求的数据格式，并放入规定的缓存区；
STEP2：根据遥测帧号从规定的缓存区中挑出遥测的数据并放入OBDH定义的内存中；
遥测的快帧内容不变，中帧和慢帧去掉加速度计相关内容，新增和更改内容详见《卫星控制分系统数字量实时遥测数据格式和参数定义》。",0,0,0,0,0,0,0,0,0,0,1
功能描述：将星务通过CAN总线广播的GPS定位数据转换成轨道根数。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：根据CMG输出数据和理论数据进行CMG故障检测。
",0,0,0,0,0,1,0,0,0,0,0
"功能：姿态机动目标姿态确定。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：计算正常飞行模式轮控所需电压
说明：系数，装订值均为1，可注入修改。",0,1,0,0,0,0,0,0,0,0,0
功能描述： 对部件电源加断电,0,0,0,0,0,0,0,1,0,0,0
"功能描述：利用红外太阳建立正常飞行姿态
",0,0,1,0,0,0,0,0,0,0,0
功能描述：接收遥控固定参数注入块的地面站位置信息功能区数据,0,0,0,0,0,0,0,0,0,1,0
功能：利用星敏感器A的测量，修正姿态四元数与估计陀螺漂移。,0,0,1,0,0,0,0,0,0,0,0
功能描述：入轨段初始化,0,0,0,1,0,0,0,0,0,0,0
功能描述：对陀螺进行剔野、限幅处理，并根据平衡方程满足情况对陀螺数据的有效性进行判断。,0,0,0,0,0,0,1,0,0,0,0
功能描述：根据陀螺输入，预估卫星惯性姿态。,0,0,1,0,0,0,0,0,0,0,0
功能描述：计算卫星偏流角，适用于地球椭球模型，星体姿态描述为转序。,0,0,0,0,1,0,0,0,0,0,0
"功能描述：二次电源切换。
处理：
ACU内部含有两套二次电源，两套互为备份，可以同时加电工作，通常仅一份工作。AOCC每个控制周期采集工作电源的状态模拟量，并设置当班状态（若某份的5V和12V遥测模拟量均≥2V则当班，若主备二次电源同时符合加电条件则置主份当班）。
若当班电源的5V或12V遥测模拟量连续5个控制周期<2V时，且允许ACU二次电源自主切换，则先发送另一份电源开、隔两个控制周期后再发送本电源关指令，并禁止ACU二次电源自主切换。。
上电/复位初始化为允许自主切换，主份当班。",0,0,0,0,0,0,0,1,0,0,0
"功能描述：选择通讯的陀螺LTU，发取数指令，采集LTU发送的数据，并处理成需要的数据格式。
处理：
（1）陀螺共有三个互为备份的LTU，通过每个LTU均可获得9个陀螺的数据；每个控制周期AOCC向陀螺LTU发送取数命令来获得数据，AOCC根据GROLTUSeltFlag来确定和哪个LTU进行通讯。
（2）向选择的陀螺LTU发送完取数指令，获得陀螺LTU返回的数据，将数据转换为控制计算所需的数据格式。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：对目标轨迹进行初始化，供姿态机动使用
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：计算将动量轮保持至标称角动量所需的电压。
输入：实测飞轮角动量，
      标称角动量：，
      角动量偏差积分项：，
输出：保持角动量所需电压，
      角动量偏差积分项：，
",0,1,0,0,0,0,0,0,0,0,0
功能描述：帆板驱动线路数据处理 ,0,0,0,0,0,0,0,0,1,0,0
功能描述：接收数据指令注入块的CMG串口指令,0,0,0,0,0,0,0,0,0,1,0
"功能描述：卫星速率阻尼下来后，转动卫星，使得数字或模拟太阳见到太阳；先绕本体x轴转动，若转动360度太阳未见太阳，停止x轴转动，再绕本体y轴转动，若转动360度太阳仍未见太阳，重复上述过程(若模拟太阳搜索，则减少转动角度)；
输入：，控制周期；滚动、俯仰数字太阳监视码，TsearchSun；滚动、俯仰模拟太阳监视码；

",0,1,0,0,0,0,0,0,0,0,0
"功能：在完成对日定向后，由地面指令转入地球捕获。使用数字太阳敏感器和星敏感器定姿建立正常姿态。
",0,1,0,0,0,0,0,0,0,0,0
将接收GPS数据存储地址中内容解包成对应的UTC时间、位置和速度数据和定轨数据的数据格式。由于GPS数据中有数据有效性标志，所以其中的微秒部分不考虑大于1秒的情况，由GPS保证。,0,0,0,0,0,0,0,0,0,1,0
"功能描述：根据标志选择轨控发动机。
",0,1,0,0,0,0,0,0,0,0,0
"功能描述：
  根据三轴姿态角和姿态角速度误差计算三轴控制力矩(功能编号：FReq-5)。
处理： 
控制器结构为PD控制，见下图。
图5-2  PID控制器
控制器输入计算和限幅：角度信息、角速度信息由5.2.2节获取；
用于计算控制力矩的角度信息限幅为[-5,5]度、角速度信息限幅1.0度/秒。
；
		；",0,1,0,0,0,0,0,0,0,0,0
功能描述：自旋模式初始化,0,0,0,1,0,0,0,0,0,0,0
"功能描述：发送应急控制器重要数据。
处理：将应急控制器重要数据按照协议打包发送至发送应急控制器重要数据地址中。",0,0,0,0,0,0,0,0,0,0,1
"功能描述：偏航通道喷气中断处理程序。
处理：将推力器9、10、11、12关掉",0,0,0,0,0,0,0,1,0,0,0
"软件需求标识：FREQ14.1 
软件需求名称：数据采集 ",0,0,0,0,0,0,0,0,1,0,0
"功能描述：太阳定向完成后，利用数字太阳与红外信息，进行俯仰、滚动捕获，并建立正常姿态
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：接收发送AOCC重要数据
处理：
控制分系统重要数据保存在系统内ICU以及外系统的CTU，应用软件上电/复位后首先从ICU恢复重要数据，如果连续5个控制周期申请重要数据失败（帧头错误、校验和错误或者收到的数据为非法数据）则认为从ICU恢复重要数据失败。应用软件通过外部1553B总线向OBDH申请星上时间和重要数据，如果连续15个控制周期申请重要数据失败，则根据星箭分离状态进行模式转换，并清除服务请求和矢量字。若星箭已分离则设置模式字为“入轨段”，星箭未分离则设置模式字为“主动段”。
申请重要数据成功后，按照重要数据中保存的部件当班状态初始化各部件软件当班状态，对于光纤陀螺产品需根据重要数据中的当班状态进行恢复对于三浮陀螺则根据重要数据中的Fi_GyroSelt状态进行恢复，并统一根据Fi_GyroSelt和当班状态补发产品开指令；对于CMG、红外、星敏产品根据重要数据中的当班状态恢复状态；统一根据当班状态和选择标志补发产品开指令；针对三浮陀螺产品，陀螺开指令连续发送3个控制周期后，连续3个控制周期发送陀螺马达开指令
  申请重要数据失败后，对于陀螺产品则根据ACU提供的部件加电状态初始化陀螺的当班状态和Fi_GyroSelt状态，并根据Fi_GyroSelt状态和当班状态补发产品开指令；对于红外产品，则根据ACU提供的部件加电状态初始化红外的当班状态和Fi_IRESSelt状态，并根据Fi_IRESSelt和当班状态补发产品开指令；对于CMG，根据ACU提供的部件加电状态初始化CMG的当班状态和Fi_CMGSelt状态，并根据Fi_CMGSelt状态和当班状态补发产品开指令；对于星敏感器，软件当班状态仍保持“不当班”状态，等待地面指令设置相应部件当班状态；
重要数据恢复成功后，使用第二块重要数据中的q\q\q\ q恢复“星体在惯性系下的姿态四元数q1/qng1、q2/qng2、q3/qng3、q4/qng4”。
第二块重要数据增加保存星敏定姿方式下的卫星三轴姿态角估值。",0,0,0,0,0,0,0,0,0,1,0
功能描述：若本周期角动量与上一周期角动量之差（绝对值）大于0.15Nms，则用上一周期角动量作为本周期输入，角动量变化取0。若连续大于三次或本周期与上一周期角动量之差（绝对值）小于0.15Nms，则以本周期角动量为真值，角动量变化,0,0,0,0,0,0,1,0,0,0,0
功能：利用星敏感器A、B的测量，修正姿态四元数与估计陀螺漂移。,0,0,1,0,0,0,0,0,0,0,0
"功能描述：使用星敏感器A、C的测量，修正姿态四元数与估计陀螺漂移。
",0,0,1,0,0,0,0,0,0,0,0
"功能描述：计算三轴的轮控力矩。
处理：
STEP1:分别计算P,I,D项。，的限幅值可以通过内存修改；，的限幅值可以通过内存修改。计算公式见（1）；
STEP2:PID加补偿的控制律计算。若{BZ1≠8(侧摆机动)或（BZ1=8且ZT43(3)=1允许侧摆机动引入结构滤波器）}且ZT39(4)=1引入结构滤波器，则调用结构滤波器算法得到，。计算公式见（2）；
STEP3:若ZT8≤3姿控发动机可用，ZT2=2飞轮整星零动量控制模式，BZ1≠1（三轴稳定正常轨道运行姿态）或2（偏航机动并稳定运行）或8（侧摆机动）或9（侧摆角保持），则：
若或，则=0.01；
若或，则=0.01；
若或，则=0.01。",0,1,0,0,0,0,0,0,0,0,0
功能描述：进行单轴相平面喷气控制规律计算。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：实时计算地心矢量、太阳矢量在本体系下的表示，以及星体X轴指向的赤经、赤纬
",0,0,1,0,0,0,0,0,0,0,0
"软件需求标识：FREQ21 
软件需求名称：部件加断电指令处理 
需求类别：其他 
软件需求描述：部件加断电指令处理。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：内总线指令处理
处理：
内总线指令设置、控制等操作。",0,0,0,0,0,0,0,0,1,0,0
"功能描述：完成整星绕滚动轴的姿态侧摆角保持功能
处理过程：过程如下：
STEP1：当ZT F（不用红外+单个斜装陀螺定姿），进行姿态预估，得到姿态角和角速度。
条件|FRTS的取值
ZT35(2) = 1且|1
其余情况|0

STEP2：当ZT F（不用红外+单个斜装陀螺定姿），进行姿态预估，得到姿态角和角速度。
STEP3：进行运行段姿态确定，具体过程如下：
进行红外数据采集及处理和q及s姿态予估器
当星敏感器修正时间大于等于4500秒时，将星敏感器测量回路求得的姿态角和角速度，赋值为姿态角和角速度，
得到输入控制律的姿态角和角速度，
STEP4：进行运行段控制，具体过程如下：
根据ZT2的值进行飞轮控制
当ZT8  3且ZT9  3且ZT时，进行运行段喷气姿态控制
进行陀螺故障检测及选择
当ZT40(4) = 1时，进行数传天线捕获跟踪控制
STEP5：根据ZT7的取值，进行相应的帆板控制。
ZT7的值|处理
 8|进行运行段帆板控制
ZT7 = 0|发两翼帆板归零指令
ZT7 = 3|发左翼为90度，右翼为 -90度指令
ZT7 = 5|发左右皆为90度指令
ZT7 = 7|发左右皆为180度指令
ZT7 = 9|发指令
ZT7 = A|发指令
ZT7 = B|发指令
",0,0,0,1,0,0,0,0,0,0,0
功能描述：置卫星姿态无控，处于自由飞行状态。,0,1,0,0,0,0,0,0,0,0,0
"功能描述：定义AOCC初始上电至星箭分离为主动段工作模式。
处理：
定义星箭分离前为主动段工作模式，应用软件在控制周期任务函数中进行下列工作：
	星时计算。
	采集部件（太阳敏感器、陀螺、星敏、CMG）信息。
	采集部件、线路遥测模拟量。
	响应主动段测试指令和“运行初始速率阻尼模式”指令。
	对ALTU当班状态判断，并与当班ALTU通讯。
	响应星务分系统轮询、数据遥控指令、数据注入、程序注入、秒脉冲校时等，并进行相应处理。
	星箭分离的确认依据为：一个控制周期内对星箭分离状态位读5次，若连续3次以上读入为“1”，则认为本周期查到星箭已分离，每次读的时间间隔要求大于1ms。如果在连续3个周期内每个周期都查到星箭已分离，则可确认为星箭已分离，进入初始速率阻尼模式。
	此外，通过地面遥控指令进行以下起飞前设置：
5个CMG加电，并将框架角均转到0度保持、锁定；
6个陀螺加电。",0,0,0,1,0,0,0,0,0,0,0
"功能描述：与CAN通讯获得上行/下行数据。
调用条件：AOCC被动接收/发送数据；
处理：通过CAN总线与星务分系统通讯，交换数据，以实现星地联系和对卫星的人工干预。主要完成下列功能：
AOCC向星务分系统发送数据（中断接收星务分系统命令，依据命令发送各类遥测参数）；
发送快帧遥测；
发送慢帧遥测；
将AOCC为星务保存的重要数据发送给星务分系统；
发送星敏感器和姿态辅助数据；
有内存下卸要求时，发送AOCC指定内存内容；
AOCC接收星务分系统数据（中断方式）包括接收固定地址参数注入；接收可变地址参数注入；接收轨道参数数据；接收程序注入；接收数据指令；接收重要数据返回；接收整星对时广播数据；接收GPS高精度秒脉冲对时广播；接收GPS导航数据，GPS定位广播数据引入控制使用之前，软件需对广播数据中的W28表示的定位状态进行判断，即D6～D4：为101、011、110之一时，引入系统，否则为无效，控制系统不使用
如果应用软件3s收不到星务分系统信息或连续5周期挂起，对CAN总线控制器重新初始化。",0,0,0,0,0,0,0,0,0,0,1
"根据不同的任务要求划分了各个模式，模式控制作为一个功能的集合体反映了任务的执行情况，是确认测试和系统实验验证的重要的功能。
模式字|工作模式描述|功能编号
0 |主动段|FREQ52
1|入轨段控制|FREQ53
2|巡天观测模式|FREQ54
3|定点观测模式|FREQ55
4|小天区扫描模式|FREQ56
5|姿态机动|FREQ57
6|轨控|FREQ58
7|捕获太阳并对日定姿模式|FREQ59
8|帆板未展开|FREQ60
9|无控|FREQ61
10|应急模式|FREQ62

主动段和应急工作模式下并不进行姿态确定和控制的计算，其它各个模式控制中调用卫星轨道和星历计算、姿态确定、姿态和轨道控制见用户需求的4。主要模式的姿态确定调用流程的功能点如下：
序号|功能编号|功能描述|用户需求中对应章节
|FREQ53.1|对日定向姿态确定调用流程|5.2.1.1
|FREQ54.1|巡天模式姿态确定调用流程|5.2.1.2
|FREQ55.1|定点观测模式姿态确定调用流程|5.2.1.3
|FREQ56.1|小天区扫描模式姿态确定调用流程|5.2.1.4
|FREQ57.1|姿态机动模式姿态确定调用流程|5.2.1.5
|FREQ58.1|轨控模式姿态确定调用流程|5.2.1.6
",0,0,0,1,0,0,0,0,0,0,0
功能描述：对部件加断电指令的处理 ,0,0,0,0,0,0,0,1,0,0,0
功能描述：无控模式初始化,0,0,0,1,0,0,0,0,0,0,0
"需求名称|功能及处理描述
对地数传天线1数据的采集与处理|在总线指令要求通讯允许的条件下，每500ms向对地数传天线1 LTU发控制指令，获得对地数传天线1数据并处理成对应的角度等信息。
对地数传天线2数据的采集与处理|在总线指令要求通讯允许的条件下，每500ms向对地数传天线2 LTU发控制指令，获得对地数传天线2数据并处理成对应的角度等信息。
中继天线数据的采集与处理|在总线指令要求通讯允许的条件下，每500ms向中继天线 LTU发控制指令，获得中继天线数据并处理成对应的角度等信息。",0,0,0,0,0,0,0,0,1,0,0
